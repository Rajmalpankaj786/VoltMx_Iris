voltmx=voltmx||{};voltmx.model=voltmx.model||{};voltmx.model.Util=voltmx.model.Util||{};voltmx.model.Util.validateFieldMapping=function(entityMetadata,fieldName){if(entityMetadata&&fieldName&&fieldName.trim()!==""){if(entityMetadata.columnsMap&&entityMetadata.columnsMap[fieldName]){return true}else{for(var i=0;i<entityMetadata.fields.length;i++){var fm=entityMetadata.fields[i];if(voltmx.model.Util.matchIgnoreCase(fm.name,fieldName)){return true}}return false}}return false};voltmx.model.Util.getDataAsPerType=function(val,dataType,widgetType){try{var convertedVal=val;if(!dataType||widgetType.toLowerCase()==="segment"){return convertedVal}dataType=dataType.toLowerCase();switch(dataType){case"varchar":case"picklist":case"picklistmultiselect":case"extendedfield":convertedVal=String(val);break;case"int2":case"int8":case"integer":case"serial":if(voltmx.model.Util.isValidNumberType(val)){convertedVal=parseInt(val,10);if(isNaN(convertedVal))convertedVal=null}break;case"boolean":convertedVal=String(typeof val==="string"?val==="true"?true:false:new Boolean(val));break;case"date":case"timestamp":if(widgetType==="calendar"){convertedVal=new Date(val)}else{convertedVal=String(val)}break;default:voltmx.model.log.error("dataType not found "+dataType);break}return convertedVal}catch(err){voltmx.model.log.error("Error in getDataAsPerType "+err.toString())}};voltmx.model.Util.showValidationErrors=function(errors){var len=errors.length;if(len>0){var eMessage=errors[0];voltmx.model.Util.showInfoAlert({text:eMessage,btnConfirmText:"Ok",header:"Info"})}};voltmx.model.Util.showInfoAlert=function(config){var hdrText=config.header||"Info";var btnText=config.btnConfirmText||"Ok";var callback=function(){};var callbackFunc=config.callback||callback;voltmx.ui.Alert(config.text,callbackFunc,"info",btnText,null,hdrText,null)};voltmx.model.Util.formatTimeStamp=function(date){var now=date;year=""+now.getFullYear();month=""+(now.getMonth()+1);if(month.length==1){month="0"+month}day=""+now.getDate();if(day.length==1){day="0"+day}hour=""+now.getHours();if(hour.length==1){hour="0"+hour}minute=""+now.getMinutes();if(minute.length==1){minute="0"+minute}second=""+now.getSeconds();if(second.length==1){second="0"+second}return year+"-"+month+"-"+day+" "+hour+":"+minute+":"+second};voltmx.model.Util.validateQuery=function(query,parametersToQuery,widgetId,initErrorCallback){if(query){var noOfOccurences=query.split("{").length-1;var noOfSecondOccurences=query.split("}").length-1;if(noOfOccurences!==noOfSecondOccurences){initErrorCallback(new voltmx.model.Exception(voltmx.model.ExceptionCode.CD_ERROR_BRACES_ARE_NOT_DEFINED_PROPERLY,voltmx.model.ExceptionCode.MSG_ERROR_BRACES_ARE_NOT_DEFINED_PROPERLY+" for the widget query :"+widgetId));return}voltmx.model.log.info("QueryParams provided to widgetId are {} ",parametersToQuery);var noOfParamsSupplied=0;for(var k in parametersToQuery){noOfParamsSupplied=noOfParamsSupplied+1}var firstIndex,secondIndex,subString,paramValue;for(var i=0;i<noOfOccurences;i+=1){firstIndex=-1;secondIndex=-1;firstIndex=query.indexOf("{",firstIndex+1);secondIndex=query.indexOf("}",secondIndex+1);if(firstIndex>secondIndex){initErrorCallback(new voltmx.model.Exception(voltmx.model.ExceptionCode.CD_ERROR_BRACES_ARE_NOT_DEFINED_PROPERLY,voltmx.model.ExceptionCode.MSG_ERROR_BRACES_ARE_NOT_DEFINED_PROPERLY+" in "+this.voltmxWidget.id+" widget query :"+widgetId));return}subString=query.substring(firstIndex+1,secondIndex);paramValue=parametersToQuery[subString];if(paramValue!==undefined)query=query.replace("{"+subString+"}",paramValue);else{initErrorCallback(new voltmx.model.Exception(voltmx.model.ExceptionCode.CD_ERROR_PARAM_VALUE_NOT_DEFINED_IN_QUERYPARAM,voltmx.model.ExceptionCode.MSG_ERROR_PARAM_VALUE_NOT_DEFINED_IN_QUERYPARAM+" "+subString+" regarding this widget :"+widgetId));return}}}voltmx.model.log.info("query after replacing the queryParams with its values from navObj is "+query);return query};voltmx.model.Util.format={segmentData:function(data,widgetConfig){if(widgetConfig&&widgetConfig.isSortByDefined()){if(data&&data.length){if(!data[0].hasOwnProperty(widgetConfig.getSortByKey()))throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_INVALID_SORTBYKEY,voltmx.model.ExceptionCode.MSG_INVALID_SORTBYKEY);data=voltmx.model.Util.format.sortObjectArrayByKey(data,widgetConfig.getSortByKey(),widgetConfig.getSortType())}}if(widgetConfig&&widgetConfig.isGroupByDefined()){groupByField=widgetConfig.getGroupByKey();if(data&&data.length)if(!data[0].hasOwnProperty(groupByField))throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_INVALID_GROUPBYKEY,voltmx.model.ExceptionCode.MSG_INVALID_GROUPBYKEY);if(groupByField){var tempData=voltmx.model.Util.format.groupObjectArrayByKey(data,groupByField);var groupedData=[];for(name in tempData){groupedData.push([name,tempData[name]])}if(groupedData.length)data=groupedData}}return data},groupObjectArrayByKey:function(objArray,key){var tempData={};for(var index=0;index<objArray.length;index++){if(objArray[index].hasOwnProperty(key)){if(tempData.hasOwnProperty(objArray[index][key]))tempData[objArray[index][key]].push(objArray[index]);else tempData[objArray[index][key]]=[objArray[index]]}}return tempData},sortObjectArrayByKey:function(objArray,key,sortType){try{var compare;if(sortType=="Ascending"){compare=function(a,b){if(a[key]<b[key])return-1;if(a[key]>b[key])return 1;return 0}}else if(sortType=="Descending"){compare=function(a,b){if(a[key]<b[key])return 1;if(a[key]>b[key])return-1;return 0}}else if(sortType=="Length_Ascending"){compare=function(a,b){if(a[key].length<b[key].length)return-1;if(a[key].length>b[key].length)return 1;return 0}}else if(sortType=="Length_Descending"){compare=function(a,b){if(a[key].length<b[key].length)return 1;if(a[key].length>b[key].length)return-1;return 0}}else{compare=function(a,b){if(a[key]<b[key])return-1;if(a[key]>b[key])return 1;return 0}}return objArray.sort(compare)}catch(err){return objArray}}};voltmx.model.Util.callAlert=function(msg,type,alertHandler,title,yesLabel,noLabel){var numType;var pspConf={};var basicConf;if(yesLabel==null)yesLabel="Ok";if(noLabel==null)noLabel="Cancel";if(alertHandler==null)alertHandler=null;if(title==null)title="";if(type=="info"){numType=constants.ALERT_TYPE_INFO}if(type=="error"){numType=constants.ALERT_TYPE_ERROR}if(type=="confirmation"){numType=constants.ALERT_TYPE_CONFIRMATION}basicConf={message:msg,alertType:numType,alertTitle:title,yesLabel:yesLabel,noLabel:noLabel,alertHandler:alertHandler};voltmx.ui.Alert(basicConf,pspConf)};voltmx.model.Util.convertDateToYYYYMMDD=function(inDate,inChar){var outDate="";if(inDate!=null&&inDate!="0"){var dateTab=inDate.split(inChar);outDate=dateTab[2]+dateTab[1]+dateTab[0]}return outDate};voltmx.model.Util.formatDateFromSky=function(inDate,dateFormat,spliter){var outDate="";if(inDate!=null&&inDate!="0"){var year=voltmx.string.sub(inDate,0,3);var month=voltmx.string.sub(inDate,4,5);var day=voltmx.string.sub(inDate,6,7);if(dateFormat=="ddmmyyyy"){outDate=day+spliter+month+spliter+year}else if(dateFormat=="mmddyyyy"){outDate=month+spliter+day+spliter+year}else if(dateFormat=="yyyymmdd"){outDate=year+spliter+month+spliter+day}}return outDate};voltmx.model.Util.formatToSetDate=function(givendate){var calWidgetTab=[];if(givendate!=null&&givendate!=""){calWidgetTab=givendate.split("/");if(voltmx.os.deviceInfo().name=="blackberry"){var mmm=voltmx.os.toNumber(calWidgetTab[voltmx.decrement(2)]);var ddd=voltmx.os.toNumber(calWidgetTab[voltmx.decrement(1)]);var yyy=voltmx.os.toNumber(calWidgetTab[voltmx.decrement(3)]);var temp=[];temp=[mmm,ddd,yyy];return temp}else{var mmm=calWidgetTab[voltmx.decrement(2)];var ddd=calWidgetTab[voltmx.decrement(1)];var yyy=calWidgetTab[voltmx.decrement(3)];calWidgetTab=[ddd,mmm,yyy];return calWidgetTab}}return givendate};voltmx=voltmx||{};voltmx.model=voltmx.model||{};voltmx.model.constants=voltmx.model.constants||{};voltmx.model.constants.applicationStatus={};voltmx.model.constants.applicationStatus.PROCESSING="processing";voltmx.model.constants.applicationStatus.COMPLETED="completed";voltmx.model.applicationStatus=voltmx.model.constants.applicationStatus.PROCESSING;voltmx.model.VoltmxGlobalObject=this;if(voltmx.model.APPTYPE===undefined||voltmx.model.APPTYPE===null)voltmx.model.APPTYPE="standalone";voltmx.model.ModelContext=function(){function ModelContext(){var operationType={};var requestOptions=undefined;operationType["form"]=voltmx.model.constants.OperationType.NO_FILTER;var customInfo=undefined;var additionalFields=undefined;var query=undefined;var queryType=undefined;var queryParams=undefined;var primaryKeyValueMap={};var entityDataMap={};this.setPrimaryKeyValueMap=function(primarykeyMap){primaryKeyValueMap=primarykeyMap};this.getPrimaryKeyValueMap=function(){return primaryKeyValueMap};this.getEntityDataMap=function(entity){return entityDataMap[entity]};this.setEntityDataMap=function(entity,map){entityDataMap[entity]=map};this.getOperationType=function(widgetId){if(!widgetId){return operationType["form"]}else{return operationType[widgetId]}};this.setOperationType=function(operationTypeArg,widgetId){if(!widgetId){widgetId="form"}if(!operationType){operationType={}}operationType[widgetId]=operationTypeArg};this.getCustomInfo=function(key){return customInfo&&customInfo[key]};this.setCustomInfo=function(key,value){if(!customInfo){customInfo={}}customInfo[key]=value};this.setAdditionalFields=function(widgetId,keys){var ArrayConstructor=[].constructor;try{if(!additionalFields){additionalFields={}}if(keys&&keys.constructor!==ArrayConstructor||arguments.length===1&&arguments[0].constructor!==ArrayConstructor){throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_ADDITIONAL_FIELDS_ARE_NOT_DEFINED_PROPERLY,voltmx.model.ExceptionCode.MSG_ERROR_ADDITIONAL_FIELDS_ARE_NOT_DEFINED_PROPERLY+"for this widget : "+widgetId)}if(widgetId&&keys){additionalFields[widgetId]=keys}else if(arguments.length===1){additionalFields["form"]=arguments[0]}}catch(err){voltmx.model.log.error("error in setting AdditionalFields "+err);throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_IN_SET_ADDITIONAL_FIELDS,voltmx.model.ExceptionCode.MSG_ERROR_IN_SET_ADDITIONAL_FIELDS+" : "+err.toString(),err)}};this.getAdditionalFields=function(widgetId){if(!widgetId){return additionalFields&&additionalFields["form"]}else{return additionalFields&&additionalFields[widgetId]}};this.setQuery=function(widgetId,queryArg,queryTypeArg){var stringConstructor="test".constructor;try{if(queryArg&&queryArg.constructor!==stringConstructor||arguments.length===1&&arguments[0].constructor!==stringConstructor){throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_QUERY_NOT_DEFINED_PROPERLY,voltmx.model.ExceptionCode.MSG_ERROR_QUERY_NOT_DEFINED_PROPERLY+"for this widget : "+widgetId)}if(!query){query={}}if(!queryType){queryType={}}if(arguments.length===3&&queryArg&&widgetId&&queryTypeArg){query[widgetId]=queryArg;queryType[widgetId]=queryTypeArg}else if(arguments.length===2){if(queryArg==="sql"||queryArg==="sql_union"||queryArg==="odata"){query["form"]=arguments[0];queryType["form"]=arguments[1]}else{query[widgetId]=queryArg}}else if(arguments.length===1){query["form"]=arguments[0]}}catch(err){voltmx.model.log.error("error in setting Query "+err);throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_IN_SET_QUERY,voltmx.model.ExceptionCode.MSG_ERROR_IN_SET_QUERY+" : "+err.toString(),err)}};this.getQuery=function(widgetId){if(!widgetId){return query&&query["form"]}else{return query&&query[widgetId]}};this.setQueryParams=function(widgetId,queryParamsArg){var JSONConstructor={}.constructor;if(!queryParams){queryParams={}}try{if(queryParamsArg&&queryParamsArg.constructor!==JSONConstructor||arguments.length===1&&arguments[0].constructor!==JSONConstructor){throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_QUERYPARAMS_NOT_DEFINED_PROPERLY,voltmx.model.ExceptionCode.MSG_ERROR_QUERYPARAMS_NOT_DEFINED_PROPERLY+"for this widget : "+widgetId)}if(queryParamsArg&&widgetId){queryParams[widgetId]=queryParamsArg}else if(arguments.length===1){queryParams["form"]=arguments[0]}}catch(err){voltmx.model.log.error("error in setting QueryParams "+err);throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_IN_SET_QUERY_PARAMS,voltmx.model.ExceptionCode.MSG_ERROR_IN_SET_QUERY_PARAMS+" : "+err.toString(),err)}};this.getQueryParams=function(widgetId){if(!widgetId){return queryParams&&queryParams["form"]}else{return queryParams&&queryParams[widgetId]}};this.setRequestOptions=function(widgetId,options){var JSONConstructor={}.constructor;try{if(!requestOptions){requestOptions={}}if(options&&options.constructor!==JSONConstructor||arguments.length===1&&arguments[0].constructor!==JSONConstructor){throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_OPTIONS_ARE_NOT_DEFINED_PROPERLY,voltmx.model.ExceptionCode.MSG_ERROR_OPTIONS_ARE_NOT_DEFINED_PROPERLY+"for this widget : "+widgetId)}if(widgetId&&options){requestOptions[widgetId]=options}else if(arguments.length===1){requestOptions["form"]=arguments[0]}}catch(err){voltmx.model.log.error("error in setting options "+err);throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_IN_SET_OPTIONS,voltmx.model.ExceptionCode.MSG_ERROR_IN_SET_OPTIONS+" : "+err.toString(),err)}};this.getRequestOptions=function(widgetId){if(!widgetId){return requestOptions&&requestOptions["form"]}else{return requestOptions&&requestOptions[widgetId]}}}ModelContext.prototype.addCustomInfo=function(key,value){this.setCustomInfo(key,value)};ModelContext.prototype.removeCustomInfo=function(key){if(!this.getCustomInfo()){return}this.setCustomInfo(key,undefined)};ModelContext.prototype.removeAdditionalFields=function(widgetId){if(widgetId&&this.getAdditionalFields(widgetId)){this.setAdditionalFields(widgetId,null)}else{this.setAdditionalFields("form",null)}};ModelContext.prototype.removeQuery=function(widgetId){if(widgetId&&this.getQuery(widgetId)){this.setQuery(widgetId,undefined)}else{this.setQuery("form",undefined)}};ModelContext.prototype.removeQueryParams=function(widgetId){if(widgetId&&this.getQueryParams(widgetId)){this.setQueryParams(widgetId,undefined)}else{this.setQueryParams("form",undefined)}};ModelContext.prototype.clone=function(){var newObj=voltmx.model.Util.clone(this);return newObj};return ModelContext}();voltmx.model.View=function(){function View(modelConfig,voltmxForm){this.modelConfig=modelConfig;this.voltmxform=voltmxForm;this.voltmxWidgetObjects={};this.observerViewModels=[];this.decorator=undefined;var scopeObj=this;var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();function createWidgetControllers(){if(scopeObj.voltmxform===undefined||scopeObj.voltmxform===null){throw appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_KONY_FORM_OBJECT_UNDEFINED,voltmx.model.ExceptionCode.MSG_ERROR_KONY_FORM_OBJECT_UNDEFINED)}var widgets=scopeObj.modelConfig.getWidgets();voltmx.model.log.info("inside widget controller create ... ");for(var widgetId in widgets){var path=widgetId.split(".");var voltmxWidget=scopeObj.voltmxform[path[0]];for(var i=1;i<path.length;i++)voltmxWidget=voltmxWidget[path[i]];if(voltmxWidget){var widgetType=widgets[widgetId]["widgettype"]?widgets[widgetId]["widgettype"].toLowerCase():undefined;if(widgetType===undefined||!widgets[widgetId])continue;voltmx.model.log.info("widgetcontroller for id : "+widgetId+" widgetType : "+widgetType);var widgetControllerName="WidgetController";widgetControllerName=widgets[widgetId]["controller"];voltmx.model.log.info("widget controller 1 -- "+widgetControllerName);var defaultWidgetControllerName="WidgetController";var widgetType=widgetType.toLowerCase().trim();switch(widgetType.toLowerCase().trim()){case"label":case"button":case"textbox":case"textarea":case"textarea2":case"textfield":case"textbox2":case"image":case"link":case"calendar":case"switch":case"slider":case"phone":case"richtext":if(widgets[widgetId]["isMultiEntityLabel"]){defaultWidgetControllerName="MultiEntityLabelController";widgetcontrollername="MultiEntityLabelController";break}defaultWidgetControllerName="WidgetController";widgetcontrollername=widgetControllerName===undefined||widgetControllerName===null||widgetControllerName===""?defaultWidgetControllerName:widgetControllerName;break;case"flexscrollcontainer":case"flexcontainer":case"userwidgetinstance":defaultWidgetControllerName="WidgetController";widgetcontrollername=widgetControllerName===undefined||widgetControllerName===null||widgetControllerName===""?defaultWidgetControllerName:widgetControllerName;break;case"combobox":defaultWidgetControllerName="ComboBoxWidgetController";widgetcontrollername=widgetControllerName===undefined||widgetControllerName===null||widgetControllerName===""?defaultWidgetControllerName:widgetControllerName;break;case"listbox":defaultWidgetControllerName="ListBoxWidgetController";widgetcontrollername=widgetControllerName===undefined||widgetControllerName===null||widgetControllerName===""?defaultWidgetControllerName:widgetControllerName;break;case"segment":defaultWidgetControllerName="SegmentWidgetController";widgetcontrollername=widgetControllerName===undefined||widgetControllerName===null||widgetControllerName===""?defaultWidgetControllerName:widgetControllerName;break;case"map":defaultWidgetControllerName="MapWidgetController";widgetcontrollername=widgetControllerName===undefined||widgetControllerName===null||widgetControllerName===""?defaultWidgetControllerName:widgetControllerName;break;case"radiobuttongroup":defaultWidgetControllerName="RadioButtonGroupWidgetController";widgetcontrollername=widgetControllerName===undefined||widgetControllerName===null||widgetControllerName===""?defaultWidgetControllerName:widgetControllerName;break;default:widgetcontrollername="WidgetController";defaultWidgetControllerName="WidgetController";break}var controllerHandler=voltmx.model[widgetcontrollername];if(controllerHandler===undefined||controllerHandler===null){voltmx.model.log.error("Defined controller is not found so throwing exception");throw appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_UNDEFINED_WIDGET_CONTROLLER,voltmx.model.ExceptionCode.MSG_ERROR_UNDEFINED_WIDGET_CONTROLLER+" : "+widgetcontrollername)}voltmx.model.log.info("create widget controller -- "+widgetId+" -- "+widgetType+" -- "+widgetcontrollername+" -- "+defaultWidgetControllerName);if(controllerHandler===undefined||controllerHandler===null)continue;switch(widgetType){case"label":case"button":case"textbox":case"textarea":case"textarea2":case"textfield":case"textbox2":case"image":case"link":case"calendar":case"flexcontainer":case"flexscrollcontainer":case"switch":case"slider":case"phone":case"richtext":case"userwidgetinstance":var controller=new controllerHandler(scopeObj,voltmxWidget,widgets[widgetId]);scopeObj.voltmxWidgetObjects[widgetId]=controller;voltmx.model.log.info("generic widget controller creation success ");break;case"listbox":case"combobox":case"radiobuttongroup":var controller=new controllerHandler(scopeObj,voltmxWidget,widgets[widgetId]);if(controller.constructor.name!=="WidgetController"){throw appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_NOT_INHERITING_WIDGET_CONTROLLER,voltmx.model.ExceptionCode.MSG_ERROR_NOT_INHERITING_WIDGET_CONTROLLER+" : "+widgetcontrollername)}scopeObj.voltmxWidgetObjects[widgetId]=controller;voltmx.model.log.info("listbox/combobox/radiobuttongroup widget controller creation success ");break;case"segment":var controller=new controllerHandler(scopeObj,voltmxWidget,widgets[widgetId]);if(controller.constructor.name!=="WidgetController"){throw appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_NOT_INHERITING_WIDGET_CONTROLLER,voltmx.model.ExceptionCode.MSG_ERROR_NOT_INHERITING_WIDGET_CONTROLLER+" : "+widgetcontrollername)}scopeObj.voltmxWidgetObjects[widgetId]=controller;voltmx.model.log.info("segment widget controller creation success ");break;case"map":var controller=new controllerHandler(scopeObj,voltmxWidget,widgets[widgetId]);if(controller.constructor.name!=="WidgetController"){throw appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_NOT_INHERITING_WIDGET_CONTROLLER,voltmx.model.ExceptionCode.MSG_ERROR_NOT_INHERITING_WIDGET_CONTROLLER+" : "+widgetcontrollername)}scopeObj.voltmxWidgetObjects[widgetId]=controller;voltmx.model.log.info("map widget controller creation success ");break;default:voltmx.model.log.error("Not a widget, do nothing!!!");break}}}}createWidgetControllers()}View.prototype.destroy=function(){try{this.modelConfig=null;this.observerViewModels=null;this.voltmxWidgetObjects=null;this.decorator=null}catch(err){voltmx.model.log.error("Error in destroy view : "+err.toString());throw err}};View.prototype.updateAll=function(viewModel){voltmx.model.log.info("inside view update all...");try{for(var widgetId in this.voltmxWidgetObjects){voltmx.model.log.info("inside view update all for : "+widgetId);this.update(widgetId,viewModel[widgetId])}voltmx.model.ApplicationContext.dismissLoadingScreen()}catch(err){voltmx.model.log.error("error in update all view.."+err.toString());throw err}};View.prototype.setDecorator=function(decorator){this.decorator=decorator;this.decorator.init(this)};View.prototype.getDecorator=function(){return this.decorator};View.prototype.showform=function(){try{if(this.getDecorator()){this.getDecorator().preshow(this)}voltmx.model.applicationStatus=voltmx.model.constants.applicationStatus.COMPLETED;this.voltmxform.show();voltmx.model.ApplicationContext.dismissLoadingScreen()}catch(err){voltmx.model.log.error("error in showform view.."+err.toString());throw err}};View.prototype.getVoltmxForm=function(){return this.voltmxform};View.prototype.getVoltmxFormId=function(){return this.getVoltmxForm().id};View.prototype.getVoltmxWidget=function(widgetId){return this.getVoltmxForm()[widgetId]};View.prototype.update=function(widgetId,data){try{var viewWidget=this.voltmxWidgetObjects[widgetId];voltmx.model.log.info("setting data ..to view widget : ",data);if(viewWidget&&data){if(data instanceof voltmx.model.Data){viewWidget.setDataToWidget(data)}else{voltmx.model.log.error("Invalid data object, expected 'voltmx.model.Data' object");throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_INVALID_DATA_OBJECT,voltmx.model.ExceptionCode.MSG_ERROR_INVALID_DATA_OBJECT)}}}catch(err){voltmx.model.log.error("failed to set data to view widget : "+err);throw err}};View.prototype.registerObserver=function(observer){this.observerViewModels.push(observer)};View.prototype.removeObserver=function(observer){};View.prototype.getDataFromWidget=function(widgetId){try{var widgetData=this.voltmxWidgetObjects[widgetId].getDataFromWidget();return widgetData}catch(err){voltmx.model.log.error("error in get data from widget : "+err);throw err}};View.prototype.getConfig=function(){return this.modelConfig};View.prototype.isWidgetValueChanged=function(widgetId,data){try{return this.voltmxWidgetObjects[widgetId].isValueChanged(data)}catch(err){voltmx.model.log.error("error in is widget value change : "+err);throw err}};View.prototype.updateMasterData=function(masterData,widgetId){try{this.voltmxWidgetObjects[widgetId].setMasterDataToWidget(masterData)}catch(err){voltmx.model.log.error("error in update widget master data : "+err);throw err}};View.prototype.getMasterDataFromWidget=function(widgetId){try{return this.voltmxWidgetObjects[widgetId].getMasterDataFromWidget()}catch(err){voltmx.model.log.error("error in get widget master data : "+err);throw err}};View.prototype.performAction=function(widgetId,actionName,argsArray){try{var response;var relativeView;if(widgetId===this.getVoltmxFormId()){relativeView=this.getVoltmxForm()}else{relativeView=this.getVoltmxWidget(widgetId)}if(relativeView[actionName]&&typeof relativeView[actionName]==="function"){response=relativeView[actionName].apply(relativeView,argsArray);return response}else{voltmx.model.log.error("no action found in view for actionname : "+actionName);return}}catch(err){voltmx.model.log.error("error in get widget method execute : "+err);throw err}};View.prototype.setAttributeByProperty=function(widgetId,attributeName,attributeVal){try{if(widgetId===this.getVoltmxFormId()){this.getVoltmxForm()[attributeName]=attributeVal}else{this.getVoltmxWidget(widgetId)[attributeName]=attributeVal}}catch(err){voltmx.model.log.error("error in set widget attribute : "+err);throw err}};View.prototype.getAttributeByProperty=function(widgetId,attributeName){try{var attributeVal;if(widgetId===this.getVoltmxFormId()){attributeVal=this.getVoltmxForm()[attributeName]}else{attributeVal=this.getVoltmxWidget(widgetId)[attributeName]}return attributeVal}catch(err){voltmx.model.log.error("error in get widget attribute : "+err);throw err}};View.prototype.clear=function(){try{voltmx.model.log.info("clearing view data..");for(var widgetId in this.voltmxWidgetObjects){if(this.voltmxWidgetObjects[widgetId]){this.voltmxWidgetObjects[widgetId].clear()}}}catch(err){voltmx.model.log.error("error in clear view observers.."+err);throw err}};return View}();voltmx.model.WidgetController=function(){function WidgetController(viewObj,voltmxWidget,widgetConfig){this.voltmxWidget=voltmxWidget;this.widgetConfig=widgetConfig?widgetConfig:{};this.widgetType=this.widgetConfig.hasOwnProperty("widgettype")?this.widgetConfig["widgettype"].toLowerCase():undefined;this.viewObj=viewObj;this.data=undefined}WidgetController.prototype.destroy=function(){try{voltmx.model.log.info("Destroying widget controller..");this.voltmxWidget=null;this.widgetConfig=null;this.widgetType=null;this.data=null}catch(err){voltmx.model.log.error("error in destroy widget controller.."+err.toString());throw err}};WidgetController.prototype.setDataToWidget=function(data){try{if(!data){return}if(!(data instanceof voltmx.model.Data)){voltmx.model.log.error("Invalid data Object, expected 'voltmx.model.Data' object");throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_INVALID_DATA_OBJECT,voltmx.model.ExceptionCode.MSG_ERROR_INVALID_DATA_OBJECT);return}var voltmxWidget=this.getVoltmxWidget();switch(this.getWidgetType()){case"label":case"textbox":case"textarea":case"textarea2":case"textfield":case"textbox2":case"button":case"link":case"phone":case"richtext":if(data.getDisplayValue()!==undefined){voltmxWidget.text=data.getDisplayValue()}else{voltmxWidget.text=data.getData()}break;case"image":voltmxWidget.src=data.getData();break;case"calendar":voltmxWidget.dateComponents=data.getData();break;case"switch":voltmxWidget.selectedIndex=data.getData();break;case"slider":voltmxWidget.selectedValue=data.getData();break;default:voltmx.model.log.error("Not a data widget, do nothing!!!");break}this.data=data}catch(err){voltmx.model.log.error("error in setDataToWidget of widget controller.."+err.toString());throw err}};WidgetController.prototype.getDataFromWidget=function(){try{var data=this.data;if(!this.data){data=voltmx.model.ApplicationContext.getFactorySharedInstance().createDataObject()}var voltmxWidget=this.getVoltmxWidget();switch(this.getWidgetType()){case"label":case"textbox":case"textarea":case"textarea2":case"textfield":case"textbox2":case"button":case"link":case"phone":case"richtext":if(data.getDisplayValue()!==undefined){data.setDisplayValue(voltmxWidget.text)}else{data.setData(voltmxWidget.text)}break;case"image":data.setData(voltmxWidget.src);break;case"calendar":var dateArr=voltmxWidget.dateComponents;data.setData(dateArr);break;case"switch":data.setData(voltmxWidget.selectedIndex);break;case"slider":data.setData(voltmxWidget.selectedValue);break;default:voltmx.model.log.error("Not a data widget, do nothing!!!");break}return data}catch(err){voltmx.model.log.error("error in getDataToWidget of widget controller.."+err.toString());throw err}};WidgetController.prototype.getVoltmxWidget=function(){return this.voltmxWidget};WidgetController.prototype.getWidgetType=function(){return this.widgetType};WidgetController.prototype.getWidgetConfig=function(){return this.widgetConfig};WidgetController.prototype.getWidgetId=function(){return this.voltmxWidget.id};WidgetController.prototype.isValueChanged=function(data){try{if(data&&!(data instanceof voltmx.model.Data)){data=voltmx.model.ApplicationContext.getFactorySharedInstance().createDataObject(data)}var newValue=this.getDataFromWidget().getData();var widgetData=data===undefined?data:data.getData();if(this.getWidgetType()==="calendar"){if(widgetData===undefined&&newValue!==undefined)return true;if(widgetData.getTime()===newValue.getTime())return false;else return true}else{if(widgetData===undefined&&newValue!==undefined&&newValue!=="")return true;else if(widgetData===undefined&&newValue!==undefined&&newValue==="")return false;if(widgetData===newValue)return false;else return true}}catch(err){voltmx.model.log.error("error in isValueChanged of widget controller.."+err.toString());throw err}};WidgetController.prototype.setMasterDataToWidget=function(masterData){voltmx.model.log.error("Not a data widget, do nothing!!!");this.clear()};WidgetController.prototype.getMasterDataFromWidget=function(){return null};WidgetController.prototype.clear=function(){try{this.data=undefined;var voltmxWidget=this.getVoltmxWidget();switch(this.getWidgetType()){case"label":case"textbox":case"textfield":case"textarea":case"textarea2":case"textbox2":case"button":case"link":case"richtext":voltmxWidget.text=null;break;case"calendar":var date=new Date;voltmxWidget.dateComponents=[date.getDate(),date.getMonth()+1,date.getFullYear(),date.getHours(),date.getMinutes(),date.getSeconds()];break;case"image":voltmxWidget.src=null;break;case"switch":voltmxWidget.selectedIndex=0;break;case"slider":voltmxWidget.selectedValue=0;break;case"phone":voltmxWidget.text=null;break}}catch(err){voltmx.model.log.error("error in clear of widget controller.."+err.toString());throw err}};return WidgetController}();voltmx.model.SegmentWidgetController=function(){function SegmentWidgetController(viewObj,voltmxWidget,widgetConfig){voltmx.model.WidgetController.call(this,viewObj,voltmxWidget,widgetConfig)}inheritsFrom(SegmentWidgetController,voltmx.model.WidgetController);SegmentWidgetController.prototype.setDataToWidget=function(data){try{if(!data){return}voltmx.model.log.info(this.getWidgetId()+" JSON : ",data.getData());if(data&&data instanceof voltmx.model.Data){this.data=data;if(data.getData().length>0){this.getVoltmxWidget().setData(data.getData())}else{this.clear()}}else{voltmx.model.log.error("Invalid data Object, expected 'voltmx.model.Data' object");throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_INVALID_DATA_OBJECT,voltmx.model.ExceptionCode.MSG_ERROR_INVALID_DATA_OBJECT)}}catch(err){voltmx.model.log.error("Error while setting the data into "+this.getWidgetId()+", error: "+err.message);throw err}};SegmentWidgetController.prototype.addDataToSegment=function(data,index){try{if(data&&data instanceof voltmx.model.Data){if(index!==undefined&&index!==null){this.getVoltmxWidget().addDataAt(data.getData(),index)}else{this.getVoltmxWidget().addAll(data.getData())}}else{
voltmx.model.log.error("Invalid data Object, expected 'voltmx.model.Data' object");throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_INVALID_DATA_OBJECT,voltmx.model.ExceptionCode.MSG_ERROR_INVALID_DATA_OBJECT)}}catch(err){voltmx.model.log.error("Error while setting the data into "+this.getWidgetId()+", error: "+err.message);throw err}};SegmentWidgetController.prototype.getDataFromWidget=function(){var data=this.data;if(!this.data){data=voltmx.model.ApplicationContext.getFactorySharedInstance().createDataObject()}data.setData(this.voltmxWidget.data);return data};SegmentWidgetController.prototype.isValueChanged=function(data){return false};SegmentWidgetController.prototype.setMasterDataToWidget=function(masterData){voltmx.model.log.error("Not a data widget, do nothing!!!");this.clear()};SegmentWidgetController.prototype.getMasterDataFromWidget=function(){return null};SegmentWidgetController.prototype.clear=function(){try{this.data=undefined;this.getVoltmxWidget().removeAll();if(voltmx.model.Util.isIphone()||voltmx.model.Util.isIpad()){this.getVoltmxWidget().setData([])}else if(voltmx.model.Util.isAndroid()||voltmx.model.Util.isAndroidTablet()){this.getVoltmxWidget().setData([{}])}else{this.getVoltmxWidget().setData([{}])}if(this.getWidgetConfig().getWidgetDataMap()&&Object.keys(this.getWidgetConfig().getWidgetDataMap()).length>0)this.getVoltmxWidget().widgetDataMap=this.getWidgetConfig().getWidgetDataMap()}catch(err){voltmx.model.log.error("error in clear of segmentWidget controller.."+err.toString());throw err}};return SegmentWidgetController}();voltmx.model.ListBoxWidgetController=function(){function ListBoxWidgetController(viewObj,voltmxWidget,widgetConfig){voltmx.model.WidgetControllercall(this,viewObj,voltmxWidget,widgetConfig)}inheritsFrom(ListBoxWidgetController,voltmx.model.WidgetController);ListBoxWidgetController.prototype.setDataToWidget=function(data){try{if(!data){return}if(data instanceof voltmx.model.Data){this.getVoltmxWidget().selectedKey=data.getData()+"";voltmx.model.log.info("selected key for widget : "+this.getWidgetId()+" is "+this.getVoltmxWidget().selectedKey);this.data=data}else{voltmx.model.log.error("Invalid data Object, expected 'voltmx.model.Data' object");throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_INVALID_DATA_OBJECT,voltmx.model.ExceptionCode.MSG_ERROR_INVALID_DATA_OBJECT)}}catch(err){voltmx.model.log.error("error in setDataToWidget for listbox "+err.toString());throw err}};ListBoxWidgetController.prototype.getDataFromWidget=function(){try{var data=this.data;if(!this.data){data=voltmx.model.ApplicationContext.getFactorySharedInstance().createDataObject()}data.setData(this.getVoltmxWidget().selectedKey);return data}catch(err){voltmx.model.log.error("error in getData from widget for listbox "+err.toString());throw err}};ListBoxWidgetController.prototype.isValueChanged=function(data){try{if(data&&!(data instanceof voltmx.model.Data)){data=voltmx.model.ApplicationContext.getFactorySharedInstance().createDataObject(data)}var response;var tempData=this.getDataFromWidget().getData();var widgetData=data===undefined?data:data.getData();if(tempData===widgetData){response=false}else{response=true}return response}catch(err){voltmx.model.log.error("error in isvalueChanged for listbox "+err.toString());throw err}};ListBoxWidgetController.prototype.setMasterDataToWidget=function(masterData){try{this.getVoltmxWidget().masterData=masterData;if(masterData&&masterData[0]&&masterData[0][0]===-1){this.getVoltmxWidget().selectedKey=masterData[0][0]}else{this.getVoltmxWidget().selectedKey=null}}catch(err){voltmx.model.log.error("Error in setting master data to widget for listbox "+err.toString());throw err}};ListBoxWidgetController.prototype.getMasterDataFromWidget=function(){return this.getVoltmxWidget().masterData};ListBoxWidgetController.prototype.clear=function(){this.data=undefined;this.getVoltmxWidget().selectedKey=null};return ListBoxWidgetController}();voltmx.model.ComboBoxWidgetController=function(){function ComboBoxWidgetController(viewObj,voltmxWidget,widgetConfig){voltmx.model.WidgetController.call(this,viewObj,voltmxWidget,widgetConfig)}inheritsFrom(ComboBoxWidgetController,voltmx.model.WidgetController);ComboBoxWidgetController.prototype.setDataToWidget=function(data){try{if(!data){return}if(data instanceof voltmx.model.Data){this.getVoltmxWidget().selectedKey=data.getData()+"";voltmx.model.log.info("selected key for widget : "+this.getWidgetId()+" is "+this.getVoltmxWidget().selectedKey);this.data=data}else{voltmx.model.log.error("Invalid data Object, expected 'voltmx.model.Data' object");throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_INVALID_DATA_OBJECT,voltmx.model.ExceptionCode.MSG_ERROR_INVALID_DATA_OBJECT)}}catch(err){voltmx.model.log.error("Error in setting data to widget for combobox "+err.toString());throw err}};ComboBoxWidgetController.prototype.getDataFromWidget=function(){try{var data=this.data;if(!this.data){data=voltmx.model.ApplicationContext.getFactorySharedInstance().createDataObject()}data.setData(this.getVoltmxWidget().selectedKey);return data}catch(err){voltmx.model.log.error("Error in getting data to widget for combobox "+err.toString());throw err}};ComboBoxWidgetController.prototype.isValueChanged=function(data){try{if(data&&!(data instanceof voltmx.model.Data)){data=voltmx.model.ApplicationContext.getFactorySharedInstance().createDataObject()}var response;var tempData=this.getDataFromWidget().getData();var widgetData=data===undefined?data:data.getData();if(tempData===widgetData){response=false}else{response=true}return response}catch(err){voltmx.model.log.error("Error in isValueChanged for combobox "+err.toString());throw err}};ComboBoxWidgetController.prototype.setMasterDataToWidget=function(masterData){try{this.getVoltmxWidget().masterData=masterData;if(masterData&&masterData[0]&&masterData[0][0]===-1){this.getVoltmxWidget().selectedKey=masterData[0][0]}else{this.getVoltmxWidget().selectedKey=null}}catch(err){voltmx.model.log.error("Error in setting master data to widget for combobox "+err.toString());throw err}};ComboBoxWidgetController.prototype.getMasterDataFromWidget=function(){return this.getVoltmxWidget().masterData};ComboBoxWidgetController.prototype.clear=function(){this.data=undefined;this.getVoltmxWidget().selectedKey=null};return ComboBoxWidgetController}();voltmx.model.MapWidgetController=function(){function MapWidgetController(viewObj,voltmxWidget,widgetConfig){voltmx.model.WidgetController.call(this,viewObj,voltmxWidget,widgetConfig)}inheritsFrom(MapWidgetController,voltmx.model.WidgetController);MapWidgetController.prototype.setDataToWidget=function(data){try{if(!data){return}this.getVoltmxWidget().locationData=data.getData();this.data=data}catch(err){voltmx.model.log.error("Error while setting the data into "+this.getWidgetId()+", error: "+err.message)}};MapWidgetController.prototype.getDataFromWidget=function(){try{var data=this.data;if(!this.data){data=voltmx.model.ApplicationContext.getFactorySharedInstance().createDataObject()}data.setData(this.getVoltmxWidget().locationData);return data}catch(err){voltmx.model.log.error("Error in getting data to widget for map "+err.toString());throw err}};MapWidgetController.prototype.isValueChanged=function(data){try{if(data&&!(data instanceof voltmx.model.Data)){data=voltmx.model.ApplicationContext.getFactorySharedInstance().createDataObject()}var response;var tempData=this.getDataFromWidget().getData();var widgetData=data===undefined?data:data.getData();if(tempData===widgetData){response=false}else{response=true}return response}catch(err){voltmx.model.log.error("Error in isValueChanged for map "+err.toString());throw err}};MapWidgetController.prototype.setMasterDataToWidget=function(masterData){voltmx.model.log.error("Not a data widget, do nothing!!!");this.clear()};MapWidgetController.prototype.getMasterDataFromWidget=function(){return null};MapWidgetController.prototype.clear=function(){this.getVoltmxWidget().clear()};return MapWidgetController}();voltmx.model.RadioButtonGroupWidgetController=function(){function RadioButtonGroupWidgetController(viewObj,voltmxWidget,widgetConfig){voltmx.model.WidgetController.call(this,viewObj,voltmxWidget,widgetConfig)}inheritsFrom(RadioButtonGroupWidgetController,voltmx.model.WidgetController);RadioButtonGroupWidgetController.prototype.setDataToWidget=function(data){try{if(!data){return}if(data instanceof voltmx.model.Data){this.getVoltmxWidget().selectedKey=data.getData()+"";voltmx.model.log.info("selected key for widget : "+this.getWidgetId()+" is "+this.getVoltmxWidget().selectedKey);this.data=data}else{voltmx.model.log.error("Invalid data Object, expected 'voltmx.model.Data' object");throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_INVALID_DATA_OBJECT,voltmx.model.ExceptionCode.MSG_ERROR_INVALID_DATA_OBJECT)}}catch(err){voltmx.model.log.error("error in setDataToWidget for radiobuttongroup "+err.toString());throw err}};RadioButtonGroupWidgetController.prototype.getDataFromWidget=function(){try{var data=this.data;if(!this.data){data=voltmx.model.ApplicationContext.getFactorySharedInstance().createDataObject()}data.setData(this.getVoltmxWidget().selectedKey);return data}catch(err){voltmx.model.log.error("error in getData from widget for radiobuttongroup "+err.toString());throw err}};RadioButtonGroupWidgetController.prototype.isValueChanged=function(data){try{if(data&&!(data instanceof voltmx.model.Data)){data=voltmx.model.ApplicationContext.getFactorySharedInstance().createDataObject(data)}var response;var tempData=this.getDataFromWidget().getData();var widgetData=data===undefined?data:data.getData();if(tempData===widgetData){response=false}else{response=true}return response}catch(err){voltmx.model.log.error("error in isvalueChanged for radiobuttongroup "+err.toString());throw err}};RadioButtonGroupWidgetController.prototype.setMasterDataToWidget=function(masterData){try{this.getVoltmxWidget().masterData=masterData;if(masterData&&masterData[0]&&masterData[0][0]===-1){this.getVoltmxWidget().selectedKey=masterData[0][0]}else{this.getVoltmxWidget().selectedKey=null}}catch(err){voltmx.model.log.error("Error in setting master data to widget for radiobuttongroup "+err.toString());throw err}};RadioButtonGroupWidgetController.prototype.getMasterDataFromWidget=function(){return this.getVoltmxWidget().masterData};RadioButtonGroupWidgetController.prototype.clear=function(){this.data=undefined;this.getVoltmxWidget().selectedKey=null};return RadioButtonGroupWidgetController}();voltmx.model.ConfigClass=function(){function ConfigClass(modelConfig){var formid=undefined;var controller=undefined;var entity=undefined;var query=undefined;var querytype=undefined;var queryParams=undefined;var widgets={};var flexform=undefined;var searchConfig=undefined;var customInfo=undefined;var widgetController="controller";var objectServiceName=undefined;var objectServiceOptions=undefined;var requestOptions=undefined;var additionalFields=undefined;var constrained=undefined;var customVerb=undefined;var serviceOptionsMap={};var objectServiceMap={};var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();if(typeof modelConfig==="undefined"||modelConfig===""){modelConfig={};return}try{var modelConfig=modelConfig;formid=modelConfig.formid;this.getFormId=function(){return formid};this.getController=function(){return controller};this.getEntity=function(){return entity};this.getQuery=function(){return query};this.getQueryParams=function(){return queryParams};this.getWidgets=function(){return widgets};this.getWidget=function(widgetid){if(typeof widgetid==="undefined"){throw appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_WIDGETID_NOT_DEFINED,voltmx.model.ExceptionCode.MSG_ERROR_WIDGETID_NOT_DEFINED+" - "+widgetid)}return widgets[widgetid]};this.getSearchInfo=function(widgetid){if(typeof widgetid=="undefined"){return searchConfig}return searchConfig&&searchConfig[widgetid]};this.getCustomInfoKeys=function(){var keys=[];for(var key in customInfo){keys.push(key)}return keys};this.getCustomInfo=function(key){if(typeof key=="undefined"){return customInfo}return customInfo&&customInfo[key]};this.getObjectServiceOptions=function(){return objectServiceOptions};this.getObjectServiceName=function(){return objectServiceName};this.getRequestOptions=function(){return requestOptions};this.getAdditionalFields=function(){return additionalFields};this.isConstrained=function(){if(typeof this.constrained=="undefined"){return false}return true};this.getCustomVerb=function(){return customVerb};this.getServiceOptions=function(widgetId){if(serviceOptionsMap[widgetId])return serviceOptionsMap[widgetId];return this.getObjectServiceOptions()};this.getObjectServiceNameOfContainer=function(containerId){if(objectServiceMap[containerId])return objectServiceMap[containerId];return this.getObjectServiceName()};controller=modelConfig[this.getFormId()]["controller"];entity=modelConfig[this.getFormId()]["entity"];query=modelConfig[this.getFormId()]["query"];querytype=modelConfig[this.getFormId()]["querytype"];queryParams=modelConfig[this.getFormId()]["queryParams"];objectServiceOptions=modelConfig[this.getFormId()]["objectServiceOptions"];objectServiceName=modelConfig[this.getFormId()]["objectServiceName"];requestOptions=modelConfig[this.getFormId()]["requestOptions"];additionalFields=modelConfig[this.getFormId()]["additionalFields"];constrained=modelConfig[this.getFormId()]["constrained"];customVerb=modelConfig[this.getFormId()]["customVerb"];for(var widgetid in modelConfig){if(!(widgetid=="formid"||widgetid==this.getFormId())){var widgettype=modelConfig[widgetid]["fieldprops"]&&modelConfig[widgetid]["fieldprops"]["widgettype"];var widgetconfig;if(widgettype=="Segment"||widgettype=="segment"){widgetconfig=appFactoryInstance.createSegmentWidgetConfigObject(widgetid,modelConfig[widgetid])}else{widgetconfig=appFactoryInstance.createWidgetConfigObject(widgetid,modelConfig[widgetid])}widgets[widgetid]=widgetconfig;serviceOptionsMap[widgetid]=modelConfig[widgetid]["fieldprops"]["objectServiceOptions"];objectServiceMap[widgetid]=modelConfig[widgetid]["fieldprops"]["objectServiceName"]}}var searchConfigVal=modelConfig[this.getFormId()]["searchConfig"];searchConfig={};for(var widgetid in searchConfigVal){var searchConfigObj=appFactoryInstance.createSearchInfoObject(widgetid,searchConfigVal[widgetid]);searchConfig[widgetid]=searchConfigObj}customInfo=modelConfig[this.getFormId()]["customInfo"]}catch(err){voltmx.model.log.error("error in config constructor :: "+err);throw err}}ConfigClass.prototype.getWidgetController=function(widgetid){if(typeof widgetid==="undefined"){throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_WIDGETID_NOT_DEFINED,voltmx.model.ExceptionCode.MSG_ERROR_WIDGETID_NOT_DEFINED)}if(this.getWidgets()[widgetid]){return this.getWidgets()[widgetid].getWidgetController()}else{return null}};ConfigClass.prototype.getWidgetType=function(widgetid){if(typeof widgetid==="undefined"){throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_WIDGETID_NOT_DEFINED,voltmx.model.ExceptionCode.MSG_ERROR_WIDGETID_NOT_DEFINED)}if(this.getWidgets()[widgetid]){return this.getWidgets()[widgetid].getWidgetType()}else{return null}};ConfigClass.prototype.getWidgetEntity=function(widgetid){if(typeof widgetid==="undefined"){throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_WIDGETID_NOT_DEFINED,voltmx.model.ExceptionCode.MSG_ERROR_WIDGETID_NOT_DEFINED)}if(this.getWidgets()[widgetid]){return this.getWidgets()[widgetid].getWidgetEntity()}else{return null}};ConfigClass.prototype.getWidgetField=function(widgetid){if(typeof widgetid==="undefined"){throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_WIDGETID_NOT_DEFINED,voltmx.model.ExceptionCode.MSG_ERROR_WIDGETID_NOT_DEFINED)}if(this.getWidgets()[widgetid]){return this.getWidgets()[widgetid].getField()}else{return null}};ConfigClass.prototype.getWidgetNames=function(){var widgetnames=[];var widgets=this.getWidgets();for(var widgetid in widgets){widgetnames.push(widgetid)}return widgetnames};ConfigClass.prototype.getWidgetDataMap=function(widgetid){if(typeof widgetid=="undefined"){return null}else{return this.getWidgets()[widgetid].getWidgetDataMap()}};ConfigClass.prototype.getMasterDataEnabledWidgets=function(){var widgets=this.getWidgets();var widgetArray=[];var widgetType;for(var widget in widgets){widgetType=widgets[widget].getWidgetType();if(widgetType&&(widgetType.toLowerCase()==="combobox"||widgetType.toLowerCase()==="listbox"||widgetType.toLowerCase()==="radiobuttongroup")){widgetArray.push(widget)}}return widgetArray};ConfigClass.prototype.getWidgetHierarchyMap=function(){try{var widgets=this.getWidgets();var widgetHierarchyMap={};var formEntityName=this.getEntity();var formName=this.getFormId();var widgetType,entityName,parentName,fieldName,parentEntity;for(var widget in widgets){widgetType=widgets[widget].getWidgetType().toLowerCase();entityName=widgets[widget].getWidgetEntity();switch(widgetType){case"label":case"button":case"textbox":case"textarea":case"textarea2":case"textfield":case"textbox2":case"link":case"image":case"calendar":case"listbox":case"combobox":case"switch":case"slider":case"phone":case"richtext":case"radiobuttongroup":if(widgets[widget].isQueryDefined()){widgetHierarchyMap[widget]={};widgetHierarchyMap[widget]["widgets"]={};widgetHierarchyMap[widget]["config"]=widgets[widget];widgetHierarchyMap[widget]["widgets"][widget]=widgets[widget];widgetHierarchyMap[widget]["entityName"]=entityName;widgetHierarchyMap[widget]["child"]={};break}fieldName=widgets[widget].getField();if(widgets[widget].isParentDefined()){parentName=widgets[widget].getParent();if(parentName==this.getFormId()){parentName=="form";parentEntity=formEntityName}else{parentEntity=widgets[parentName].getWidgetEntity()}if(widgets[widget].isComputedField()||fieldName&&entityName===parentEntity){widgetHierarchyMap[parentName]=widgetHierarchyMap[parentName]||{};widgetHierarchyMap[parentName]["widgets"]=widgetHierarchyMap[parentName]["widgets"]||{};widgetHierarchyMap[parentName]["widgets"][widget]=widgets[widget];widgetHierarchyMap[parentName]["config"]=widgetHierarchyMap[parentName]["config"]||widgets[parentName];widgetHierarchyMap[parentName]["entityName"]=entityName;widgetHierarchyMap[parentName]["child"]={}}}else{parentName="form";if(widgets[widget].isComputedField()||fieldName&&entityName===formEntityName){widgetHierarchyMap[parentName]=widgetHierarchyMap[parentName]||{};widgetHierarchyMap[parentName]["widgets"]=widgetHierarchyMap[parentName]["widgets"]||{};widgetHierarchyMap[parentName]["widgets"][widget]=widgets[widget];widgetHierarchyMap[parentName]["config"]=this;widgetHierarchyMap[parentName]["entityName"]=formEntityName;widgetHierarchyMap[parentName]["child"]={}}}break;case"flexcontainer":case"flexscrollcontainer":case"userwidgetinstance":if(widgets[widget].isQueryDefined()||widgets[widget].getAdditionalFields()){widgetHierarchyMap[widget]=widgetHierarchyMap[widget]||{};widgetHierarchyMap[widget]["widgets"]=widgetHierarchyMap[widget]["widgets"]||{};widgetHierarchyMap[widget]["config"]=widgets[widget];widgetHierarchyMap[widget]["entityName"]=entityName;widgetHierarchyMap[widget]["child"]={}}break;case"map":case"segment":widgetHierarchyMap[widget]={};widgetHierarchyMap[widget]["config"]=widgets[widget];widgetHierarchyMap[widget]["widgets"]={};widgetHierarchyMap[widget]["widgets"][widget]=widgets[widget];widgetHierarchyMap[widget]["entityName"]=entityName;break;default:voltmx.model.log.error("Not a data widget, do nothing!!!");break}}function prepareFormEntityDefTree(entityDef,containerId){var parent;for(var container in entityDef){if(containerId!=="form"&&container!==containerId&&widgets[containerId].isParentDefined()){parent=widgets[containerId].getParent();parent=parent===formName?"form":parent;if(parent===container){entityDef[container]["child"][containerId]=widgetHierarchyMap[containerId];delete widgetHierarchyMap[containerId];break}else{prepareFormEntityDefTree(entityDef[container]["child"],containerId)}}}return}if(this.getAdditionalFields()){widgetHierarchyMap["form"]=widgetHierarchyMap["form"]||{};widgetHierarchyMap["form"]["widgets"]=widgetHierarchyMap["form"]["widgets"]||{};widgetHierarchyMap["form"]["config"]=this;widgetHierarchyMap["form"]["entityName"]=formEntityName;widgetHierarchyMap["form"]["child"]={}}var containerWidgets=Object.keys(widgetHierarchyMap);for(var i in containerWidgets){prepareFormEntityDefTree(widgetHierarchyMap,containerWidgets[i])}return widgetHierarchyMap}catch(err){voltmx.model.log.error("Error getting query enabled widgets map - "+err.toString());throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_GETTING_QUERY_WIDGETS_MAPPING,voltmx.model.ExceptionCode.MSG_ERROR_GETTING_QUERY_WIDGETS_MAPPING,err)}};return ConfigClass}();voltmx.model.widgetConfig=function(){function widgetConfig(widgetid,widgetconfig){if(typeof widgetid==="undefined"){throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_WIDGETID_NOT_DEFINED,voltmx.model.ExceptionCode.MSG_ERROR_WIDGETID_NOT_DEFINED)}this.widgetid=widgetid;this.widgetcontroller=undefined;this.widgettype=undefined;this.entity=undefined;this.field=undefined;this.fieldQuery=undefined;this.constrained=undefined;this.parent=undefined;this.query=undefined;this.computed=false;this.aggrfunction=undefined;this.additionalFields=undefined;this.requestOptions=undefined;this.customVerb=undefined;try{if(typeof widgetconfig=="undefined"||widgetconfig==""){widgetconfig={};return}var fieldProps=widgetconfig["fieldprops"];this.widgettype=fieldProps&&fieldProps["widgettype"];this.entity=fieldProps&&fieldProps["entity"];this.field=fieldProps&&fieldProps["field"];if(typeof this.field=="string")this.field=[this.field];this.widgetcontroller=fieldProps&&fieldProps["controller"]||fieldProps&&"WidgetController";this.fieldQuery=fieldProps&&fieldProps["fieldQuery"];this.constrained=fieldProps&&fieldProps["constrained"];this.parent=fieldProps&&fieldProps["parent"];this.query=fieldProps&&fieldProps["query"];this.querytype=fieldProps&&fieldProps["querytype"];this.queryParams=fieldProps&&fieldProps["queryParams"];this.tabepaneId=widgetconfig["tabpaneId"];this.computed=fieldProps&&fieldProps["computed"];this.aggrfunction=fieldProps&&fieldProps["aggrfunction"];this.additionalFields=fieldProps&&fieldProps["additionalFields"];this.requestOptions=fieldProps&&fieldProps["requestOptions"];this.postProcessor=fieldProps&&fieldProps["postProcessor"];this.customVerb=fieldProps&&fieldProps["customVerb"]}catch(err){throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_WHILE_PROCESSING_WIDGETCONFIG,voltmx.model.ExceptionCode.MSG_ERROR_WHILE_PROCESSING_WIDGETCONFIG+widgetid+"err: "+err.toString())}}widgetConfig.prototype.setWidgetId=function(widgetId){this.widgetid=widgetId};widgetConfig.prototype.getWidgetId=function(){return this.widgetid};widgetConfig.prototype.setWidgetController=function(widgetController){this.widgetcontroller=widgetController};widgetConfig.prototype.getWidgetController=function(){return this.widgetcontroller};widgetConfig.prototype.setWidgetType=function(widgettype){this.widgettype=widgettype};widgetConfig.prototype.getWidgetType=function(){return this.widgettype};widgetConfig.prototype.setWidgetEntity=function(entity){this.entity=entity};widgetConfig.prototype.getWidgetEntity=function(){return this.entity};widgetConfig.prototype.getEntity=function(){return this.entity};widgetConfig.prototype.setField=function(fieldName){this.field=fieldName;if(typeof this.field=="string")this.field=[this.field]};widgetConfig.prototype.getField=function(){return this.field};widgetConfig.prototype.getPostProcessor=function(){return this.postProcessor};widgetConfig.prototype.isQueryDefined=function(){if(typeof this.query=="undefined"){return false}return true};widgetConfig.prototype.isParentDefined=function(){if(typeof this.parent=="undefined"){return false}return true};widgetConfig.prototype.isComputedField=function(){if(typeof this.computed=="undefined"){return false}return true};widgetConfig.prototype.isDataWidget=function(){return false};widgetConfig.prototype.getFieldQuery=function(){return this.fieldQuery};widgetConfig.prototype.getQuery=function(){return this.query};widgetConfig.prototype.getQueryType=function(){return this.querytype};widgetConfig.prototype.getQueryParams=function(){return this.queryParams};widgetConfig.prototype.isTabPaneWidget=function(){if(typeof this.tabepaneId=="undefined")return false;return true};widgetConfig.prototype.getTabPaneId=function(){return this.tabepaneId};widgetConfig.prototype.getWidgetDataMap=function(){return null};widgetConfig.prototype.isConstrained=function(){if(typeof this.constrained=="undefined"){return false}return true};widgetConfig.prototype.getParent=function(){return this.parent};widgetConfig.prototype.getAdditionalFields=function(){return this.additionalFields};widgetConfig.prototype.getRequestOptions=function(){return this.requestOptions};widgetConfig.prototype.getCustomVerb=function(){return this.customVerb};return widgetConfig}();voltmx.model.SegmentWidgetConfig=function(){function SegmentWidgetConfig(widgetid,segmentwidgetConfig){voltmx.model.widgetConfig.call(this,widgetid,segmentwidgetConfig);var fieldprops=segmentwidgetConfig["fieldprops"];this.pagination=fieldprops&&fieldprops["pagination"];this.pagesize=fieldprops&&fieldprops["pagesize"];this.widgettype=fieldprops&&fieldprops["widgettype"];this.entity=fieldprops&&fieldprops["entity"];this.field=fieldprops&&fieldprops["field"];this.query=fieldprops&&fieldprops["query"];this.querytype=fieldprops&&fieldprops["querytype"];this.queryParams=fieldprops&&fieldprops["queryParams"];this.constrained=fieldprops&&fieldprops["constrained"];this.secheaderfields=this.field&&this.field["header_Fields"];this.groupByKey=fieldprops["groupBy"];this.sortByKey=fieldprops["sortBy"];this.sortType=fieldprops["sortType"];this.additionalFields=fieldprops&&fieldprops["additionalFields"];this.requestOptions=fieldprops&&fieldprops["requestOptions"];if(this.field&&this.field["header_Fields"]){delete this.field["header_Fields"]}var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();for(var widgetid in this.field){this.field[widgetid]=appFactoryInstance.createSegmentFieldObject(widgetid,this.field[widgetid])}if(this.secheaderfields){for(var secheaderId in this.secheaderfields){this.field[secheaderId]=appFactoryInstance.createSegmentFieldObject(secheaderId,this.secheaderfields[secheaderId]);this.secheaderfields[secheaderId]=this.field[secheaderId]}}}inheritsFrom(SegmentWidgetConfig,voltmx.model.widgetConfig);SegmentWidgetConfig.prototype.getWidgetType=function(){return this.widgettype};SegmentWidgetConfig.prototype.getWidgetEntity=function(){return this.entity};SegmentWidgetConfig.prototype.getEntity=function(){return this.entity};SegmentWidgetConfig.prototype.setField=function(widgetid,fieldInfo){if(typeof widgetid==="undefined"){throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_WIDGETID_NOT_DEFINED,voltmx.model.ExceptionCode.MSG_ERROR_WIDGETID_NOT_DEFINED)}this.field[widgetid]=voltmx.model.ApplicationContext.getFactorySharedInstance().createSegmentFieldObject(widgetid,fieldInfo)};SegmentWidgetConfig.prototype.getSubField=function(widgetid){return this.field[widgetid]};SegmentWidgetConfig.prototype.getField=function(){return this.field};SegmentWidgetConfig.prototype.setPagination=function(bool){this.pagination=bool};SegmentWidgetConfig.prototype.isPagination=function(){return this.pagination};SegmentWidgetConfig.prototype.setPageSize=function(pagesize){this.pagesize=pagesize};SegmentWidgetConfig.prototype.getPageSize=function(){return this.pagesize};SegmentWidgetConfig.prototype.isDataWidget=function(){return true};SegmentWidgetConfig.prototype.getQuery=function(){return this.query};SegmentWidgetConfig.prototype.getQueryType=function(){return this.querytype};SegmentWidgetConfig.prototype.getQueryParams=function(){return this.queryParams};SegmentWidgetConfig.prototype.getWidgetDataMap=function(){var widgetDataMap={};var segmentMap=this.getField();for(var segmentKey in segmentMap){var fieldName=segmentMap[segmentKey].getFieldName();var aliasName=segmentMap[segmentKey].getAliasName();if(!aliasName){aliasName="";for(var indx in fieldName)aliasName=aliasName+"_"+fieldName[indx];aliasName=aliasName.substring(1,aliasName.length)}widgetDataMap[segmentKey]=aliasName}return widgetDataMap};SegmentWidgetConfig.prototype.isConstrained=function(){if(typeof this.constrained=="undefined"){return false}return true};SegmentWidgetConfig.prototype.isSecHeaderDefined=function(){if(!this.secheaderfields){return false}return true};SegmentWidgetConfig.prototype.getSecHeaderFields=function(){return this.secheaderfields};SegmentWidgetConfig.prototype.isGroupByDefined=function(){if(this.groupByKey)return true;return false};SegmentWidgetConfig.prototype.isSortByDefined=function(){if(this.sortByKey)return true;return false};SegmentWidgetConfig.prototype.getGroupByKey=function(){return this.groupByKey};SegmentWidgetConfig.prototype.getSortByKey=function(){return this.sortByKey};SegmentWidgetConfig.prototype.getSortType=function(){return this.sortType};SegmentWidgetConfig.prototype.getAdditionalFields=function(){return this.additionalFields};SegmentWidgetConfig.prototype.getRequestOptions=function(){return this.requestOptions};return SegmentWidgetConfig}();voltmx.model.SegmentField=function(){function SegmentField(widgetid,fieldInfo){if(typeof widgetid==="undefined"){throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_WIDGETID_NOT_DEFINED,voltmx.model.ExceptionCode.MSG_ERROR_WIDGETID_NOT_DEFINED)}this.widgetid=widgetid;this.widgettype=fieldInfo.widgettype;this.field=fieldInfo.field;if(typeof this.field=="string")this.field=[this.field];this.table=fieldInfo.table;this.alias=fieldInfo.alias;this.aggrfunction=fieldInfo.aggrfunction;this.fieldtype=fieldInfo.fieldtype;this.text=fieldInfo.text;this.postProcessor=fieldInfo.postProcessor}SegmentField.prototype.getWidgetType=function(){return this.widgettype};SegmentField.prototype.getFieldName=function(){return this.field};SegmentField.prototype.getWidgetId=function(){return this.widgetid};SegmentField.prototype.getEntityName=function(){return this.table};SegmentField.prototype.getAliasName=function(){return this.alias};SegmentField.prototype.getAggrfunction=function(){return this.aggrfunction};SegmentField.prototype.getFieldtype=function(){return this.fieldtype};SegmentField.prototype.getWidgetText=function(){return this.text};SegmentField.prototype.getPostProcessor=function(){return this.postProcessor};return SegmentField}();voltmx.model.Data=function(){function Data(dataVal,displayVal,dataTypeVal,contextDataVal){var data;var displayValue;var dataType;var contextData;this.getData=function(){return data};this.setData=function(dataVal){data=dataVal};this.getDisplayValue=function(){return displayValue};this.setDisplayValue=function(displayVal){displayValue=displayVal};this.getDataType=function(){return dataType};this.setDataType=function(dataTypeVal){dataType=dataTypeVal}
;this.getContextData=function(){return contextData};this.setContextData=function(contextDataVal){contextData=contextDataVal};this.setData(dataVal);this.setDisplayValue(displayVal);this.setDataType(dataTypeVal);this.setContextData(contextDataVal)}Data.prototype.clone=function(){var dataClone=voltmx.model.ApplicationContext.getFactorySharedInstance().createDataObject();var baseData=this.getData();if(typeof baseData==="object"){var copyData=JSON.parse(JSON.stringify(baseData))}else{var copyData=baseData}dataClone.setData(copyData);dataClone.setDisplayValue(this.getDisplayValue());dataClone.setDataType(this.getDataType());dataClone.setContextData(this.getContextData());return dataClone};return Data}();voltmx=voltmx||{};voltmx.model=voltmx.model||{};voltmx.model.ViewModel=function(){function ViewModel(config,voltmxForm){var formModelProperties={};var observerViews={};var modelConfig=config;var formModelExt;var view=voltmx.model.ApplicationContext.getFactorySharedInstance().createViewObject(modelConfig,voltmxForm);this.getObserverViews=function(){return observerViews};this.registerObserver=function(observer){observerViews[observer.getConfig().getFormId()]=observer};this.removeObserver=function(observer){observerViews[observer.getConfig().getFormId()]=undefined};this.getConfig=function(){return modelConfig};this.getView=function(){return view};this.getFormModelProperties=function(){return formModelProperties};this.getFormModelProperty=function(formModelPropertyName){return formModelProperties[formModelPropertyName]};this.setFormModelProperty=function(formModelPropertyName,data){formModelProperties[formModelPropertyName]=data};this.clearFormModelProperties=function(){formModelProperties={}};this.initializeFormModelProperties=function(view){try{var widgets=view.getConfig().getWidgets();for(var widgetId in widgets){if(view.getVoltmxWidget(widgetId)){this.getWidgetData(widgetId)}}}catch(err){voltmx.model.log.error("error in initialize form model properties : "+err);var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();throw appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_FORMMODEL_PROPERTIES_INIT,voltmx.model.ExceptionCode.MSG_ERROR_FORMMODEL_PROPERTIES_INIT,err)}};this.registerObserver(view);this.initializeFormModelProperties(view)}ViewModel.prototype.notifyObservers=function(formModelPropertyName){try{var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();var data=this.getFormModelProperty(formModelPropertyName);if(!(data instanceof voltmx.model.Data)){data=appFactoryInstance.createDataObject(data)}for(var key in this.getObserverViews()){this.getObserverViews()[key].update(formModelPropertyName,data.clone())}}catch(err){voltmx.model.log.error("error in form model notify view observer : "+err);var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();throw appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_NOTIFYING_OBSERVERS,voltmx.model.ExceptionCode.MSG_ERROR_NOTIFYING_OBSERVERS,err)}};ViewModel.prototype.getWidgetData=function(formModelPropertyName){try{var viewdata=this.getView().getDataFromWidget(formModelPropertyName);this.setFormModelProperty(formModelPropertyName,viewdata.clone());return this.getFormModelProperty(formModelPropertyName)}catch(err){voltmx.model.log.error("error in form model get property data :"+err);var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();throw appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_GET_WIDGET_DATA_FORMMODEL,voltmx.model.ExceptionCode.MSG_ERROR_GET_WIDGET_DATA_FORMMODEL,err)}};ViewModel.prototype.setWidgetData=function(formModelPropertyName,data,doNotNotify){try{var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();if(!(data instanceof voltmx.model.Data)){data=appFactoryInstance.createDataObject(data)}this.setFormModelProperty(formModelPropertyName,data);if(!doNotNotify){this.notifyObservers(formModelPropertyName)}}catch(err){voltmx.model.log.error("error in form model set property data :"+err);var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();throw appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_SET_WIDGET_DATA_FORMMODEL,voltmx.model.ExceptionCode.MSG_ERROR_SET_WIDGET_DATA_FORMMODEL,err)}};ViewModel.prototype.isPropertyValueChanged=function(formModelPropertyName){try{return this.getView().isWidgetValueChanged(formModelPropertyName,this.getFormModelProperty(formModelPropertyName))}catch(err){voltmx.model.log.error("error in form model property value change :"+err);var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();throw appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_FORMMODEL_PROPERTY_VALUE_CHANGED,voltmx.model.ExceptionCode.MSG_ERROR_FORMMODEL_PROPERTY_VALUE_CHANGED,err)}};ViewModel.prototype.clear=function(){voltmx.model.log.info("inside form model clear");try{this.clearFormModelProperties();for(var key in this.getObserverViews()){this.getObserverViews()[key].clear();this.initializeFormModelProperties(this.getObserverViews()[key])}}catch(err){voltmx.model.log.error("error in clear view observers.."+err);var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();throw appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_FORMMODEL_CLEAR,voltmx.model.ExceptionCode.MSG_ERROR_FORMMODEL_CLEAR,err)}};ViewModel.prototype.destroy=function(){try{this.clearFormModelProperties();modelConfig=null;for(var key in this.getObserverViews()){this.getObserverViews()[key].destroy()}voltmx.model.log.info("Destroying FormModel end ")}catch(err){voltmx.model.log.error("error in form model destroy : "+err);var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();throw appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_FORMMODEL_DESTROY,voltmx.model.ExceptionCode.MSG_ERROR_FORMMODEL_DESTROY,err)}};ViewModel.prototype.update=function(widgetArray){try{var data;if(!widgetArray){widgetArray=this.getConfig().getWidgetNames()}for(var index in widgetArray){data=this.getFormModelProperty(widgetArray[index]);for(var key in this.getObserverViews()){this.getObserverViews()[key].update(widgetArray[index],data.clone())}}}catch(err){voltmx.model.log.error("error in form model update view observer : "+err);var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();throw appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_FORMMODEL_UPDATE,voltmx.model.ExceptionCode.MSG_ERROR_FORMMODEL_UPDATE,err)}};ViewModel.prototype.showView=function(){try{this.getView().showform()}catch(err){voltmx.model.log.error("error in form model show form : "+err);var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();throw appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_FORMMODEL_SHOWVIEW,voltmx.model.ExceptionCode.MSG_ERROR_FORMMODEL_SHOWVIEW,err)}};ViewModel.prototype.setMasterDataByProperty=function(masterData,formModelPropertyName){try{for(var key in this.getObserverViews()){this.getObserverViews()[key].updateMasterData(masterData,formModelPropertyName)}}catch(err){voltmx.model.log.error("error in form model set property master data :"+err);var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();throw appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_FORMMODEL_SET_MASTERDATA,voltmx.model.ExceptionCode.MSG_ERROR_FORMMODEL_SET_MASTERDATA,err)}};ViewModel.prototype.getMasterDataByProperty=function(formModelPropertyName){try{return this.getView().getMasterDataFromWidget(formModelPropertyName)}catch(err){voltmx.model.log.error("error in form model get property master data :"+err);var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();throw appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_FORMMODEL_GET_MASTERDATA,voltmx.model.ExceptionCode.MSG_ERROR_FORMMODEL_GET_MASTERDATA,err)}};ViewModel.prototype.setViewAttributeByProperty=function(formModelPropertyName,attributeName,attributeVal){try{this.getView().setAttributeByProperty(formModelPropertyName,attributeName,attributeVal)}catch(err){voltmx.model.log.error("error in form model set property view attribute :"+err);throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_FORMMODEL_SET_VIEW_ATTRIBUTE,voltmx.model.ExceptionCode.MSG_ERROR_FORMMODEL_SET_VIEW_ATTRIBUTE,err)}};ViewModel.prototype.getViewAttributeByProperty=function(formModelPropertyName,attributeName){try{var attributeVal=this.getView().getAttributeByProperty(formModelPropertyName,attributeName);return attributeVal}catch(err){voltmx.model.log.error("error in form model get property view attribute :"+err);throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_FORMMODEL_GET_VIEW_ATTRIBUTE,voltmx.model.ExceptionCode.MSG_ERROR_FORMMODEL_GET_VIEW_ATTRIBUTE,err)}};ViewModel.prototype.performActionOnView=function(formModelPropertyName,actionName,argsArray){try{return this.getView().performAction(formModelPropertyName,actionName,argsArray)}catch(err){voltmx.model.log.error("error in form model execute property view method :"+err);throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_FORMMODEL_PERFORM_ACTION_ONVIEW,voltmx.model.ExceptionCode.MSG_ERROR_FORMMODEL_PERFORM_ACTION_ONVIEW,err)}};ViewModel.prototype.performAction=function(actionName,argsArray){try{if(this[actionName]&&typeof this[actionName]==="function"){return this[actionName].apply(this,argsArray)}else{voltmx.model.log.error("no action found in form model for actionname : "+actionName)}}catch(err){voltmx.model.log.error("error in form model perform action : "+err);throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_FORMMODEL_PERFORM_ACTION,voltmx.model.ExceptionCode.MSG_ERROR_FORMMODEL_PERFORM_ACTION,err)}};ViewModel.prototype.getForm=function(){return this.getView().voltmxform};ViewModel.prototype.formatUI=function(){return this.getFormModelExtensionObj().formatUI()};return ViewModel}();voltmx=voltmx||{};voltmx.model=voltmx.model||{};voltmx.model.persistent=voltmx.model.persistent||{};voltmx.model.persistent.GroupWidgetsContextCommon=function(){function GroupWidgetsContextCommon(configObject,contextDataObj){var widgetContextMap={};var config=configObject;var contextData=contextDataObj;var widgetsList=[];var ORMController=undefined;this.getConfig=function(){return config};this.getContextData=function(){return contextData};this.getORMController=function(){if(!ORMController){var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();var INSTANCE=voltmx.model.ApplicationContext;ORMController=appFactoryInstance.createORMControllerObject(INSTANCE,config.getObjectServiceOptions())}return ORMController};this.setWidgetContext=function(widget,context){widgetContextMap[widget]=context};this.getWidgetContext=function(widget){return widgetContextMap[widget]};this.getWidgetContextMap=function(){return widgetContextMap};this.getWidgetHierarchyMap=function(){return widgetHierarchyMap};this.addToWidgetList=function(widgetId){widgetsList.push(widgetId)};this.getWidgetList=function(){return widgetsList};this.getFetchWidgetList=function(){var widgets=[];for(var indx in widgetsList){if(widgetContextMap[widgetsList[indx]]&&!widgetContextMap[widgetsList[indx]]["constrained"])widgets.push(widgetsList[indx])}return widgets};this.generateContextForWidgets=function(widgetHierarchyMap){for(var widgetId in widgetHierarchyMap){if(widgetHierarchyMap[widgetId]){this.addToWidgetList(widgetId);this.generateWidgetContext(widgetId,widgetHierarchyMap[widgetId]);var childWidgetsMap=widgetHierarchyMap[widgetId]["child"];this.generateContextForWidgets(childWidgetsMap)}}};this.generateWidgetContext=function(widgetId,widgetConfig){var primaryKeyValueMap,operationType,childWidgets;var contextData=this.getContextData();var config=this.getConfig();if(contextData&&contextData instanceof voltmx.model.ModelContext){operationType=contextData.getOperationType(widgetId);primaryKeyValueMap=contextData.getPrimaryKeyValueMap()}if(operationType&&operationType===voltmx.model.constants.OperationType.ADD){return}var widgetContext={};widgetContext["widgetGroupId"]=widgetId;widgetContext["widgets"]=widgetConfig["widgets"];widgetContext["resultProcessor"]=voltmx.model.persistent.WidgetResultProcessor;var widgetNames=Object.keys(widgetContext["widgets"]);if(widgetNames&&widgetNames.length===1&&widgetContext["widgets"][widgetNames[0]].isDataWidget()){widgetContext["resultProcessor"]=voltmx.model.persistent.DataWidgetResultProcessor}widgetContext["serviceName"]=config.getObjectServiceNameOfContainer(widgetId);widgetContext["serviceOptions"]=config.getServiceOptions(widgetId);if(widgetConfig["child"]){childWidgets=Object.keys(widgetConfig["child"])}widgetContext["child"]=childWidgets||[];var entityName,query,queryParams,columns,requestOptions;entityName=widgetConfig["config"].getEntity();query=widgetConfig["config"].getQuery();queryParams=widgetConfig["config"].getQueryParams()||{};columns=widgetConfig["config"].getAdditionalFields();requestOptions=widgetConfig["config"].getRequestOptions();widgetContext["constrained"]=widgetConfig["config"].isConstrained();widgetContext["customVerb"]=widgetConfig["config"].getCustomVerb();if(contextData){var navQuery,navQueryParams,navRequestOptions;navQuery=contextData.getQuery(widgetId);navRequestOptions=contextData.getRequestOptions(widgetId);navQueryParams=contextData.getQueryParams(widgetId);for(var key in navQueryParams){queryParams[key]=navQueryParams[key]}query=navQuery||query;requestOptions=navRequestOptions||requestOptions}widgetContext["entityName"]=entityName;widgetContext["query"]=query;widgetContext["queryParams"]=queryParams;widgetContext["primaryKeyValueMap"]=primaryKeyValueMap;widgetContext["operationType"]=operationType;widgetContext["columns"]=columns;widgetContext["requestOptions"]=requestOptions;this.setWidgetContext(widgetId,widgetContext)};var widgetHierarchyMap=config.getWidgetHierarchyMap();this.generateContextForWidgets(widgetHierarchyMap)}GroupWidgetsContextCommon.prototype.fetchDataForGroupWidget=function(widgetId,successCallback,errorCallback){};GroupWidgetsContextCommon.prototype.updateChildWidgetsFilter=function(widgetContext,resultRow){};GroupWidgetsContextCommon.prototype.getColumnsDef=function(widgetContext){};GroupWidgetsContextCommon.prototype.prepareQueryString=function(queryString,variables){try{if(!queryString){return}for(var param in variables){var paramKey="{"+param+"}";var paramVal=variables[param];var regEx=new RegExp(paramKey,"g");queryString=queryString.replace(regEx,paramVal)}return queryString}catch(err){voltmx.model.log.error("Error preparting query string - "+err.toString());throw voltmx.model.ApplicationContext.getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_PREPARING_QUERY_STRING,voltmx.model.ExceptionCode.MSG_ERROR_PREPARING_QUERY_STRING,err)}};return GroupWidgetsContextCommon}();voltmx.model.persistent.GroupWidgetsContextOffline=function(){function GroupWidgetsContextOffline(configObject,contextDataObj){var config=configObject;var contextData=contextDataObj;var commonGroupWidgetsContext=undefined;var ORMController=undefined;this.getCommonGroupWidgetsContext=function(){if(!commonGroupWidgetsContext){var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();commonGroupWidgetsContext=appFactoryInstance.createGroupWidgetsContextCommon(config,contextData)}return commonGroupWidgetsContext};this.getORMController=function(){if(!ORMController){var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();var INSTANCE=voltmx.model.ApplicationContext;ORMController=appFactoryInstance.createORMControllerObject(INSTANCE,{access:"offline"})}return ORMController};this.getFetchWidgetList=function(){var widgets=[];var widgetsList=this.getCommonGroupWidgetsContext().getWidgetList();var widgetContextMap=this.getCommonGroupWidgetsContext().getWidgetContextMap();for(var indx in widgetsList){if(widgetContextMap[widgetsList[indx]]&&!widgetContextMap[widgetsList[indx]]["constrained"])widgets.push(widgetsList[indx])}return widgets};this.getWidgetContext=function(widget){return this.getCommonGroupWidgetsContext().getWidgetContext(widget)}}GroupWidgetsContextOffline.prototype.fetchDataForGroupWidget=function(widgetId,successCallback,errorCallback){var scopeObj=this;var widgetContext=this.getCommonGroupWidgetsContext().getWidgetContext(widgetId);var fetchContext={};var primaryKeyValueMap=widgetContext["primaryKeyValueMap"];var operationType=widgetContext["operationType"];fetchContext["entityName"]=widgetContext["entityName"];var query=widgetContext["query"];var queryParams=widgetContext["queryParams"];fetchContext["serviceName"]=widgetContext["serviceName"];fetchContext["serviceOptions"]=widgetContext["serviceOptions"];var requestOptions=widgetContext["requestOptions"];fetchContext["requestOptions"]=requestOptions;var ORMController=this.getORMController();var columnsdef=this.getColumnsDef(widgetContext);fetchContext["columnsdef"]=columnsdef;var filter=this.prepareQueryString(query,queryParams);fetchContext["filter"]=filter;if(query&&query.toLowerCase().indexOf("select")>-1){if(filter){ORMController.fetchByNativeQuery(fetchContext,succCallback,errCallback)}}else if(primaryKeyValueMap&&operationType===voltmx.model.constants.OperationType.FILTER_BY_PRIMARY_KEY){fetchContext["primaryKeyValueMap"]=primaryKeyValueMap;ORMController.fetchRecordByPrimaryKey(fetchContext,succCallback,errCallback)}else if(!operationType||operationType===voltmx.model.constants.OperationType.NO_FILTER){ORMController.fetchByColumns(fetchContext,succCallback,errCallback)}else{voltmx.model.log.error("Error in fetching data for group widget, Wrong config");return}function succCallback(response){if(response&&response.length===1){scopeObj.updateChildWidgetsFilter(widgetContext,response[0])}var result={};result[widgetId]=response;successCallback.call(scopeObj,result)}function errCallback(err){errorCallback.call(scopeObj,err)}};GroupWidgetsContextOffline.prototype.updateChildWidgetsFilter=function(widgetContext,resultRow){var entityName=widgetContext["entityName"];var serviceName=widgetContext["serviceName"];var serviceOptions=widgetContext["serviceOptions"];var childGroupWidgets=widgetContext["child"];var ORMController=this.getORMController();for(var indx in childGroupWidgets){var childWidgetContext=this.getWidgetContext(childGroupWidgets[indx]);var childEntityName=childWidgetContext["entityName"];var query=childWidgetContext["query"];var updatedQuery=ORMController.updateChildFilter(entityName,serviceName,serviceOptions,childEntityName,query,resultRow);childWidgetContext["query"]=updatedQuery}};GroupWidgetsContextOffline.prototype.getColumnsDef=function(widgetContext){var columns=widgetContext["columns"]||[];var widgets=widgetContext["widgets"];var fieldName,fieldNameArray,len;var columnsdef={};var tempcolumnsdef,i;var widgetNames=Object.keys(widgets);if(widgetNames&&widgetNames.length===1&&widgets[widgetNames[0]].isDataWidget()){var fields=widgets[widgetNames[0]].getField();for(var field in fields){fieldName=fields[field].getFieldName();for(var indx in fieldName){fieldNameArray=fieldName[indx].split(".");len=fieldNameArray.length;tempcolumnsdef=columnsdef;for(i=0;i<len;i++){if(!tempcolumnsdef.hasOwnProperty(fieldNameArray[i])){tempcolumnsdef[fieldNameArray[i]]={}}tempcolumnsdef=tempcolumnsdef[fieldNameArray[i]]}}}}else{for(var widget in widgets){fieldName=widgets[widget].getField();for(var indx in fieldName){fieldNameArray=fieldName[indx].split(".");len=fieldNameArray.length;tempcolumnsdef=columnsdef;for(i=0;i<len;i++){if(!tempcolumnsdef.hasOwnProperty(fieldNameArray[i])){tempcolumnsdef[fieldNameArray[i]]={}}tempcolumnsdef=tempcolumnsdef[fieldNameArray[i]]}}}}for(var indx in columns){fieldName=columns[indx];fieldNameArray=fieldName.split(".");len=fieldNameArray.length;tempcolumnsdef=columnsdef;for(i=0;i<len;i++){if(!tempcolumnsdef.hasOwnProperty(fieldNameArray[i])){tempcolumnsdef[fieldNameArray[i]]={}}tempcolumnsdef=tempcolumnsdef[fieldNameArray[i]]}}return columnsdef};GroupWidgetsContextOffline.prototype.prepareQueryString=function(queryString,variables){return this.getCommonGroupWidgetsContext().prepareQueryString(queryString,variables)};GroupWidgetsContextOffline.prototype.saveRecord=function(record,sucCallback,errCallback){this.getORMController().saveRecord(record,sucCallback,errCallback)};GroupWidgetsContextOffline.prototype.saveRecords=function(records,sucCallback,errCallback){this.getORMController().saveRecords(records,sucCallback,errCallback)};GroupWidgetsContextOffline.prototype.removeRecord=function(record,sucCallback,errCallback){this.getORMController().removeRecord(record,sucCallback,errCallback)};GroupWidgetsContextOffline.prototype.removeRecords=function(records,sucCallback,errCallback){this.getORMController().removeRecords(records,sucCallback,errCallback)};return GroupWidgetsContextOffline}();voltmx.model.persistent.GroupWidgetsContextOnline=function(){function GroupWidgetsContextOnline(configObject,contextDataObj){var config=configObject;var contextData=contextDataObj;var commonGroupWidgetsContext=undefined;var isCustomVerb=false;this.setCustomVerb=function(flag){isCustomVerb=flag};this.isCustomVerbEnabled=function(){return isCustomVerb};this.getCommonGroupWidgetsContext=function(){if(!commonGroupWidgetsContext){var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();commonGroupWidgetsContext=appFactoryInstance.createGroupWidgetsContextCommon(config,contextData)}return commonGroupWidgetsContext};this.getORMController=function(widget){var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();var INSTANCE=voltmx.model.ApplicationContext;var options={access:"online"};if(this.isGroupExpand(widget))options["expand"]=true;var ORMController=appFactoryInstance.createORMControllerObject(INSTANCE,options);return ORMController};this.getFetchWidgetList=function(){var widgets=[];var scopeObj=this;var widgetHierarchyMap=this.getCommonGroupWidgetsContext().getWidgetHierarchyMap();var widgetContextMap=this.getCommonGroupWidgetsContext().getWidgetContextMap();for(var widgetId in widgetHierarchyMap){if(widgetContextMap[widgetId]&&!widgetContextMap[widgetId]["constrained"]){widgets.push(widgetId);getChildFetchList(widgetId,widgetContextMap,widgets)}}function getChildFetchList(widgetId,widgetContextMap,widgets){if(scopeObj.isGroupExpand(widgetId))return;var childWidgets=widgetContextMap[widgetId]["child"];for(var indx in childWidgets){var childId=childWidgets[indx];if(widgetContextMap[childId]&&!widgetContextMap[childId]["constrained"]){widgets.push(childId);getChildFetchList(childId,widgetContextMap,widgets)}}}return widgets};this.getWidgetContext=function(widget){return this.getCommonGroupWidgetsContext().getWidgetContext(widget)};this.isGroupExpand=function(widget){var widgetContext=this.getWidgetContext(widget);var query=widgetContext&&widgetContext["query"];if(query&&query.indexOf("&$expand=")>-1){return true}return false}}GroupWidgetsContextOnline.prototype.fetchDataForGroupWidget=function(widgetId,successCallback,errorCallback){var scopeObj=this;var widgetContext=this.getCommonGroupWidgetsContext().getWidgetContext(widgetId);var fetchContext={};var primaryKeyValueMap=widgetContext["primaryKeyValueMap"];var operationType=widgetContext["operationType"];fetchContext["entityName"]=widgetContext["entityName"];var query=widgetContext["query"];var queryParams=widgetContext["queryParams"];fetchContext["serviceName"]=widgetContext["serviceName"];fetchContext["serviceOptions"]=widgetContext["serviceOptions"];var requestOptions=widgetContext["requestOptions"];fetchContext["requestOptions"]=requestOptions;var ORMController=this.getORMController(widgetId);var fetchChild=this.isGroupExpand(widgetId);var columnsdef=this.getColumnsDef(widgetContext,{},fetchChild);fetchContext["columnsdef"]=columnsdef;var filter=this.prepareQueryString(query,queryParams);fetchContext["filter"]=filter;if(this.isCustomVerbEnabled()&&widgetContext["customVerb"])fetchContext["customVerb"]=widgetContext["customVerb"];if(query&&query.toLowerCase().indexOf("select")>-1){if(filter){ORMController.fetchByNativeQuery(fetchContext,succCallback,errCallback)}}else if(primaryKeyValueMap&&operationType===voltmx.model.constants.OperationType.FILTER_BY_PRIMARY_KEY){fetchContext["primaryKeyValueMap"]=primaryKeyValueMap;ORMController.fetchRecordByPrimaryKey(fetchContext,succCallback,errCallback)}else if(!operationType||operationType===voltmx.model.constants.OperationType.NO_FILTER){ORMController.fetchByColumns(fetchContext,succCallback,errCallback)}else{voltmx.model.log.error("Error in fetching data for group widget, Wrong config");return}function succCallback(response){var result={};result["_raw_response_"]={};result["_raw_response_"][widgetId]=response;if(response&&response["records"])result[widgetId]=JSON.parse(JSON.stringify(response["records"]));if(scopeObj.isCustomVerbEnabled()&&widgetContext["customVerb"])successCallback.call(scopeObj,result);else{scopeObj.updateChildResponse(widgetContext,result[widgetId],result);successCallback.call(scopeObj,result)}}function errCallback(err){errorCallback.call(scopeObj,err)}};GroupWidgetsContextOnline.prototype.updateChildResponse=function(widgetContext,response,result){if(response&&response.length===1){response=response[0]}else{return}var entityName=widgetContext["entityName"];var serviceName=widgetContext["serviceName"];var serviceOptions=widgetContext["serviceOptions"];var childGroupWidgets=widgetContext["child"];var ORMController=this.getORMController();for(var indx in childGroupWidgets){var childId=childGroupWidgets[indx];var childWidgetContext=this.getWidgetContext(childId);var childEntityName=childWidgetContext["entityName"];var query=childWidgetContext["query"];var updatedQuery=ORMController.updateChildFilter(entityName,serviceName,serviceOptions,childEntityName,query,response);childWidgetContext["query"]=updatedQuery;if(response[childEntityName]){result[childId]=JSON.parse(JSON.stringify(response[childEntityName]));this.updateChildResponse(childWidgetContext,response[childEntityName],result)}}};GroupWidgetsContextOnline.prototype.getColumnsDef=function(widgetContext,columnsdef,fetchChild){var columns=widgetContext["columns"]||[];var widgets=widgetContext["widgets"];var fieldName,fieldNameArray,len;var tempcolumnsdef,i;var widgetNames=Object.keys(widgets);if(widgetNames&&widgetNames.length===1&&widgets[widgetNames[0]].isDataWidget()){var fields=widgets[widgetNames[0]].getField();for(var field in fields){fieldName=fields[field].getFieldName();for(var indx in fieldName){fieldNameArray=fieldName[indx].split(".");len=fieldNameArray.length;tempcolumnsdef=columnsdef;for(i=0;i<len;i++){if(!tempcolumnsdef.hasOwnProperty(fieldNameArray[i])){tempcolumnsdef[fieldNameArray[i]]={}}tempcolumnsdef=tempcolumnsdef[fieldNameArray[i]]}}}}else{for(var widget in widgets){fieldName=widgets[widget].getField();for(var indx in fieldName){fieldNameArray=fieldName[indx].split(".");len=fieldNameArray.length;tempcolumnsdef=columnsdef;for(i=0;i<len;i++){if(!tempcolumnsdef.hasOwnProperty(fieldNameArray[i])){tempcolumnsdef[fieldNameArray[i]]={}}tempcolumnsdef=tempcolumnsdef[fieldNameArray[i]]}}}}for(var indx in columns){fieldName=columns[indx];fieldNameArray=fieldName.split(".");len=fieldNameArray.length;tempcolumnsdef=columnsdef;for(i=0;i<len;i++){if(!tempcolumnsdef.hasOwnProperty(fieldNameArray[i])){tempcolumnsdef[fieldNameArray[i]]={}}tempcolumnsdef=tempcolumnsdef[fieldNameArray[i]]}}if(!fetchChild){return columnsdef}var childWidgets=widgetContext["child"];for(var indx in childWidgets){var childWidgetContext=this.getWidgetContext(childWidgets[indx]);if(!childWidgetContext["constrained"]){var childEntityName=childWidgetContext["entityName"];columnsdef[childEntityName]=columnsdef[childEntityName]||{};columnsdef[childEntityName]=this.getColumnsDef(childWidgetContext,columnsdef[childEntityName],fetchChild)}}return columnsdef};GroupWidgetsContextOnline.prototype.prepareQueryString=function(queryString,variables){return this.getCommonGroupWidgetsContext().prepareQueryString(queryString,variables)};GroupWidgetsContextOnline.prototype.saveRecord=function(record,sucCallback,errCallback){this.getORMController().saveRecord(record,sucCallback,errCallback)};GroupWidgetsContextOnline.prototype.saveRecords=function(records,sucCallback,errCallback){this.getORMController().saveRecords(records,sucCallback,errCallback)};GroupWidgetsContextOnline.prototype.removeRecord=function(record,sucCallback,errCallback){this.getORMController().removeRecord(record,sucCallback,errCallback)};GroupWidgetsContextOnline.prototype.removeRecords=function(records,sucCallback,errCallback){this.getORMController().removeRecords(records,sucCallback,errCallback)};GroupWidgetsContextOnline.prototype.customVerbSave=function(records,success,error){this.getORMController().saveRecords(records,success,error)};return GroupWidgetsContextOnline}();voltmx=voltmx||{};voltmx.model=voltmx.model||{};voltmx.model.AppInitManager=function(){function AppInitManager(){var registry=[];var params=[];this.addRegistry=function(obj){registry.push(obj)};this.addParams=function(parameters){params.push(parameters)};this.getRegistry=function(){return registry};this.getParams=function(){return params}}AppInitManager.prototype.init=function(isOnline){};AppInitManager.prototype.registerService=function(objName,obj){this.addRegistry(obj)};AppInitManager.prototype.executeRegistedServices=function(successcallback,errorcallback){var count=0;errorOccured=false;var registry=this.getRegistry();function serviceExecutionSuccess(response){if(errorOccured)return;count+=1;if(count===registry.length){successcallback()}else{initiateFetch(count)}}function initiateFetch(index){registry[index]["object"].execute(registry[index]["params"],serviceExecutionSuccess,error);function error(err){if(errorOccured)return;errorOccured=true;errorcallback(err)}}initiateFetch(count)};return AppInitManager}();voltmx=voltmx||{};voltmx.model=voltmx.model||{};voltmx.model.ModelController=function(){function ModelController(config,voltmxForm,navObj){var formConfig=new voltmx.model.ConfigClass(config);var ORMController=undefined;var groupWidgetsContext=undefined;var onlineWidgetContext=undefined;var offlineWidgetContext=undefined;var containerRecords={};var formWidgetsData={};var voltmxform=voltmxForm;var naviObj=navObj;var viewModel=new voltmx.model.ViewModel(formConfig,voltmxform);var isCustomVerb=false;this.setCustomVerb=function(flag){isCustomVerb=flag};this.isCustomVerbEnabled=function(){return isCustomVerb};this.isOnline=function(){var configOptions=formConfig.getObjectServiceOptions();if(configOptions&&configOptions.hasOwnProperty("access")&&configOptions.access==="offline"){return false}return true};this.getViewModel=function(){return viewModel};this.getNavigationObj=function(){return naviObj};this.getVoltmxForm=function(){return voltmxform};this.getConfig=function(){return formConfig};this.getContainerRecord=function(prop){return containerRecords[prop]};this.setContainerRecord=function(prop,data){containerRecords[prop]=data};this.getWidgetData=function(prop){return containerRecords[prop]};this.setWidgetData=function(prop,data){containerRecords[prop]=data};this.setFormConfig=function(frmConfig){formConfig=new voltmx.model.ConfigClass(frmConfig);viewModel=new voltmx.model.ViewModel(formConfig,voltmxform)};this.setModelContext=function(navObj){naviObj=navObj
};this.destroy=function(){if(viewModel)viewModel.destroy()};this.getORMController=function(){if(!ORMController){var configOptions=formConfig.getObjectServiceOptions();var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();ORMController=appFactoryInstance.createORMControllerObject(controller.getApplicationContext(),configOptions)}return ORMController};this.setGroupWidgetsContext=function(groupContext){groupWidgetsContext=groupContext};this.getGroupWidgetsContext=function(widgetId){var isOnline=this.isWidgetOnline(widgetId);var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();if(isOnline){return this.getGroupWidgetsContextOnline()}else{return this.getGroupWidgetsContextOffline()}};this.getGroupWidgetsContextOnline=function(){var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();if(!onlineWidgetContext)onlineWidgetContext=appFactoryInstance.createGroupWidgetsContextOnline(this.getConfig(),this.getNavigationObj());return onlineWidgetContext};this.getGroupWidgetsContextOffline=function(){var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();if(!offlineWidgetContext)offlineWidgetContext=appFactoryInstance.createGroupWidgetsContextOffline(this.getConfig(),this.getNavigationObj());return offlineWidgetContext};this.isWidgetOnline=function(widgetId){var configOptions=this.getConfig().getServiceOptions(widgetId);if(configOptions&&configOptions.hasOwnProperty("access")&&configOptions.access==="offline"){return false}return true};this.createGroupWidgetsContext=function(widgetId){var isOnline=this.isWidgetOnline(widgetId);var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();if(isOnline){onlineWidgetContext=appFactoryInstance.createGroupWidgetsContextOnline(this.getConfig(),this.getNavigationObj());return onlineWidgetContext}else{offlineWidgetContext=appFactoryInstance.createGroupWidgetsContextOffline(this.getConfig(),this.getNavigationObj());return offlineWidgetContext}};this.fetchMetadata=function(serviceEntityMap,successCallback,errorCallback){try{var keys=Object.keys(serviceEntityMap);if(keys.length==0){var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();var configObj=this.getConfig();var groupWidgetContext=appFactoryInstance.createGroupWidgetsContextCommon(this.getConfig(),this.getNavigationObj());var widgetList=groupWidgetContext.getWidgetList();var serviceName;var options;for(var indx in widgetList){serviceName=configObj.getObjectServiceNameOfContainer(widgetList[indx]);options=configObj.getServiceOptions(widgetList[indx]);entity=configObj.getWidgetEntity(widgetList[indx])||configObj.getEntity();if(!voltmx.model.ApplicationContext.getMetadataStore().getEntityMetadata(entity,serviceName,options)){serviceEntityMap[serviceName]={};serviceEntityMap[serviceName]["options"]=options;serviceEntityMap[serviceName]["metadataOptions"]={getFromServer:true}}}}keys=Object.keys(serviceEntityMap);if(keys.length==0)successCallback.call(this);else voltmx.model.ApplicationContext.initializeObjectServices(serviceEntityMap,successCallback.bind(this),errorCallback.bind(this))}catch(err){voltmx.model.log.error("Error in fetching metadata for object service : "+serviceName,err);errorCallback(serviceName,err)}};this.getRecordsDataMap=function(isDelete){try{var scopeObj=this;function setDataFromContext(containerName,entityName,recordObject,containerConfig){var contextData=scopeObj.getNavigationObj();if(contextData){var primaryKeyValueMap=contextData.getPrimaryKeyValueMap();for(var key in primaryKeyValueMap){recordObject.set(key,primaryKeyValueMap[key])}var operationType=contextData.getOperationType(containerName);recordObject.setInfo("operation",operationType);var requestOptions=containerConfig&&containerConfig.getRequestOptions();requestOptions=contextData.getRequestOptions(containerName)||requestOptions;recordObject.setInfo("requestOptions",requestOptions);var contextDataDataMap=contextData.getEntityDataMap(entityName);if(contextDataDataMap){for(var column in contextDataDataMap){recordObject.set(column,contextDataDataMap[column])}}}}function setDataFromWidgets(widgets,modelObj,recordObject){var formmodel=scopeObj.getViewModel();for(var widget in widgets){if(widgets[widget].isComputedField()){continue}var fieldValue=formmodel.getWidgetData(widget);if(fieldValue instanceof voltmx.model.Data){fieldValue=fieldValue.getData()}var fieldName=widgets[widget].getField()[0];var fieldNameArray=fieldName.split(".");var aliasName=fieldNameArray[fieldNameArray.length-1];var fieldType=null;if(modelObj.getColumnInfo(aliasName)){fieldType=modelObj.getValueForColumnProperty(aliasName,"type")}if(fieldType==="picklist"){var picklistVals=modelObj.getFieldPickListValues(aliasName);for(var val in picklistVals){if(picklistVals[val].getValue().toString()===fieldValue.toString()){recordObject.set(aliasName,picklistVals[val]);break}}}else{recordObject.set(aliasName,fieldValue)}}}function setDataFromSegment(widget){var segmentData=[];var formmodel=scopeObj.getViewModel();var config=scopeObj.getConfig();var entityName=widget.getWidgetEntity();var serviceName=config.getObjectServiceNameOfContainer(widget.getWidgetId());var options=config.getServiceOptions(widget.getWidgetId());if(widget.isComputedField()){return segmentData}var fieldValue=formmodel.getWidgetData(widget.getWidgetId());if(fieldValue instanceof voltmx.model.Data){fieldValue=fieldValue.getData()}if(fieldValue!==null&&fieldValue!==undefined){for(var indx in fieldValue){var recordObject=new voltmx.model.persistent.Record(entityName);recordObject.setInfo("serviceName",serviceName);recordObject.setInfo("options",options);recordObject.setInfo("operation",voltmx.model.constants.OperationType.ADD);for(var column in fieldValue[indx]){recordObject.set(column,fieldValue[indx][column])}segmentData.push(recordObject)}}return segmentData}function getSegmentRecordsArray(widget){var segmentRecords=[];var widgetId=widget.getWidgetId();var widgetType=widget.getWidgetType();if(widgetType&&widgetType.toLowerCase()==="segment"){var contextData=scopeObj.getNavigationObj();if(contextData){var operation=contextData.getOperationType(widgetId);if(operation&&operation===voltmx.model.constants.OperationType.ADD){var segmentData=setDataFromSegment(widget);segmentRecords=segmentData||[]}}}return segmentRecords}function prepareRecordsDataMap(entityDef){var dataMapDefArray=[];for(var containerName in entityDef){var customVerb=entityDef[containerName]["config"]&&entityDef[containerName]["config"].getCustomVerb();if(scopeObj.isCustomVerbEnabled()){if(!customVerb)continue}else{if(customVerb)continue}var widgets=entityDef[containerName]["widgets"];if(!widgets||widgets.length==0){continue}var entityName=entityDef[containerName]["entityName"];var configObj=scopeObj.getConfig();var widgetNames=Object.keys(widgets);if(widgetNames&&widgetNames.length===1&&widgets[widgetNames[0]].isDataWidget()){if(!isDelete){var segmentRecords=getSegmentRecordsArray(widgets[widgetNames[0]])||[];dataMapDefArray=dataMapDefArray.concat(segmentRecords)}continue}var recordObject=new voltmx.model.persistent.Record(entityName);recordObject.setInfo("serviceName",configObj.getObjectServiceNameOfContainer(containerName));recordObject.setInfo("options",configObj.getServiceOptions(containerName));if(customVerb)recordObject.setInfo("customVerb",customVerb);var modelObj=voltmx.model.ApplicationContext.getModel(entityName,configObj.getObjectServiceNameOfContainer(containerName),configObj.getServiceOptions(containerName));setDataFromContext(containerName,entityName,recordObject,entityDef[containerName]["config"]);setDataFromWidgets(widgets,modelObj,recordObject);var childDataMapDef=prepareRecordsDataMap(entityDef[containerName]["child"]);for(var indx in childDataMapDef){var child=childDataMapDef[indx].getInfo("entity");var childarray;if(recordObject.hasOwnProperty(child)){childarray=recordObject.get(child);childarray.push(childDataMapDef[indx]);recordObject.set(child,childarray)}else{childarray=[];childarray.push(childDataMapDef[indx]);recordObject.set(child,childarray)}}dataMapDefArray.push(recordObject)}return dataMapDefArray}var config=this.getConfig();var formEntityDefinition=config.getWidgetHierarchyMap();var recordsDataMap=prepareRecordsDataMap(formEntityDefinition);voltmx.model.log.info("Prepared recordsDataMap is : ",recordsDataMap);return recordsDataMap}catch(error){voltmx.model.log.error("Error in prepare entity data map : ",error)}}}ModelController.prototype.fetchData=function(successCallback,errorCallback){var appFactoryInstance;try{appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();if(typeof successCallback!=="function"||typeof errorCallback!=="function")throw appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_CALLBACK_NOT_A_FUNCTION,voltmx.model.ExceptionCode.MSG_ERROR_CALLBACK_NOT_A_FUNCTION);this.fetchMetadata({},metadataSuccCallback.bind(this),metadataErrCallback.bind(this));var scope=this;function metadataSuccCallback(){fetchDataInternal.call(this,successCallback,errorCallback)}function metadataErrCallback(serviceName,err){voltmx.model.log.error("Error in fetching metadata for object service : "+serviceName);var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();var exception=appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_FETCH_IN_BASE_CONTROLLER_EXTENSION,voltmx.model.ExceptionCode.MSG_ERROR_FETCH_IN_BASE_CONTROLLER_EXTENSION,err);errorCallback(exception)}}catch(err){var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();var exception=appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_FETCH_IN_BASE_CONTROLLER_EXTENSION,voltmx.model.ExceptionCode.MSG_ERROR_FETCH_IN_BASE_CONTROLLER_EXTENSION,err);errorCallback(exception)}function fetchDataInternal(successCallback,errorCallback){var scopeObj=this;var groupContext=this.createGroupWidgetsContext();var groupWidgets=groupContext.getFetchWidgetList()||[];var indx=0;var responseDataMap={};fetchDataForWidgetGroup();function fetchDataForWidgetGroup(){if(indx>=groupWidgets.length){successCallback.call(scopeObj,responseDataMap);return}if(scopeObj.isWidgetOnline(groupWidgets[indx]))scopeObj.getGroupWidgetsContextOnline().fetchDataForGroupWidget(groupWidgets[indx],sucCallback,errCallback);else scopeObj.getGroupWidgetsContextOffline().fetchDataForGroupWidget(groupWidgets[indx],sucCallback,errCallback);function sucCallback(response){for(var widgetId in response){if(widgetId==="_raw_response_"){var rawResponse=response[widgetId];responseDataMap["_raw_response_"]=responseDataMap["_raw_response_"]||{};for(var widget in rawResponse){responseDataMap["_raw_response_"][widget]=rawResponse[widget]}}else{responseDataMap[widgetId]=response[widgetId];scopeObj.setContainerRecord(widgetId,response[widgetId])}}indx++;fetchDataForWidgetGroup()}function errCallback(error){voltmx.model.log.error("Error in perform fetch data for widget : "+groupWidgets[indx],error);errorCallback(error)}}}};ModelController.prototype.processData=function(data){if(data instanceof Array){var groupContext=this.createGroupWidgetsContext();var groupWidgets=groupContext.getFetchWidgetList()||[];var result={};if(groupWidgets.length===1){var groupWidgetId=groupWidgets[0];result[groupWidgetId]=data;data=result}}for(var widgetGroupId in data){var widgetContext=this.getGroupWidgetsContext().getWidgetContext(widgetGroupId);if(widgetContext&&widgetContext["resultProcessor"]){var widgetResultProcessor=widgetContext["resultProcessor"];data[widgetGroupId]=widgetResultProcessor.process(data[widgetGroupId],widgetContext)}else voltmx.model.log.error("Error in process data : ResultProcessor undefined")}return data};ModelController.prototype.bindData=function(data){try{var scopeObj=this;for(var widgetGroupId in data){var widgetContext=this.getGroupWidgetsContext().getWidgetContext(widgetGroupId);var widgetData=data[widgetGroupId];if(widgetData&&widgetContext&&widgetContext["widgets"]){var widgets=Object.keys(widgetContext["widgets"]);for(var indx in widgets){this.getViewModel().setWidgetData(widgets[indx],widgetData[widgets[indx]]);scopeObj.setWidgetData(widgets[indx],widgetData[widgets[indx]])}}}}catch(err){var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();var exception=appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_BIND_IN_BASE_CONTROLLER_EXTENSION,voltmx.model.ExceptionCode.MSG_ERROR_BIND_IN_BASE_CONTROLLER_EXTENSION,err);throw exception}};ModelController.prototype.saveData=function(successCallback,errorCallback){var appFactoryInstance;try{appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();if(typeof successCallback!=="function"||typeof errorCallback!=="function")throw appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_CALLBACK_NOT_A_FUNCTION,voltmx.model.ExceptionCode.MSG_ERROR_CALLBACK_NOT_A_FUNCTION);this.fetchMetadata({},metadataSuccCallback.bind(this),metadataErrCallback.bind(this));var scope=this;function metadataSuccCallback(){saveDataInternal.call(this,successCallback,errorCallback)}function metadataErrCallback(objServiceName,err){voltmx.model.log.error("Error in fetching metadata for object service : "+objServiceName);var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();var exception=appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_SAVE_IN_BASE_CONTROLLER_EXTENSION,voltmx.model.ExceptionCode.MSG_ERROR_SAVE_IN_BASE_CONTROLLER_EXTENSION,err);errorCallback(exception)}}catch(error){voltmx.model.log.error("Error in save data : ",error);var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();var exception=appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_SAVE_IN_BASE_CONTROLLER_EXTENSION,voltmx.model.ExceptionCode.MSG_ERROR_SAVE_IN_BASE_CONTROLLER_EXTENSION,error);errorCallback(exception)}function saveDataInternal(successCallback,errorCallback){var scopeObj=this;var recordsDataMap=scopeObj.getRecordsDataMap();var dataMaplen=recordsDataMap.length;if(dataMaplen>=1){scopeObj.saveRecords(recordsDataMap,sucCallback,errCallback)}else{return}function sucCallback(response){successCallback.call(scopeObj,response)}function errCallback(err){errorCallback.call(scopeObj,err)}}};ModelController.prototype.deleteData=function(successCallback,errorCallback){var appFactoryInstance;try{appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();if(typeof successCallback!=="function"||typeof errorCallback!=="function")throw appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_CALLBACK_NOT_A_FUNCTION,voltmx.model.ExceptionCode.MSG_ERROR_CALLBACK_NOT_A_FUNCTION);this.fetchMetadata({},metadataSuccCallback.bind(this),metadataErrCallback.bind(this));var scope=this;function metadataSuccCallback(){deleteDataInternal.call(this,successCallback,errorCallback)}function metadataErrCallback(objServiceName,err){voltmx.model.log.error("Error in fetching metadata for object service : "+objServiceName);var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();var exception=appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_DELETE_IN_BASE_CONTROLLER_EXTENSION,voltmx.model.ExceptionCode.MSG_ERROR_DELETE_IN_BASE_CONTROLLER_EXTENSION,err);errorCallback(exception)}}catch(error){voltmx.model.log.error("Error in delete data : ",error);var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();var exception=appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_DELETE_IN_BASE_CONTROLLER_EXTENSION,voltmx.model.ExceptionCode.MSG_ERROR_DELETE_IN_BASE_CONTROLLER_EXTENSION,error);errorCallback(exception)}function deleteDataInternal(successCallback,errorCallback){var scopeObj=this;var recordsDataMap=scopeObj.getRecordsDataMap(true);var dataMaplen=recordsDataMap.length;if(dataMaplen>=1){scopeObj.removeRecords(recordsDataMap,sucCallback,errCallback)}else{return}function sucCallback(response){successCallback.call(scopeObj,response)}function errCallback(err){errorCallback.call(scopeObj,err)}}};ModelController.prototype.saveRecords=function(records,successCallback,errorCallback){var appFactoryInstance;try{appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();if(typeof successCallback!=="function"||typeof errorCallback!=="function")throw appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_CALLBACK_NOT_A_FUNCTION,voltmx.model.ExceptionCode.MSG_ERROR_CALLBACK_NOT_A_FUNCTION);var serviceDataMap={};var serviceName;var options;var entity;for(var indx in records){var record=records[indx];if(!(record instanceof voltmx.model.persistent.Record)){var tempRecord=new voltmx.model.persistent.Record;for(prop in record){tempRecord.setInfo(prop,record[prop])}var fields=record["fields"];for(prop in fields){tempRecord.set(prop,fields[prop])}record=tempRecord;records[indx]=record}serviceName=record.getInfo("serviceName");options=record.getInfo("options");entity=record.getInfo("entity");if(!voltmx.model.ApplicationContext.getMetadataStore().getEntityMetadata(entity,serviceName,options)){serviceDataMap[serviceName]={};serviceDataMap[serviceName]["options"]=options;serviceDataMap[serviceName]["metadataOptions"]={getFromServer:true};serviceDataMap[serviceName]["entities"]=serviceEntityMap[serviceName]["entities"]||{};serviceDataMap[serviceName]["entities"][entity]={}}}this.fetchMetadata(serviceDataMap,metadataSuccCallback.bind(this),metadataErrCallback.bind(this));var scope=this;function metadataSuccCallback(){saveRecordsInternal.call(this,records,successCallback,errorCallback)}function metadataErrCallback(objServiceName,err){voltmx.model.log.error("Error in fetching metadata for object service : "+objServiceName);var exception=appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_SAVE_IN_BASE_CONTROLLER_EXTENSION,voltmx.model.ExceptionCode.MSG_ERROR_SAVE_IN_BASE_CONTROLLER_EXTENSION,err);errorCallback(exception)}}catch(error){voltmx.model.log.error("Error in save records : ",error);var exception=appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_SAVE_IN_BASE_CONTROLLER_EXTENSION,voltmx.model.ExceptionCode.MSG_ERROR_SAVE_IN_BASE_CONTROLLER_EXTENSION,error);errorCallback(exception)}function saveRecordsInternal(records,successCallback,errorCallback){var scopeObj=this;var onlineRecords=[];var offlineRecords=[];for(i in records){if(records[i].getInfo("options")["access"]=="online")onlineRecords.push(records[i]);else offlineRecords.push(records[i])}function onlineSave(){if(onlineRecords.length)scopeObj.getGroupWidgetsContextOnline().saveRecords(onlineRecords,offlineSave,errCallback);else offlineSave()}function offlineSave(response){if(offlineRecords.length)scopeObj.getGroupWidgetsContextOffline().saveRecords(offlineRecords,sucCallback,errCallback);else sucCallback(response)}onlineSave();function sucCallback(response){successCallback.call(scopeObj,response)}function errCallback(err){errorCallback.call(scopeObj,err)}}};ModelController.prototype.removeRecords=function(records,successCallback,errorCallback){var appFactoryInstance;try{appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();if(typeof successCallback!=="function"||typeof errorCallback!=="function")throw appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_CALLBACK_NOT_A_FUNCTION,voltmx.model.ExceptionCode.MSG_ERROR_CALLBACK_NOT_A_FUNCTION);var serviceDataMap={};var serviceName;var options;for(var indx in records){var record=records[indx];if(!(record instanceof voltmx.model.persistent.Record)){var tempRecord=new voltmx.model.persistent.Record;for(prop in record){tempRecord.setInfo(prop,record[prop])}var fields=record["fields"];for(prop in fields){tempRecord.set(prop,fields[prop])}record=tempRecord;records[indx]=record}serviceName=record.getInfo("serviceName");options=record.getInfo("options");entity=record.getInfo("entity");if(!voltmx.model.ApplicationContext.getMetadataStore().getEntityMetadata(entity,serviceName,options)){serviceDataMap[serviceName]={};serviceDataMap[serviceName]["options"]=options;serviceDataMap[serviceName]["metadataOptions"]={getFromServer:true};serviceDataMap[serviceName]["entities"]=serviceEntityMap[serviceName]["entities"]||{};serviceDataMap[serviceName]["entities"][entity]={}}}this.fetchMetadata(serviceDataMap,metadataSuccCallback.bind(this),metadataErrCallback.bind(this));var scope=this;function metadataSuccCallback(){removeRecordsInternal.call(this,records,successCallback,errorCallback)}function metadataErrCallback(objServiceName,err){voltmx.model.log.error("Error in fetching metadata for object service : "+objServiceName);var exception=appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_DELETE_IN_BASE_CONTROLLER_EXTENSION,voltmx.model.ExceptionCode.MSG_ERROR_DELETE_IN_BASE_CONTROLLER_EXTENSION,err);errorCallback(exception)}}catch(error){voltmx.model.log.error("Error in delete records : ",error);var exception=appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_DELETE_IN_BASE_CONTROLLER_EXTENSION,voltmx.model.ExceptionCode.MSG_ERROR_DELETE_IN_BASE_CONTROLLER_EXTENSION,error);errorCallback(exception)}function removeRecordsInternal(records,successCallback,errorCallback){var scopeObj=this;var onlineRecords=[];var offlineRecords=[];for(i in records){if(records[i].getInfo("options")["access"]=="online")onlineRecords.push(records[i]);else offlineRecords.push(records[i])}function onlineRemove(){if(onlineRecords.length)scopeObj.getGroupWidgetsContextOnline().removeRecords(onlineRecords,offlineRemove,errCallback);else offlineRemove()}function offlineRemove(response){if(offlineRecords.length)scopeObj.getGroupWidgetsContextOffline().removeRecords(offlineRecords,sucCallback,errCallback);else sucCallback(response)}onlineRemove();function sucCallback(response){successCallback.call(scopeObj,response)}function errCallback(err){errorCallback.call(scopeObj,err)}}};ModelController.prototype.generateRecords=function(isDelete,successCallback,errorCallback){var appFactoryInstance;try{appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();if(typeof successCallback!=="function"||typeof errorCallback!=="function")throw appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_CALLBACK_NOT_A_FUNCTION,voltmx.model.ExceptionCode.MSG_ERROR_CALLBACK_NOT_A_FUNCTION);this.fetchMetadata({},metadataSuccCallback.bind(this),metadataErrCallback.bind(this));var scope=this;function metadataSuccCallback(){generateRecordsInternal.call(this,isDelete)}function metadataErrCallback(objServiceName,err){voltmx.model.log.error("Error in fetching metadata for object service : "+objServiceName);var exception=appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_GENERATE_RECORDS_IN_BASE_CONTROLLER_EXTENSION,voltmx.model.ExceptionCode.MSG_ERROR_GENERATE_RECORDS_IN_BASE_CONTROLLER_EXTENSION,error);errorCallback(exception)}}catch(error){voltmx.model.log.error("Error in generating records : ",error);var exception=appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_GENERATE_RECORDS_IN_BASE_CONTROLLER_EXTENSION,voltmx.model.ExceptionCode.MSG_ERROR_GENERATE_RECORDS_IN_BASE_CONTROLLER_EXTENSION,error);errorCallback(exception)}function generateRecordsInternal(isDelete){var scopeObj=this;var records=scopeObj.getRecordsDataMap(isDelete);successCallback(records)}};ModelController.prototype.invokeCustomVerb=function(readDataFromForm,successCallback,errorCallback){var appFactoryInstance;try{appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();if(typeof successCallback!=="function"||typeof errorCallback!=="function")throw appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_CALLBACK_NOT_A_FUNCTION,voltmx.model.ExceptionCode.MSG_ERROR_CALLBACK_NOT_A_FUNCTION);this.fetchMetadata({},metadataSuccCallback.bind(this),metadataErrCallback.bind(this));var scope=this;function metadataSuccCallback(){invokeCustomVerbInternal.call(this,successCallback,errorCallback)}function metadataErrCallback(objServiceName,err){voltmx.model.log.error("Error in fetching metadata for object service : "+objServiceName);var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();var exception=appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_CUSTOMVERB,voltmx.model.ExceptionCode.MSG_ERROR_CUSTOMVERB,err);errorCallback(exception)}}catch(err){var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();var exception=appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_CUSTOMVERB,voltmx.model.ExceptionCode.MSG_ERROR_CUSTOMVERB,err);errorCallback(exception)}function invokeCustomVerbInternal(successCallback,errorCallback){this.setCustomVerb(true);var scopeObj=this;var groupWidgetsContext=appFactoryInstance.createGroupWidgetsContextOnline(this.getConfig(),this.getNavigationObj());groupWidgetsContext.setCustomVerb(true);if(readDataFromForm){var recordsDataMap=this.getRecordsDataMap();var dataMaplen=recordsDataMap.length;if(dataMaplen>=1){groupWidgetsContext.customVerbSave(recordsDataMap,sucCallback,errCallback)}else{successCallback.call(scopeObj,{})}function sucCallback(response){successCallback.call(scopeObj,response)}function errCallback(err){errorCallback.call(scopeObj,err)}}else{var groupWidgets=groupWidgetsContext.getFetchWidgetList()||[];var indx=0;var responseDataMap={};fetchDataForWidgetGroup();function fetchDataForWidgetGroup(){if(indx>=groupWidgets.length){successCallback.call(scopeObj,responseDataMap);return}groupWidgetsContext.fetchDataForGroupWidget(groupWidgets[indx],sucCallback,errCallback);function sucCallback(response){for(var widgetId in response){if(widgetId==="_raw_response_"){var rawResponse=response[widgetId];responseDataMap["_raw_response_"]=responseDataMap["_raw_response_"]||{};for(var widget in rawResponse){responseDataMap["_raw_response_"][widget]=rawResponse[widget]}}else{responseDataMap[widgetId]=response[widgetId];scopeObj.setContainerRecord(widgetId,response[widgetId])}}indx++;fetchDataForWidgetGroup()}function errCallback(error){voltmx.model.log.error("Error in invokeCustomVerb for widget : "+groupWidgets[indx],error);errorCallback(error)}}}}};return ModelController}();voltmx=voltmx||{};voltmx.model=voltmx.model||{};voltmx.model.persistent=voltmx.model.persistent||{};voltmx.model.persistent.ORMControllerMFAPP=function(){function ORMControllerMFAPP(applicationContext,configOptions){var ormcontroller;var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();var appContext=applicationContext;if(configOptions&&configOptions.hasOwnProperty("access")&&configOptions.access==="offline"){ormcontroller=appFactoryInstance.createORMControllerSQLObject(applicationContext)}else if(configOptions&&configOptions.hasOwnProperty("expand")&&configOptions.expand===true){ormcontroller=appFactoryInstance.createORMControllerOdataExpandObject(applicationContext)}else{ormcontroller=appFactoryInstance.createORMControllerOdataObject(applicationContext)}this.getORMController=function(){return ormcontroller};this.getApplicationContext=function(){return appContext}}ORMControllerMFAPP.prototype.fetchRecordByPrimaryKey=function(fetchContext,onSuccess,onError){this.getORMController().fetchRecordByPrimaryKey(fetchContext,onSuccess,onError)};ORMControllerMFAPP.prototype.fetchByNativeQuery=function(fetchContext,onSuccess,onError){this.getORMController().fetchByNativeQuery(fetchContext,onSuccess,onError)};ORMControllerMFAPP.prototype.fetchByColumns=function(fetchContext,onSuccess,onError){this.getORMController().fetchByColumns(fetchContext,onSuccess,onError)};ORMControllerMFAPP.prototype.updateChildFilter=function(entityName,serviceName,options,childEntityName,query,parentRow){return this.getORMController().updateChildFilter(entityName,serviceName,options,childEntityName,query,parentRow)};ORMControllerMFAPP.prototype.saveChildRecords=function(childRecordsList,record,response,childSuccess,childError){this.getORMController().saveChildRecords(childRecordsList,record,response,childSuccess,childError)};ORMControllerMFAPP.prototype.saveRecord=function(record,onSuccess,onError){this.getORMController().saveRecord(record,onSuccess,onError)};ORMControllerMFAPP.prototype.saveRecords=function(records,onSuccess,onError){this.getORMController().saveRecords(records,onSuccess,onError)};ORMControllerMFAPP.prototype.removeChildRecords=function(childRecordsList,childSuccess,childError){this.getORMController().removeChildRecords(childRecordsList,childSuccess,childError)};ORMControllerMFAPP.prototype.removeRecord=function(record,onSuccess,onError){this.getORMController().removeRecord(record,onSuccess,onError)};ORMControllerMFAPP.prototype.removeRecords=function(records,onSuccess,onError){this.getORMController().removeRecords(records,onSuccess,onError)};return ORMControllerMFAPP}();voltmx.model.persistent.ORMControllerMFAPPSuper=function(){function ORMControllerMFAPPSuper(applicationContext){var appContext=applicationContext;this.getApplicationContext=function(){return appContext};this.getRecordsListNModel=function(entityName,record,serviceName,options){var entityCtrlr=this.getApplicationContext().getModel(entityName,serviceName,options);var childRecordsList=[];var recordColumns={};for(var column in record){if(typeof record[column]!=="function"&&record[column]!==null){if(entityCtrlr.getColumnInfo(column)){if(entityCtrlr.getValueForColumnProperty(column,"type")==="picklist"){recordColumns[column]=record[column].getValue()}else{recordColumns[column]=record[column]}}else if(this.getChildRelationship(entityName,column,serviceName,options)){var childObj=null;for(var i in record[column]){childObj=childObj||{};childObj["entityName"]=childObj["entityName"]||column;childObj["childRecords"]=childObj["childRecords"]||[];childObj["childRecords"].push(record[column][i])}if(childObj)childRecordsList.push(childObj)}}}var dataObject=new voltmx.sdk.dto.DataObject(entityName);dataObject.setRecord(recordColumns);return{dataObject:dataObject,childRecordsList:childRecordsList}};this.getChildRelationship=function(entityName,childEntityName,serviceName,options){var entityCtrlr=this.getApplicationContext().getModel(entityName,serviceName,options);var relatedEntities=entityCtrlr.getRelatedEntities();return relatedEntities[childEntityName]}}ORMControllerMFAPPSuper.prototype.fetchRecordByPrimaryKey=function(fetchContext,onSuccess,onError){};ORMControllerMFAPPSuper.prototype.fetchByNativeQuery=function(fetchContext,onSuccess,onError){};ORMControllerMFAPPSuper.prototype.fetchByColumns=function(fetchContext,onSuccess,onError){};ORMControllerMFAPPSuper.prototype.updateChildFilter=function(entityName,serviceName,options,childEntityName,query,parentRow){};ORMControllerMFAPPSuper.prototype.saveChildRecords=function(childRecordsList,record,response,childSuccess,childError){var scopeObj=this;var entityName=record.getInfo("entity");var serviceName=record.getInfo("serviceName");var options=record.getInfo("options");var modelObj=this.getApplicationContext().getModel(entityName,serviceName,options);var primaryKeyArray=modelObj.getValueForProperty("primaryKey");if(response){for(var i in primaryKeyArray){if(response[primaryKeyArray[i]])record[primaryKeyArray[i]]=response[primaryKeyArray[i]]}var childRecordsLen=childRecordsList.length;if(childRecordsLen>0){var relationshipData;var childEntityName;var len;for(var index in childRecordsList){childEntityName=childRecordsList[index]["entityName"];relationshipData=this.getChildRelationship(entityName,childEntityName,serviceName,options);var relFields=relationshipData["relationshipFields"];len=childRecordsList[index]["childRecords"].length
;for(var i=0;i<len;i++){for(var j in relFields){var referencingField=relFields[j]["referencingField"];var referencedField=relFields[j]["referencedField"];childRecordsList[index]["childRecords"][i].set(referencedField,record[referencingField])}}}var indx=0;saveChildRecords()}else{childSuccess.call(this,record);return}}else{childSuccess.call(this,record);return}function saveChildRecords(){if(indx>=childRecordsLen){childSuccess.call(scopeObj,record);return}scopeObj.saveRecords(childRecordsList[indx]["childRecords"],saveSuccessCallback,errorCallback)}function saveSuccessCallback(response){indx++;saveChildRecords()}function errorCallback(error){childError.call(scopeObj,error);return}};ORMControllerMFAPPSuper.prototype.saveRecord=function(record,onSuccess,onError){try{var scopeObj=this;if(record.getInfo("remove")){scopeObj.removeRecord(record,onSuccess,onError);return}var entityName=record.getInfo("entity");var serviceName=record.getInfo("serviceName");var options=record.getInfo("options");var customVerb=record.getInfo("customVerb");var modelObj=this.getApplicationContext().getModel(entityName,serviceName,options);var primaryKeyArr=modelObj.getValueForProperty("primaryKey");var recordsListAndModelObj=this.getRecordsListNModel(entityName,record,serviceName,options);var childRecordsList=recordsListAndModelObj.childRecordsList;var dataObject=recordsListAndModelObj.dataObject;function primaryValuesExist(record,primaryKeyArr){var result=true;for(var index in primaryKeyArr){if(!record.hasOwnProperty(primaryKeyArr[index])){result=false}}return result}var operation=record.getInfo("operation");var requestOptions=record.getInfo("requestOptions");if(!requestOptions){requestOptions={}}requestOptions["dataObject"]=dataObject;if(customVerb){modelObj.customVerb(customVerb,requestOptions,success,error)}else if(operation&&operation===voltmx.model.constants.OperationType.ADD){modelObj.create(requestOptions,success,error)}else if(primaryValuesExist(record,primaryKeyArr)){modelObj.update(requestOptions,success,error)}else{modelObj.create(requestOptions,success,error)}function success(response){scopeObj.saveChildRecords(childRecordsList,record,response,childSuccess,childError);function childSuccess(record){onSuccess.call(scopeObj,record);return}function childError(err){onError.call(scopeObj,err);return}}function error(response){onError.call(scopeObj,response)}}catch(e){var err=this.getApplicationContext().getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_ORM_CONTROLLER_SAVE_RECORD,voltmx.model.ExceptionCode.MSG_ERROR_ORM_CONTROLLER_SAVE_RECORD,e);onError(err)}};ORMControllerMFAPPSuper.prototype.saveRecords=function(records,onSuccess,onError){try{var scopeObj=this;var indx=0;scopeObj.saveRecord(records[indx],successCallback,errorCallback);function successCallback(response){indx++;if(indx>=records.length){onSuccess.call(scopeObj,response);return}scopeObj.saveRecord(records[indx],successCallback,errorCallback)}function errorCallback(error){onError.call(scopeObj,error)}}catch(e){var err=this.getApplicationContext().getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_ORM_CONTROLLER_SAVE_RECORDS,voltmx.model.ExceptionCode.MSG_ERROR_ORM_CONTROLLER_SAVE_RECORDS,e);onError(err)}};ORMControllerMFAPPSuper.prototype.removeChildRecords=function(childRecordsList,childSuccess,childError){var scopeObj=this;var childRecordsLen=childRecordsList.length;var indx=0;removeChildRecords();function removeChildRecords(){if(indx>=childRecordsLen){childSuccess.call(scopeObj);return}scopeObj.removeRecords(childRecordsList[indx]["childRecords"],removeSuccessCallback,errorCallback)}function removeSuccessCallback(response){indx++;removeChildRecords()}function errorCallback(error){childError.call(scopeObj,error);return}};ORMControllerMFAPPSuper.prototype.removeRecord=function(record,onSuccess,onError){try{var scopeObj=this;var entityName=record.getInfo("entity");var serviceName=record.getInfo("serviceName");var options=record.getInfo("options");var modelObj=this.getApplicationContext().getModel(entityName,serviceName,options);var recordsListAndModelObj=this.getRecordsListNModel(entityName,record,serviceName,options);var childRecordsList=recordsListAndModelObj.childRecordsList;scopeObj.removeChildRecords(childRecordsList,success,onError);function success(){var primaryKeyArray=modelObj.getValueForProperty("primaryKey");var primaryKeyValueMap={};for(var i in primaryKeyArray){primaryKeyValueMap[primaryKeyArray[i]]=record[primaryKeyArray[i]]}var dataObject=new voltmx.sdk.dto.DataObject(entityName);dataObject.setRecord(primaryKeyValueMap);var requestOptions=record.getInfo("requestOptions");if(!requestOptions){requestOptions={}}requestOptions["dataObject"]=dataObject;modelObj.remove(requestOptions,succCallback,errCallback);function succCallback(response){onSuccess.call(scopeObj,response)}function errCallback(error){onError.call(scopeObj,error)}}}catch(e){var err=this.getApplicationContext().getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_ORM_CONTROLLER_REMOVE_RECORD,voltmx.model.ExceptionCode.MSG_ERROR_ORM_CONTROLLER_REMOVE_RECORD,e);onError(err)}};ORMControllerMFAPPSuper.prototype.removeRecords=function(records,onSuccess,onError){try{var scopeObj=this;var indx=0;scopeObj.removeRecord(records[indx],successCallback,errorCallback);function successCallback(response){indx++;if(indx>=records.length){onSuccess.call(scopeObj,response);return}scopeObj.removeRecord(records[indx],successCallback,errorCallback)}function errorCallback(error){onError.call(scopeObj,error)}}catch(e){var err=this.getApplicationContext().getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_ORM_CONTROLLER_REMOVE_RECORDS,voltmx.model.ExceptionCode.MSG_ERROR_ORM_CONTROLLER_REMOVE_RECORDS,e);onError(err)}};return ORMControllerMFAPPSuper}();voltmx.model.persistent.ORMControllerMFAPPOData=function(){var appContext;function ORMControllerMFAPPOData(applicationContext){voltmx.model.persistent.ORMControllerMFAPPSuper.call(this,applicationContext);appContext=applicationContext;this.getApplicationContext=function(){return appContext};this.getModel=function(entityName,serviceName,options){return this.getApplicationContext().getModel(entityName,serviceName,options)}}inheritsFrom(ORMControllerMFAPPOData,voltmx.model.persistent.ORMControllerMFAPPSuper);ORMControllerMFAPPOData.prototype.fetchRecordByPrimaryKey=function(fetchContext,onSuccess,onError){try{var scopeObj=this;var entityName=fetchContext["entityName"];var primaryFieldValueMap=fetchContext["primaryKeyValueMap"];var primaryKeyValuesArr=Object.keys(primaryFieldValueMap);if(primaryKeyValuesArr.length>0){var filter="&$filter=";for(var j=1;j<primaryKeyValuesArr.length;j++){filter=filter+primaryKeyValuesArr[j-1]+" eq '"+primaryFieldValueMap[primaryKeyValuesArr[j-1]]+"' and "}filter=filter+primaryKeyValuesArr[j-1]+" eq '"+primaryFieldValueMap[primaryKeyValuesArr[j-1]]+"'";fetchContext["filter"]=filter}this.fetchByColumns(fetchContext,onSuccess,onError)}catch(e){var err=this.getApplicationContext().getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_ORM_CONTROLLER_FETCH_RECORD_PK,voltmx.model.ExceptionCode.MSG_ERROR_ORM_CONTROLLER_FETCH_RECORD_PK,e);onError(err)}};ORMControllerMFAPPOData.prototype.fetchByNativeQuery=function(fetchContext,onSuccess,onError){try{var scopeObj=this;var entityName=fetchContext["entityName"];var serviceName=fetchContext["serviceName"];var serviceOptions=fetchContext["serviceOptions"];var query=fetchContext["filter"];var modelObj=this.getModel(entityName,serviceName,serviceOptions);var customVerb=fetchContext["customVerb"];var requestOptions=fetchContext["requestOptions"];if(!requestOptions){requestOptions={}}var dataObject=new voltmx.sdk.dto.DataObject(entityName);dataObject.setOdataUrl(query);requestOptions["dataObject"]=dataObject;if(customVerb)modelObj.customVerb(customVerb,requestOptions,success,error);else modelObj.fetchResponseWithRecords(requestOptions,success,error);function success(response){onSuccess.call(scopeObj,response)}function error(response){onError.call(scopeObj,response)}}catch(e){var err=this.getApplicationContext().getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_ORM_CONTROLLER_FETCH_RECORDS_BY_NATIVE_QUERY,voltmx.model.ExceptionCode.MSG_ERROR_ORM_CONTROLLER_FETCH_RECORDS_BY_NATIVE_QUERY,e);onError(err)}};ORMControllerMFAPPOData.prototype.fetchByColumns=function(fetchContext,onSuccess,onError){try{var scopeObj=this;var entityName=fetchContext["entityName"];var serviceName=fetchContext["serviceName"];var serviceOptions=fetchContext["serviceOptions"];var columnsdef=fetchContext["columnsdef"];var entityCtrlr=this.getModel(entityName,serviceName,serviceOptions);var queryMap=this.getFetchQueryMap(entityName,columnsdef,serviceName,serviceOptions);this.fetchDataMap(queryMap,fetchContext,success,onError);function success(response){onSuccess.call(scopeObj,response)}}catch(e){var err=this.getApplicationContext().getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_ORM_CONTROLLER_FETCH_RECORDS_BY_COLUMN_DEFINITION,voltmx.model.ExceptionCode.MSG_ERROR_ORM_CONTROLLER_FETCH_RECORDS_BY_COLUMN_DEFINITION,e);onError(err)}};ORMControllerMFAPPOData.prototype.getFetchQueryMap=function(entityName,columnsdef,serviceName,options,parentReference){try{var queryMap={};queryMap.entityName=entityName;queryMap.joins=[];var entityCtrlr=appContext.getModel(entityName,serviceName,options);if(parentReference&&parentReference["relFields"]){queryMap.parentEntity=parentReference["entityName"];queryMap.relFields=parentReference["relFields"]}var columnsMap={};for(var column in columnsdef){if(entityCtrlr.getColumnInfo(column)){columnsMap[column]=true}else{var relatedEntities=entityCtrlr.getRelatedEntities();if(relatedEntities[column]){var relFields=relatedEntities[column]["relationshipFields"];var reference={};reference.entityName=entityName;reference.relFields=relFields;var subQueryMap=this.getFetchQueryMap(column,columnsdef[column],serviceName,options,reference);queryMap.joins.push(subQueryMap)}else{voltmx.model.log.error("error in orm controller prepare query json, reference table name not defined : "+column)}}}if(Object.keys(columnsMap).length>0){var len=queryMap.joins.length;for(var i=0;i<len;i+=1){var relFields=queryMap.joins[i].relFields;for(var idx in relFields){columnsMap[relFields[idx]["referencingField"]]=true}}if(queryMap.relFields){for(var idx in queryMap.relFields){columnsMap[queryMap.relFields[idx]["referencedField"]]=true}}var pkColumns=entityCtrlr.getValueForProperty("primaryKey");for(var idx in pkColumns){columnsMap[pkColumns[idx]]=true}}var columnStr="$select=";for(var column in columnsMap){columnStr+=column+","}if(columnStr[columnStr.length-1]!=="=")columnStr=columnStr.slice(0,columnStr.length-1);queryMap.query=columnStr;return queryMap}catch(e){throw this.getApplicationContext().getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_ORM_CONTROLLER_PREPARE_FETCH_QUERY,voltmx.model.ExceptionCode.MSG_ERROR_ORM_CONTROLLER_PREPARE_FETCH_QUERY,e)}};ORMControllerMFAPPOData.prototype.fetchDataMap=function(queryMap,fetchContext,onSuccess,onError){var scopeObj=this;var resultSet={};var serviceName=fetchContext["serviceName"];var serviceOptions=fetchContext["serviceOptions"];var filter=fetchContext["filter"];var requestOptions=fetchContext["requestOptions"];var customVerb=fetchContext["customVerb"];if(!requestOptions){requestOptions={}}var entityName=queryMap.entityName;var query=queryMap.query;if(filter){query=query+filter}var entityCtrlr=scopeObj.getModel(entityName,serviceName,serviceOptions);var dataObject=new voltmx.sdk.dto.DataObject(entityName);if(query){dataObject.setOdataUrl(query)}requestOptions["dataObject"]=dataObject;if(customVerb)entityCtrlr.customVerb(customVerb,requestOptions,success,error);else entityCtrlr.fetchResponseWithRecords(requestOptions,success,error);function success(response){resultSet[entityName]=response;scopeObj.fetchJoinsDataMap(queryMap.joins,resultSet,fetchContext,joinSuccess,error)}function joinSuccess(response){onSuccess.call(scopeObj,response[entityName]);return}function error(response){onError.call(scopeObj,response)}};ORMControllerMFAPPOData.prototype.fetchJoinsDataMap=function(queryMapList,resultSet,fetchContext,onSuccess,onError){var scopeObj=this;var indx=0;fetchJoinDataMap(indx);function fetchJoinDataMap(indx){if(indx>=queryMapList.length){onSuccess.call(scopeObj,resultSet);return}var queryMap=queryMapList[indx];fetchContext["filter"]=undefined;if(resultSet[queryMap.parentEntity]&&resultSet[queryMap.parentEntity]["records"]&&resultSet[queryMap.parentEntity]["records"].length===1){fetchContext["filter"]=getFilterString(queryMap.relFields,resultSet[queryMap.parentEntity]["records"])}scopeObj.fetchDataMap(queryMap,fetchContext,success,onError);function success(response){joinResultSet(queryMapList[indx],response);fetchJoinDataMap(++indx)}function error(response){onError.call(scopeObj,response)}}function joinResultSet(queryMap,response){response=response["records"];var relFields=queryMap.relFields;var parentEntity=queryMap.parentEntity;var entityName=queryMap.entityName;var modResponse={};for(var i in response){var key="";for(var j in relFields){key=key+response[i][relFields[j]["referencedField"]]+"~"}if(!modResponse[key])modResponse[key]=[];modResponse[key].push(response[i])}if(resultSet[parentEntity]&&resultSet[parentEntity]["records"]){var records=resultSet[parentEntity]["records"];for(var i in records){var key="";for(var j in relFields){key=key+records[i][relFields[j]["referencingField"]]+"~"}records[i][entityName]=modResponse[key]}}}function getFilterString(relFields,parentResult){if(parentResult&&parentResult.length>0){var parentRow=parentResult[0];var filter="&$filter=";for(var j=1;j<relFields.length;j++){filter=filter+relFields[j-1]["referencedField"]+" eq '"+parentRow[relFields[j-1]["referencingField"]]+"' and "}filter=filter+relFields[j-1]["referencedField"]+" eq '"+parentRow[relFields[j-1]["referencingField"]]+"'";return filter}}};ORMControllerMFAPPOData.prototype.updateChildFilter=function(entityName,serviceName,options,childEntityName,query,parentRow){var entityCtrlr=this.getModel(entityName,serviceName,options);var relatedEntities=entityCtrlr.getRelatedEntities();var updatedQuery;if(relatedEntities[childEntityName]){var relFields=relatedEntities[childEntityName]["relationshipFields"];if(!query||query===""){updatedQuery="&$filter="}else if(query.indexOf("&$filter=")===-1){updatedQuery=query+"&$filter="}else{updatedQuery=query+" and "}for(var j=1;j<relFields.length;j++){updatedQuery=updatedQuery+relFields[j-1]["referencedField"]+" eq '"+parentRow[relFields[j-1]["referencingField"]]+"' and "}updatedQuery=updatedQuery+relFields[j-1]["referencedField"]+" eq '"+parentRow[relFields[j-1]["referencingField"]]+"'";return updatedQuery}else{return query}};return ORMControllerMFAPPOData}();voltmx.model.persistent.ORMControllerMFAPPODataExpand=function(){var appContext;function ORMControllerMFAPPODataExpand(applicationContext){voltmx.model.persistent.ORMControllerMFAPPSuper.call(this,applicationContext);appContext=applicationContext;var ORMController=undefined;this.getApplicationContext=function(){return appContext};this.getModel=function(entityName,serviceName,options){return this.getApplicationContext().getModel(entityName,serviceName,options)};this.getORMController=function(){if(!ORMController){var appFactoryInstance=this.getApplicationContext().getFactorySharedInstance();ORMController=appFactoryInstance.createORMControllerOdataObject(this.getApplicationContext())}return ORMController}}inheritsFrom(ORMControllerMFAPPODataExpand,voltmx.model.persistent.ORMControllerMFAPPSuper);ORMControllerMFAPPODataExpand.prototype.fetchRecordByPrimaryKey=function(fetchContext,onSuccess,onError){try{var scopeObj=this;var entityName=fetchContext["entityName"];var primaryFieldValueMap=fetchContext["primaryKeyValueMap"];var primaryKeyValuesArr=Object.keys(primaryFieldValueMap);if(primaryKeyValuesArr.length>0){var filter=fetchContext["filter"];if(!filter)filter="";filter=filter+"&$filter=";for(var j=1;j<primaryKeyValuesArr.length;j++){filter=filter+primaryKeyValuesArr[j-1]+" eq '"+primaryFieldValueMap[primaryKeyValuesArr[j-1]]+"' and "}filter=filter+primaryKeyValuesArr[j-1]+" eq '"+primaryFieldValueMap[primaryKeyValuesArr[j-1]]+"'";fetchContext["filter"]=filter}this.fetchByColumns(fetchContext,onSuccess,onError)}catch(e){var err=this.getApplicationContext().getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_ORM_CONTROLLER_FETCH_RECORD_PK,voltmx.model.ExceptionCode.MSG_ERROR_ORM_CONTROLLER_FETCH_RECORD_PK,e);onError(err)}};ORMControllerMFAPPODataExpand.prototype.fetchByNativeQuery=function(fetchContext,onSuccess,onError){this.getORMController().fetchByNativeQuery(fetchContext,onSuccess,onError)};ORMControllerMFAPPODataExpand.prototype.fetchByColumns=function(fetchContext,onSuccess,onError){try{var scopeObj=this;var entityName=fetchContext["entityName"];var serviceName=fetchContext["serviceName"];var serviceOptions=fetchContext["serviceOptions"];var columnsdef=fetchContext["columnsdef"];var entityCtrlr=this.getModel(entityName,serviceName,serviceOptions);var queryMap=this.getFetchQueryMap(entityName,columnsdef,serviceName,serviceOptions);this.fetchDataMap(queryMap,fetchContext,success,onError);function success(response){onSuccess.call(scopeObj,response)}}catch(e){var err=this.getApplicationContext().getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_ORM_CONTROLLER_FETCH_RECORDS_BY_COLUMN_DEFINITION,voltmx.model.ExceptionCode.MSG_ERROR_ORM_CONTROLLER_FETCH_RECORDS_BY_COLUMN_DEFINITION,e);onError(err)}};ORMControllerMFAPPODataExpand.prototype.getFetchQueryMap=function(entityName,columnsdef,serviceName,options,parentReference){try{var queryMap={};queryMap.entityName=entityName;queryMap.joins=[];queryMap.expand=undefined;var entityCtrlr=appContext.getModel(entityName,serviceName,options);if(parentReference&&parentReference["relFields"]){queryMap.parentEntity=parentReference["entityName"];queryMap.relFields=parentReference["relFields"]}var columnsMap={};for(var column in columnsdef){if(entityCtrlr.getColumnInfo(column)){columnsMap[column]=true}else{var relatedEntities=entityCtrlr.getRelatedEntities();if(relatedEntities[column]){var relFields=relatedEntities[column]["relationshipFields"];var reference={};reference.entityName=entityName;reference.relFields=relFields;var subQueryMap=this.getFetchQueryMap(column,columnsdef[column],serviceName,options,reference);queryMap.joins.push(subQueryMap);if(queryMap.expand)queryMap.expand=queryMap.expand+","+subQueryMap.expand;else queryMap.expand=subQueryMap.expand}else{voltmx.model.log.error("error in orm controller prepare query json, reference table name not defined : "+column)}}}if(Object.keys(columnsMap).length>0){var len=queryMap.joins.length;for(var i=0;i<len;i+=1){var relFields=queryMap.joins[i].relFields;for(var idx in relFields){columnsMap[relFields[idx]["referencingField"]]=true}}queryMap.joins=[];if(queryMap.relFields){for(var idx in queryMap.relFields){columnsMap[queryMap.relFields[idx]["referencedField"]]=true}}var pkColumns=entityCtrlr.getValueForProperty("primaryKey");for(var idx in pkColumns){columnsMap[pkColumns[idx]]=true}}var columnStr="$select=";for(var column in columnsMap){columnStr+=column+","}if(columnStr[columnStr.length-1]!=="=")columnStr=columnStr.slice(0,columnStr.length-1);var expandStr="&$expand=";if(queryMap.expand){expandStr+=queryMap.expand;queryMap.expand=entityName+","+queryMap.expand}else{queryMap.expand=entityName}queryMap.query=columnStr;return queryMap}catch(e){throw this.getApplicationContext().getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_ORM_CONTROLLER_PREPARE_FETCH_QUERY,voltmx.model.ExceptionCode.MSG_ERROR_ORM_CONTROLLER_PREPARE_FETCH_QUERY,e)}};ORMControllerMFAPPODataExpand.prototype.fetchDataMap=function(queryMap,fetchContext,onSuccess,onError){this.getORMController().fetchDataMap(queryMap,fetchContext,onSuccess,onError)};ORMControllerMFAPPODataExpand.prototype.updateChildFilter=function(entityName,serviceName,options,childEntityName,query,parentRow){return this.getORMController().updateChildFilter(entityName,serviceName,options,childEntityName,query,parentRow)};return ORMControllerMFAPPODataExpand}();voltmx.model.persistent.ORMControllerMFAPPSQL=function(){var appContext;function ORMControllerMFAPPSQL(applicationContext){voltmx.model.persistent.ORMControllerMFAPPSuper.call(this,applicationContext);appContext=applicationContext;this.getApplicationContext=function(){return appContext};this.getModel=function(entityName,serviceName,options){return this.getApplicationContext().getModel(entityName,serviceName,options)}}inheritsFrom(ORMControllerMFAPPSQL,voltmx.model.persistent.ORMControllerMFAPPSuper);ORMControllerMFAPPSQL.prototype.fetchRecordByPrimaryKey=function(fetchContext,onSuccess,onError){try{var scopeObj=this;var entityName=fetchContext["entityName"];var primaryFieldValueMap=fetchContext["primaryKeyValueMap"];var primaryKeyValuesArr=Object.keys(primaryFieldValueMap);if(primaryKeyValuesArr.length>0){var filter="where ";for(var j=1;j<primaryKeyValuesArr.length;j++){filter=filter+'"'+entityName+'"."'+primaryKeyValuesArr[j-1]+"\" = '"+primaryFieldValueMap[primaryKeyValuesArr[j-1]]+"' and "}filter=filter+'"'+entityName+'"."'+primaryKeyValuesArr[j-1]+"\" = '"+primaryFieldValueMap[primaryKeyValuesArr[j-1]]+"'";fetchContext["filter"]=filter}this.fetchByColumns(fetchContext,onSuccess,onError)}catch(e){var err=this.getApplicationContext().getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_ORM_CONTROLLER_FETCH_RECORD_PK,voltmx.model.ExceptionCode.MSG_ERROR_ORM_CONTROLLER_FETCH_RECORD_PK,e);onError(err)}};ORMControllerMFAPPSQL.prototype.fetchByNativeQuery=function(fetchContext,onSuccess,onError){try{var scopeObj=this;var entityName=fetchContext["entityName"];var serviceName=fetchContext["serviceName"];var serviceOptions=fetchContext["serviceOptions"];var query=fetchContext["filter"];var modelObj=this.getModel(entityName,serviceName,serviceOptions);modelObj.executeSelectQuery(query,success,error);function success(response){onSuccess.call(scopeObj,response)}function error(response){onError.call(scopeObj,response)}}catch(e){var err=this.getApplicationContext().getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_ORM_CONTROLLER_FETCH_RECORDS_BY_NATIVE_QUERY,voltmx.model.ExceptionCode.MSG_ERROR_ORM_CONTROLLER_FETCH_RECORDS_BY_NATIVE_QUERY,e);onError(err)}};ORMControllerMFAPPSQL.prototype.fetchByColumns=function(fetchContext,onSuccess,onError){try{var scopeObj=this;var entityName=fetchContext["entityName"];var serviceName=fetchContext["serviceName"];var serviceOptions=fetchContext["serviceOptions"];var columnsdef=fetchContext["columnsdef"];var entityCtrlr=this.getModel(entityName,serviceName,serviceOptions);var queryMap=this.getFetchQueryMap(entityName,columnsdef,serviceName,serviceOptions);this.fetchDataMap(queryMap,fetchContext,success,onError);function success(response){onSuccess.call(scopeObj,response)}}catch(e){var err=this.getApplicationContext().getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_ORM_CONTROLLER_FETCH_RECORDS_BY_COLUMN_DEFINITION,voltmx.model.ExceptionCode.MSG_ERROR_ORM_CONTROLLER_FETCH_RECORDS_BY_COLUMN_DEFINITION,e);onError(err)}};ORMControllerMFAPPSQL.prototype.getFetchQueryMap=function(entityName,columnsdef,serviceName,options,parentReference){try{var queryMap={};queryMap.entityName=entityName;queryMap.joins=[];var entityCtrlr=appContext.getModel(entityName,serviceName,options);if(parentReference&&parentReference["relFields"]){queryMap.parentEntity=parentReference["entityName"];queryMap.relFields=parentReference["relFields"]}var columnsMap={};for(var column in columnsdef){if(entityCtrlr.getColumnInfo(column)){columnsMap[column]=true}else{var relatedEntities=entityCtrlr.getRelatedEntities();if(relatedEntities[column]){var relFields=relatedEntities[column]["relationshipFields"];var reference={};reference.entityName=entityName;reference.relFields=relFields;var subQueryMap=this.getFetchQueryMap(column,columnsdef[column],serviceName,options,reference);queryMap.joins.push(subQueryMap)}else{voltmx.model.log.error("error in orm controller prepare query json, reference table name not defined : "+column)}}}if(Object.keys(columnsMap).length>0){var len=queryMap.joins.length;for(var i=0;i<len;i+=1){var relFields=queryMap.joins[i].relFields;for(var idx in relFields){columnsMap[relFields[idx]["referencingField"]]=true}}if(queryMap.relFields){for(var idx in queryMap.relFields){columnsMap[queryMap.relFields[idx]["referencedField"]]=true}}var pkColumns=entityCtrlr.getValueForProperty("primaryKey");for(var idx in pkColumns){columnsMap[pkColumns[idx]]=true}}var columnStr="select ";for(var column in columnsMap){columnStr+='"'+column+'",'}if(columnStr[columnStr.length-1]===",")columnStr=columnStr.slice(0,columnStr.length-1);else columnStr+="*";columnStr+=' from "'+entityName+'"';queryMap.query=columnStr;return queryMap}catch(e){throw this.getApplicationContext().getFactorySharedInstance().createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_ORM_CONTROLLER_PREPARE_FETCH_QUERY,voltmx.model.ExceptionCode.MSG_ERROR_ORM_CONTROLLER_PREPARE_FETCH_QUERY,e)}};ORMControllerMFAPPSQL.prototype.fetchDataMap=function(queryMap,fetchContext,onSuccess,onError){var scopeObj=this;var resultSet={};var serviceName=fetchContext["serviceName"];var serviceOptions=fetchContext["serviceOptions"];var filter=fetchContext["filter"];var entityName=queryMap.entityName;var query=queryMap.query;if(filter){query=query+" "+filter}var entityCtrlr=scopeObj.getModel(entityName,serviceName,serviceOptions);entityCtrlr.executeSelectQuery(query,success,error);function success(response){resultSet[entityName]=response;scopeObj.fetchJoinsDataMap(queryMap.joins,resultSet,fetchContext,joinSuccess,error)}function joinSuccess(response){onSuccess.call(scopeObj,response[entityName]);return}function error(response){onError.call(scopeObj,response)}};ORMControllerMFAPPSQL.prototype.fetchJoinsDataMap=function(queryMapList,resultSet,fetchContext,onSuccess,onError){var scopeObj=this;var indx=0;fetchJoinDataMap(indx);function fetchJoinDataMap(indx){if(indx>=queryMapList.length){onSuccess.call(scopeObj,resultSet);return}var queryMap=queryMapList[indx];fetchContext["filter"]=undefined;if(resultSet[queryMap.parentEntity]&&resultSet[queryMap.parentEntity].length===1){fetchContext["filter"]=getFilterString(queryMap.relFields,resultSet[queryMap.parentEntity])}scopeObj.fetchDataMap(queryMap,fetchContext,success,onError);function success(response){joinResultSet(queryMapList[indx],response);fetchJoinDataMap(++indx)}function error(response){onError.call(scopeObj,response)}}function joinResultSet(queryMap,response){var relFields=queryMap.relFields;var parentEntity=queryMap.parentEntity;var entityName=queryMap.entityName;var modResponse={};for(var i in response){var key="";for(var j in relFields){key=key+response[i][relFields[j]["referencedField"]]+"~"}if(!modResponse[key])modResponse[key]=[];modResponse[key].push(response[i])}if(resultSet[parentEntity]){for(var i in resultSet[parentEntity]){var key="";for(var j in relFields){key=key+resultSet[parentEntity][i][relFields[j]["referencingField"]]+"~"}resultSet[parentEntity][i][entityName]=modResponse[key]}}}function getFilterString(relFields,parentResult){if(parentResult&&parentResult.length>0){var parentRow=parentResult[0];var filter="where ";for(var j=1;j<relFields.length;j++){filter=filter+'"'+relFields[j-1]["referencedField"]+"\" = '"+parentRow[relFields[j-1]["referencingField"]]+"' and "}filter=filter+'"'+relFields[j-1]["referencedField"]+"\" = '"+parentRow[relFields[j-1]["referencingField"]]+"'";return filter}}};ORMControllerMFAPPSQL.prototype.updateChildFilter=function(entityName,serviceName,options,childEntityName,query,parentRow){var entityCtrlr=this.getModel(entityName,serviceName,options);var relatedEntities=entityCtrlr.getRelatedEntities();var updatedQuery;if(relatedEntities[childEntityName]){var relFields=relatedEntities[childEntityName]["relationshipFields"];if(!query||query===""){updatedQuery="where "}else{updatedQuery=query+" and "}for(var j=1;j<relFields.length;j++){updatedQuery=updatedQuery+'"'+relFields[j-1]["referencedField"]+"\" = '"+parentRow[relFields[j-1]["referencingField"]]+"' and "}updatedQuery=updatedQuery+'"'+relFields[j-1]["referencedField"]+"\" = '"+parentRow[relFields[j-1]["referencingField"]]+"'";return updatedQuery}else{return query}};return ORMControllerMFAPPSQL}();var appGlobalObj=this;var resolveFunctionFromString=function(str){var arr=str.split(".");var fn=appGlobalObj||this;for(var i=0,len=arr.length;i<len;i++){fn=fn[arr[i]]}return fn};voltmx.model.persistent.DataWidgetResultProcessor=function(){function DataWidgetResultProcessor(){}DataWidgetResultProcessor.process=function(record,groupWidgetConfig){var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();try{var widgetConfig=groupWidgetConfig["widgets"];var widgets=Object.keys(widgetConfig);var fieldName,fieldNameArray;var formmodel,propData,len,propValue;propValue={};formmodel=[];var fields=widgetConfig[widgets[0]].getField();var rowObj;var aliasName;for(var key in record){rowObj={};if(record[key]["primaryKeyValueMap"]){rowObj["primaryKeyValueMap"]=record[key]["primaryKeyValueMap"]}for(var field in fields){if(fields[field].getFieldtype()&&fields[field].getFieldtype()==="computed"){continue}fieldName=fields[field].getFieldName();aliasName=fields[field].getAliasName();if(!fieldName&&!aliasName){continue}if(!aliasName){aliasName="";for(var indx in fieldName)aliasName=aliasName+"_"+fieldName[indx];aliasName=aliasName.substring(1,aliasName.length)}for(var indx in fieldName){fieldNameArray=fieldName[indx].split(".");len=fieldNameArray.length;propData=record[key];for(var i=1;i<len;i++){propData=propData[fieldNameArray[i-1]];if(propData&&propData[0]){propData=propData[0]}else{propData=null;break}}if(propData)propData=propData[fieldNameArray[i-1]];propValue[fieldName[indx]]=propData}var postProcessor=fields[field].getPostProcessor();if(postProcessor){if(typeof postProcessor=="function")propData=postProcessor(propValue);else{var processor=null;try{processor=resolveFunctionFromString(postProcessor)}catch(e){throw"Invalid postProcessor defined for "+fields[field].getWidgetId()}if(typeof processor=="function")propData=processor(propValue)}}else{if(fieldName.length!=1)voltmx.model.log.error("postProcessor is not Defined for "+fields[field].getWidgetId())}rowObj[aliasName]=propData}formmodel.push(rowObj)}if(groupWidgetConfig["widgetGroupId"]!=="form")var widgetType=widgetConfig[widgets[0]].getWidgetType();if(widgetType&&widgetType.toLowerCase()==="segment"){formmodel=voltmx.model.Util.format.segmentData(formmodel,widgetConfig[widgets[0]])}var formModelObj={};formModelObj[widgets[0]]=appFactoryInstance.createDataObject(formmodel);return formModelObj}catch(e){throw appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_ORM_CONTROLLER_UNMARSHALL_TO_MODEL_OBJECT,voltmx.model.ExceptionCode.MSG_ERROR_ORM_CONTROLLER_UNMARSHALL_TO_MODEL_OBJECT,e)}};return DataWidgetResultProcessor}();voltmx.model.persistent.WidgetResultProcessor=function(){function WidgetResultProcessor(){}WidgetResultProcessor.process=function(record,groupWidgetConfig){var appFactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();try{if(record instanceof Array){record=record[0]}var widgetConfig=groupWidgetConfig["widgets"];var widgets=Object.keys(widgetConfig);var fieldName,fieldNameArray;var formmodel,propData,len,propValue;propValue={};formmodel={};for(var indx in widgets){
if(widgetConfig[widgets[indx]].isConstrained()){continue}fieldName=widgetConfig[widgets[indx]].getField();if(!fieldName){continue}for(var key in fieldName){fieldNameArray=fieldName[key].split(".");len=fieldNameArray.length;propData=record;for(var i=1;i<len;i++){propData=propData[fieldNameArray[i-1]];if(propData&&propData[0]){propData=propData[0]}else{propData=null;break}}if(propData)propData=propData[fieldNameArray[i-1]];propValue[fieldName[key]]=propData}var postProcessor=widgetConfig[widgets[indx]].getPostProcessor();if(postProcessor){if(typeof postProcessor=="function")propData=postProcessor(propValue);else{var processor=null;try{processor=resolveFunctionFromString(postProcessor)}catch(e){throw"Invalid postProcessor defined for "+widgetConfig[widgets[indx]].getWidgetId()}if(typeof processor=="function")propData=processor(propValue)}}else{if(fieldName.length!=1)voltmx.model.log.error("postProcessor is not Defined for "+widgetConfig[widgets[indx]].getWidgetId())}formmodel[widgets[indx]]=appFactoryInstance.createDataObject(propData)}return formmodel}catch(e){throw appFactoryInstance.createExceptionObject(voltmx.model.ExceptionCode.CD_ERROR_ORM_CONTROLLER_UNMARSHALL_TO_MODEL_OBJECT,voltmx.model.ExceptionCode.MSG_ERROR_ORM_CONTROLLER_UNMARSHALL_TO_MODEL_OBJECT,e)}};return WidgetResultProcessor}();voltmx.model.persistent.Record=function(){function Record(entityName){var info={};this.getInfo=function(prop){return info&&info[prop]};this.setInfo=function(prop,infoArg){info=info||{};info[prop]=infoArg};this.setInfo("entity",entityName);this.setInfo("remove",false)}Record.prototype.get=function(prop){return this[prop]};Record.prototype.set=function(prop,value){this[prop]=value};return Record}();voltmx=voltmx||{};voltmx.model=voltmx.model||{};voltmx.model.SyncManagerMF=function(){function SyncManagerMF(){}SyncManagerMF.prototype.init=function(syncOptions,successcallback,errorcallback){var scopeObj=this;var resetConfirmationHandler=undefined;if(syncOptions&&syncOptions["resetConfirmationHandler"])resetConfirmationHandler=syncOptions["resetConfirmationHandler"];this.resetSyncIfNecessary(resetSuccess,resetError,resetConfirmationHandler);function resetSuccess(){var syncCriteria=scopeObj.validateSyncOptions(syncOptions);var syncConfig;if(syncOptions&&syncOptions.hasOwnProperty("syncConfig"))syncConfig=syncOptions["syncConfig"];voltmx.model.log.info("Sync Criteria recieved is "+syncCriteria);if(syncCriteria=="skipEverything"){successcallback();return}scopeObj.saveUserDetails();if(syncCriteria=="startSync"){scopeObj.sync(successcallback,errorcallback,syncConfig)}else if(syncCriteria=="syncData"){scopeObj.sync(successcallback,errorcallback,syncConfig)}else if(syncCriteria=="InitSync"){scopeObj.syncInit(successcallback,errorcallback)}else successcallback()}function resetError(err){voltmx.model.log.error("Error occured while resetting sync");errorcallback(err)}};SyncManagerMF.prototype.sync=function(successcallback,errorCallback,syncConfig){var scopeObj=this;this.syncInit(initSuccess,initError);function initSuccess(){scopeObj.syncData(successcallback,errorCallback,syncConfig)}function initError(){errorCallback()}};SyncManagerMF.prototype.syncInit=function(success,error){var syncObj=voltmx.sdk.getCurrentInstance().getSyncService();syncObj.init(success,error)};SyncManagerMF.prototype.resetSyncIfNecessary=function(success,error,resetConfirmationHandler){var scopeObj=this;var credStore=voltmx.store.getItem(voltmx.model.constants.credStoreName);if(credStore!==null&&credStore!==undefined){var loginDetails=voltmx.model.ApplicationContext.getUserCredentialObj().getData("UserCredentials",true);var authParams=loginDetails["authParams"];var username=authParams["userid"];var storedUsername=credStore[voltmx.model.constants.credStoreUsername];if(storedUsername!==undefined&&voltmx.model.Util.matchIgnoreCase(storedUsername,username)){success()}else{if(typeof resetConfirmationHandler=="function")resetConfirmationHandler(handler);else this.reset(success,error);function handler(doReset){if(doReset==true)scopeObj.reset(success,error);else success()}}}else success()};SyncManagerMF.prototype.reset=function(successcallback,errorCallback){voltmx.model.log.info("Resetting sync");voltmx.sdk.getCurrentInstance().getSyncService().reset(resetSuccess,resetError);function resetSuccess(){voltmx.model.ApplicationContext.dismissLoadingScreen();successcallback()}function resetError(){errorCallback()}};SyncManagerMF.prototype.rollback=function(rollbackSuccess,rollbackError){var syncObj=voltmx.sdk.getCurrentInstance().getSyncService();syncObj.rollbackPendingLocalChanges(rollbackSuccess,rollbackError)};SyncManagerMF.prototype.syncData=function(successcallback,errorCallback,syncConfig){voltmx.model.log.info("Syncing Data");var scopeObj=this;scopeObj.startSyncForScope(successcallback,errorCallback,false,syncConfig)};SyncManagerMF.prototype.startSyncForScope=function(syncscopeSuccesscallback,syncscopeErrorcallback,isMetadata,config){if(!config||typeof config!=="object")config={};else config=voltmx.model.Util.cloneObject(config);if(!config.hasOwnProperty("onsyncstart"))config.onsyncstart=voltmx.model.onsyncstartCallback;if(!config.hasOwnProperty("onscopestart"))config.onscopestart=voltmx.model.onscopestartCallback;if(!config.hasOwnProperty("onscopesuccess"))config.onscopesuccess=voltmx.model.onscopesuccessCallback;if(!config.hasOwnProperty("onbatchstored"))config.onbatchstored=voltmx.model.onbatchstoredCallback;if(!config.hasOwnProperty("onbatchprocessingsuccess"))config.onbatchprocessingsuccess=voltmx.model.onbatchprocessingsuccessCallback;config.onsyncsuccess=syncSuccess;config.onsyncerror=syncError;var syncObj=voltmx.sdk.getCurrentInstance().getSyncService();syncObj.startSession(config);function syncSuccess(){voltmx.model.onsyncsuccessCallback();syncscopeSuccesscallback()}function syncError(err){voltmx.model.onsyncerrorCallback(err);syncscopeErrorcallback(err)}};SyncManagerMF.prototype.validateSyncOptions=function(syncOptions){if(voltmx.model.ApplicationContext.isAppSyncEnabled()===false)return"skipEverything";if(syncOptions){var syncData=syncOptions["syncData"];if(syncData===false){if(this.validateWithStoredCredentials()==true)return"InitSync";else return"skipEverything"}else if(syncData===true){return"syncData"}else{return"startSync"}}else{return"startSync"}};SyncManagerMF.prototype.saveUserDetails=function(){voltmx.model.ApplicationContext.getFactorySharedInstance().getAuthManager().saveUserDetails()};SyncManagerMF.prototype.manualSync=function(syncOptions,success,error){try{var loginDetails=voltmx.model.ApplicationContext.getUserCredentialObj().getData("UserCredentials",true);var authParams=loginDetails["authParams"];var options=loginDetails["options"];var identityServiceName=loginDetails["identityServiceName"];var authConfig={authParams:authParams,options:options,identityServiceName:identityServiceName,showLoadingscreen:true};var syncParams={syncOptions:syncOptions};var appfactoryInstance=voltmx.model.ApplicationContext.getFactorySharedInstance();var initManager=appfactoryInstance.createAppInitManagerObject();initManager.registerService("AuthenticationServiceManager",{object:appfactoryInstance.createAuthenticationManager(),params:authConfig});initManager.registerService("SyncManager",{object:appfactoryInstance.createSyncManagerObject(),params:syncParams});initManager.registerService("MetadataServiceManager",{object:appfactoryInstance.createMetadataServiceManagerObject(),params:{options:options}});initManager.executeRegistedServices(success,error)}catch(err){voltmx.model.log.error("Error while doing manual sync");error(err)}};SyncManagerMF.prototype.execute=function(params,success,error){var syncOptions=params["syncOptions"];this.init(syncOptions,success,error)};SyncManagerMF.prototype.validateWithStoredCredentials=function(){var loginDetails=voltmx.model.ApplicationContext.getUserCredentialObj().getData("UserCredentials",true);return!voltmx.model.ApplicationContext.isAppsFirstLogin(loginDetails)};return SyncManagerMF}();voltmx=voltmx||{};voltmx.model=voltmx.model||{};voltmx.model.constants=voltmx.model.constants||{};voltmx.model.constants["version"]="1.0";_voltmx=_voltmx||{};_voltmx.mvc=_voltmx.mvc||{};voltmx.mvc=voltmx.mvc||{};voltmx.utils=voltmx.utils||{};voltmx.mvc.ModelFormController=function(){function ModelFormController(viewId1){var modelController;var modelContext;var formConfig;var skipFetchData=false;voltmx.mvc.FormController.call(this,viewId1);this.getModelController=function(){if(!modelController)modelController=new voltmx.model.ModelController(formConfig,this.view,modelContext);return modelController};this.isModelDriven=function(){return formConfig?true:false};this.ensureModelDriven=function(){if(!formConfig)throw"FormConfig is not set"};this.setModelContext=function(modelCtx){modelContext=modelCtx;if(modelController)modelController.setModelContext(modelContext)};this.getModelContext=function(){return modelContext};this.setFormConfig=function(frmCfg){formConfig=frmCfg;if(modelController&&formConfig)modelController.setFormConfig(formConfig)};this.getFormConfig=function(){return formConfig};this.setSkipFetchData=function(flag){skipFetchData=flag};this.getSkipFetchData=function(){return skipFetchData};this.destroy=function(){if(modelController){modelController.destroy();modelController=null}voltmx.mvc.FormController.prototype.destroy.call(this)}}inheritsFrom(ModelFormController,voltmx.mvc.FormController);ModelFormController.prototype.getModel=function(){var model=new voltmx.mvc.FormModel;model.setFormConfig(this.getFormConfig());model.setModelContext(this.getModelContext());model.setSkipFetchData(this.getSkipFetchData());return model};ModelFormController.prototype.setModel=function(model){if(model){var modelParams=model.getModelParams();this.setFormConfig(modelParams.formConfig);this.setModelContext(modelParams.modelContext);this.setSkipFetchData(modelParams.skipFetchData)}};ModelFormController.prototype.getConfig=function(){this.ensureModelDriven();return this.getModelController().getConfig()};ModelFormController.prototype.show=function(param,isBackNavigation){if(isBackNavigation){this.setSkipFetchData(true)}this.navigationMode=1;if(this.onNavigate){this.onNavigate.call(this,param,isBackNavigation)}if(this.navigationMode==1){this.navigationMode=0;if(this.isModelDriven()&&!this.getSkipFetchData()){fetchData.call(this,true)}else{showView.call(this)}function showView(){this.__showView.call(this)}function fetchData(showForm){try{if(this.onFetchData){this.onFetchData(successCallback.bind(this),errorCallback.bind(this))}else{voltmx.model.ApplicationContext.showLoadingScreen("Loading form...");this.fetchData(successCallback.bind(this),errorCallback.bind(this))}}catch(err){errorCallback.call(this,err)}function successCallback(data){try{if(this.onProcessData)data=this.onProcessData(data);else data=this.processData(data);if(this.onBindData)this.onBindData(data);else{this.clearData();this.bindData(data)}voltmx.model.ApplicationContext.dismissLoadingScreen();if(showForm)showView.call(this)}catch(err){errorCallback.call(this,err)}}function errorCallback(err){voltmx.model.ApplicationContext.dismissLoadingScreen();voltmx.print("MVC::FormController::Error in fetch/process/bind data :"+err);if(this.onFetchDataError)this.onFetchDataError(err);alert("Error in fetch/process/bind data for form :'"+this.view.id+"' Error :"+err)}}}};ModelFormController.prototype.reloadData=function(){this.ensureModelDriven();fetchData(false)};ModelFormController.prototype.fetchData=function(successCallback,errorCallback){this.ensureModelDriven();this.getModelController().fetchData(successCallback,errorCallback)};ModelFormController.prototype.processData=function(data){this.ensureModelDriven();return this.getModelController().processData(data)};ModelFormController.prototype.bindData=function(data){this.ensureModelDriven();this.getModelController().bindData(data)};ModelFormController.prototype.saveData=function(successCallback,errorCallback){this.ensureModelDriven();this.getModelController().saveData(successCallback,errorCallback)};ModelFormController.prototype.deleteData=function(successCallback,errorCallback){this.ensureModelDriven();this.getModelController().deleteData(successCallback,errorCallback)};ModelFormController.prototype.saveRecords=function(records,successCallback,errorCallback){this.ensureModelDriven();this.getModelController().saveRecords(records,successCallback,errorCallback)};ModelFormController.prototype.removeRecords=function(records,successCallback,errorCallback){this.ensureModelDriven();this.getModelController().removeRecords(records,successCallback,errorCallback)};ModelFormController.prototype.generateRecords=function(isDelete,successCallback,errorCallback){this.ensureModelDriven();this.getModelController().generateRecords(isDelete,successCallback,errorCallback)};ModelFormController.prototype.invokeCustomVerb=function(readDataFromForm,successCallback,errorCallback){this.ensureModelDriven();this.getModelController().invokeCustomVerb(readDataFromForm,successCallback,errorCallback)};ModelFormController.prototype.fetchForContainer=function(containerId,fetchCriteria,successCallback,errorCallback){this.ensureModelDriven();try{var primaryKeyValueMap=fetchCriteria["primaryKeyValueMap"];var query=fetchCriteria["query"];var tempModelContext;var scopeObj=this;if(primaryKeyValueMap&&query){throw"Both primaryKeyValueMap and query will not be accepted"}else{tempModelContext=this.getModelContext();if(!tempModelContext){tempModelContext=new voltmx.model.ModelContext}if(primaryKeyValueMap){tempModelContext.setPrimaryKeyValueMap(primaryKeyValueMap);tempModelContext.setOperationType(voltmx.model.constants.OperationType.FILTER_BY_PRIMARY_KEY,containerId)}else if(query){tempModelContext.setQuery(query,containerId)}this.setModelContext(tempModelContext);this.getModelController().fetchMetadata(metadataSuccCallback,metadataErrCallback);function metadataSuccCallback(){scopeObj.getModelController().getGroupWidgetsContext().fetchDataForGroupWidget(containerId,successCallback,errorCallback)}function metadataErrCallback(err){errorCallback(err)}}}catch(err){errorCallback(err)}};ModelFormController.prototype.clearData=function(){this.ensureModelDriven();this.getModelController().getViewModel().clear()};return ModelFormController}();voltmx.mvc.FormModel=function(){function FormModel(){var formConfig=null;var modelContext=null;var skipFetchData=true;this.getModelParams=function(){var modelParams={formConfig:formConfig,modelContext:modelContext,skipFetchData:skipFetchData};return modelParams};this.setFormConfig=function(fconfig){formConfig=fconfig;if(formConfig)skipFetchData=false;else skipFetchData=true};this.getFormConfig=function(){return formConfig};this.setModelContext=function(fc){modelContext=fc};this.getModelContext=function(){return modelContext};this.setSkipFetchData=function(flag){skipFetchData=flag}}return FormModel}();(function(undefined){var moment,VERSION="2.9.0",globalScope=typeof global!=="undefined"&&(typeof window==="undefined"||window===global.window)?global:this,oldGlobalMoment,round=Math.round,hasOwnProperty=Object.prototype.hasOwnProperty,i,YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,locales={},momentProperties=[],hasModule=typeof module!=="undefined"&&module&&module.exports,aspNetJsonRegex=/^\/?Date\((\-?\d+)/i,aspNetTimeSpanJsonRegex=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,isoDurationRegex=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,formattingTokens=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|x|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,parseTokenOneOrTwoDigits=/\d\d?/,parseTokenOneToThreeDigits=/\d{1,3}/,parseTokenOneToFourDigits=/\d{1,4}/,parseTokenOneToSixDigits=/[+\-]?\d{1,6}/,parseTokenDigits=/\d+/,parseTokenWord=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,parseTokenTimezone=/Z|[\+\-]\d\d:?\d\d/gi,parseTokenT=/T/i,parseTokenOffsetMs=/[\+\-]?\d+/,parseTokenTimestampMs=/[\+\-]?\d+(\.\d{1,3})?/,parseTokenOneDigit=/\d/,parseTokenTwoDigits=/\d\d/,parseTokenThreeDigits=/\d{3}/,parseTokenFourDigits=/\d{4}/,parseTokenSixDigits=/[+-]?\d{6}/,parseTokenSignedNumber=/[+-]?\d+/,isoRegex=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,isoFormat="YYYY-MM-DDTHH:mm:ssZ",isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],isoTimes=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],parseTimezoneChunker=/([\+\-]|\d\d)/gi,proxyGettersAndSetters="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),unitMillisecondFactors={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},unitAliases={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},camelFunctions={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},formatFunctions={},relativeTimeThresholds={s:45,m:45,h:22,d:26,M:11},ordinalizeTokens="DDD w W M D d".split(" "),paddedTokens="M D H h m s w W".split(" "),formatTokenFunctions={M:function(){return this.month()+1},MMM:function(format){return this.localeData().monthsShort(this,format)},MMMM:function(format){return this.localeData().months(this,format)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(format){return this.localeData().weekdaysMin(this,format)},ddd:function(format){return this.localeData().weekdaysShort(this,format)},dddd:function(format){return this.localeData().weekdays(this,format)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return leftZeroFill(this.year()%100,2)},YYYY:function(){return leftZeroFill(this.year(),4)},YYYYY:function(){return leftZeroFill(this.year(),5)},YYYYYY:function(){var y=this.year(),sign=y>=0?"+":"-";return sign+leftZeroFill(Math.abs(y),6)},gg:function(){return leftZeroFill(this.weekYear()%100,2)},gggg:function(){return leftZeroFill(this.weekYear(),4)},ggggg:function(){return leftZeroFill(this.weekYear(),5)},GG:function(){return leftZeroFill(this.isoWeekYear()%100,2)},GGGG:function(){return leftZeroFill(this.isoWeekYear(),4)},GGGGG:function(){return leftZeroFill(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.localeData().meridiem(this.hours(),this.minutes(),true)},A:function(){return this.localeData().meridiem(this.hours(),this.minutes(),false)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return toInt(this.milliseconds()/100)},SS:function(){return leftZeroFill(toInt(this.milliseconds()/10),2)},SSS:function(){return leftZeroFill(this.milliseconds(),3)},SSSS:function(){return leftZeroFill(this.milliseconds(),3)},Z:function(){var a=this.utcOffset(),b="+";if(a<0){a=-a;b="-"}return b+leftZeroFill(toInt(a/60),2)+":"+leftZeroFill(toInt(a)%60,2)},ZZ:function(){var a=this.utcOffset(),b="+";if(a<0){a=-a;b="-"}return b+leftZeroFill(toInt(a/60),2)+leftZeroFill(toInt(a)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},x:function(){return this.valueOf()},X:function(){return this.unix()},Q:function(){return this.quarter()}},deprecations={},lists=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"],updateInProgress=false;function dfl(a,b,c){switch(arguments.length){case 2:return a!=null?a:b;case 3:return a!=null?a:b!=null?b:c;default:throw new Error("Implement me")}}function hasOwnProp(a,b){return hasOwnProperty.call(a,b)}function defaultParsingFlags(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false}}function printMsg(msg){if(moment.suppressDeprecationWarnings===false&&typeof console!=="undefined"&&console.warn){console.warn("Deprecation warning: "+msg)}}function deprecate(msg,fn){var firstTime=true;return extend(function(){if(firstTime){printMsg(msg);firstTime=false}return fn.apply(this,arguments)},fn)}function deprecateSimple(name,msg){if(!deprecations[name]){printMsg(msg);deprecations[name]=true}}function padToken(func,count){return function(a){return leftZeroFill(func.call(this,a),count)}}function ordinalizeToken(func,period){return function(a){return this.localeData().ordinal(func.call(this,a),period)}}function monthDiff(a,b){var wholeMonthDiff=(b.year()-a.year())*12+(b.month()-a.month()),anchor=a.clone().add(wholeMonthDiff,"months"),anchor2,adjust;if(b-anchor<0){anchor2=a.clone().add(wholeMonthDiff-1,"months");adjust=(b-anchor)/(anchor-anchor2)}else{anchor2=a.clone().add(wholeMonthDiff+1,"months");adjust=(b-anchor)/(anchor2-anchor)}return-(wholeMonthDiff+adjust)}while(ordinalizeTokens.length){i=ordinalizeTokens.pop();formatTokenFunctions[i+"o"]=ordinalizeToken(formatTokenFunctions[i],i)}while(paddedTokens.length){i=paddedTokens.pop();formatTokenFunctions[i+i]=padToken(formatTokenFunctions[i],2)}formatTokenFunctions.DDDD=padToken(formatTokenFunctions.DDD,3);function meridiemFixWrap(locale,hour,meridiem){var isPm;if(meridiem==null){return hour}if(locale.meridiemHour!=null){return locale.meridiemHour(hour,meridiem)}else if(locale.isPM!=null){isPm=locale.isPM(meridiem);if(isPm&&hour<12){hour+=12}if(!isPm&&hour===12){hour=0}return hour}else{return hour}}function Locale(){}function Moment(config,skipOverflow){if(skipOverflow!==false){checkOverflow(config)}copyConfig(this,config);this._d=new Date(+config._d);if(updateInProgress===false){updateInProgress=true;moment.updateOffset(this);updateInProgress=false}}function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._milliseconds=+milliseconds+seconds*1e3+minutes*6e4+hours*36e5;this._days=+days+weeks*7;this._months=+months+quarters*3+years*12;this._data={};this._locale=moment.localeData();this._bubble()}function extend(a,b){for(var i in b){if(hasOwnProp(b,i)){a[i]=b[i]}}if(hasOwnProp(b,"toString")){a.toString=b.toString}if(hasOwnProp(b,"valueOf")){a.valueOf=b.valueOf}return a}function copyConfig(to,from){var i,prop,val;if(typeof from._isAMomentObject!=="undefined"){to._isAMomentObject=from._isAMomentObject}if(typeof from._i!=="undefined"){to._i=from._i}if(typeof from._f!=="undefined"){to._f=from._f}if(typeof from._l!=="undefined"){to._l=from._l}if(typeof from._strict!=="undefined"){to._strict=from._strict}if(typeof from._tzm!=="undefined"){to._tzm=from._tzm}if(typeof from._isUTC!=="undefined"){to._isUTC=from._isUTC}if(typeof from._offset!=="undefined"){to._offset=from._offset}if(typeof from._pf!=="undefined"){to._pf=from._pf}if(typeof from._locale!=="undefined"){to._locale=from._locale}if(momentProperties.length>0){for(i in momentProperties){prop=momentProperties[i];val=from[prop];if(typeof val!=="undefined"){to[prop]=val}}}return to}function absRound(number){if(number<0){return Math.ceil(number)}else{return Math.floor(number)}}function leftZeroFill(number,targetLength,forceSign){var output=""+Math.abs(number),sign=number>=0;while(output.length<targetLength){output="0"+output}return(sign?forceSign?"+":"":"-")+output}function positiveMomentsDifference(base,other){var res={milliseconds:0,months:0};res.months=other.month()-base.month()+(other.year()-base.year())*12;if(base.clone().add(res.months,"M").isAfter(other)){--res.months}res.milliseconds=+other-+base.clone().add(res.months,"M");return res}function momentsDifference(base,other){var res;other=makeAs(other,base);if(base.isBefore(other)){res=positiveMomentsDifference(base,other)}else{res=positiveMomentsDifference(other,base);res.milliseconds=-res.milliseconds;res.months=-res.months}return res}function createAdder(direction,name){return function(val,period){var dur,tmp;if(period!==null&&!isNaN(+period)){deprecateSimple(name,"moment()."+name+"(period, number) is deprecated. Please use moment()."+name+"(number, period).");tmp=val;val=period;period=tmp}val=typeof val==="string"?+val:val;dur=moment.duration(val,period);addOrSubtractDurationFromMoment(this,dur,direction);return this}}function addOrSubtractDurationFromMoment(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=duration._days,months=duration._months;updateOffset=updateOffset==null?true:updateOffset;if(milliseconds){mom._d.setTime(+mom._d+milliseconds*isAdding)}if(days){rawSetter(mom,"Date",rawGetter(mom,"Date")+days*isAdding)}if(months){rawMonthSetter(mom,rawGetter(mom,"Month")+months*isAdding)}if(updateOffset){moment.updateOffset(mom,days||months)}}function isArray(input){return Object.prototype.toString.call(input)==="[object Array]"}function isDate(input){return Object.prototype.toString.call(input)==="[object Date]"||input instanceof Date}function compareArrays(array1,array2,dontConvert){var len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0,i;for(i=0;i<len;i++){if(dontConvert&&array1[i]!==array2[i]||!dontConvert&&toInt(array1[i])!==toInt(array2[i])){diffs++}}return diffs+lengthDiff}function normalizeUnits(units){if(units){var lowered=units.toLowerCase().replace(/(.)s$/,"$1");units=unitAliases[units]||camelFunctions[lowered]||lowered}return units}function normalizeObjectUnits(inputObject){var normalizedInput={},normalizedProp,prop;for(prop in inputObject){if(hasOwnProp(inputObject,prop)){normalizedProp=normalizeUnits(prop);if(normalizedProp){normalizedInput[normalizedProp]=inputObject[prop]}}}return normalizedInput}function makeList(field){var count,setter;if(field.indexOf("week")===0){count=7;setter="day"}else if(field.indexOf("month")===0){count=12;setter="month"}else{return}moment[field]=function(format,index){var i,getter,method=moment._locale[field],results=[];if(typeof format==="number"){index=format;format=undefined}getter=function(i){var m=moment().utc().set(setter,i);return method.call(moment._locale,m,format||"")};if(index!=null){return getter(index)}else{for(i=0;i<count;i++){results.push(getter(i))}return results}}}function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;if(coercedNumber!==0&&isFinite(coercedNumber)){if(coercedNumber>=0){value=Math.floor(coercedNumber)}else{value=Math.ceil(coercedNumber)}}return value}function daysInMonth(year,month){return new Date(Date.UTC(year,month+1,0)).getUTCDate()}function weeksInYear(year,dow,doy){return weekOfYear(moment([year,11,31+dow-doy]),dow,doy).week}function daysInYear(year){return isLeapYear(year)?366:365}function isLeapYear(year){return year%4===0&&year%100!==0||year%400===0}function checkOverflow(m){var overflow;if(m._a&&m._pf.overflow===-2){overflow=m._a[MONTH]<0||m._a[MONTH]>11?MONTH:m._a[DATE]<1||m._a[DATE]>daysInMonth(m._a[YEAR],m._a[MONTH])?DATE:m._a[HOUR]<0||m._a[HOUR]>24||m._a[HOUR]===24&&(m._a[MINUTE]!==0||m._a[SECOND]!==0||m._a[MILLISECOND]!==0)?HOUR:m._a[MINUTE]<0||m._a[MINUTE]>59?MINUTE:m._a[SECOND]<0||m._a[SECOND]>59?SECOND:m._a[MILLISECOND]<0||m._a[MILLISECOND]>999?MILLISECOND:-1;if(m._pf._overflowDayOfYear&&(overflow<YEAR||overflow>DATE)){overflow=DATE}m._pf.overflow=overflow}}function isValid(m){if(m._isValid==null){m._isValid=!isNaN(m._d.getTime())&&m._pf.overflow<0&&!m._pf.empty&&!m._pf.invalidMonth&&!m._pf.nullInput&&!m._pf.invalidFormat&&!m._pf.userInvalidated;if(m._strict){m._isValid=m._isValid&&m._pf.charsLeftOver===0&&m._pf.unusedTokens.length===0&&m._pf.bigHour===undefined}}return m._isValid}function normalizeLocale(key){return key?key.toLowerCase().replace("_","-"):key}function chooseLocale(names){var i=0,j,next,locale,split;while(i<names.length){split=normalizeLocale(names[i]).split("-");j=split.length;next=normalizeLocale(names[i+1]);next=next?next.split("-"):null;while(j>0){locale=loadLocale(split.slice(0,j).join("-"));if(locale){return locale}if(next&&next.length>=j&&compareArrays(split,next,true)>=j-1){break}j--}i++}return null}function loadLocale(name){var oldLocale=null;if(!locales[name]&&hasModule){try{oldLocale=moment.locale();require("./locale/"+name);moment.locale(oldLocale)}catch(e){}}return locales[name]}function makeAs(input,model){var res,diff;if(model._isUTC){res=model.clone();diff=(moment.isMoment(input)||isDate(input)?+input:+moment(input))-+res;res._d.setTime(+res._d+diff);moment.updateOffset(res,false);return res}else{return moment(input).local()}}extend(Locale.prototype,{set:function(config){var prop,i;for(i in config){prop=config[i];if(typeof prop==="function"){this[i]=prop}else{this["_"+i]=prop}}this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(m){return this._months[m.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(m){return this._monthsShort[m.month()]},monthsParse:function(monthName,format,strict){var i,mom,regex;if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[]}for(i=0;i<12;i++){mom=moment.utc([2e3,i]);if(strict&&!this._longMonthsParse[i]){this._longMonthsParse[i]=new RegExp("^"+this.months(mom,"").replace(".","")+"$","i");this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(mom,"").replace(".","")+"$","i")}if(!strict&&!this._monthsParse[i]){regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,"");this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")}if(strict&&format==="MMMM"&&this._longMonthsParse[i].test(monthName)){return i}else if(strict&&format==="MMM"&&this._shortMonthsParse[i].test(monthName)){return i}else if(!strict&&this._monthsParse[i].test(monthName)){return i}}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(m){return this._weekdays[m.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(m){return this._weekdaysShort[m.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(m){return this._weekdaysMin[m.day()]},weekdaysParse:function(weekdayName){var i,mom,regex;if(!this._weekdaysParse){this._weekdaysParse=[]}for(i=0;i<7;i++){if(!this._weekdaysParse[i]){mom=moment([2e3,1]).day(i);regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,"");this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")}if(this._weekdaysParse[i].test(weekdayName)){return i}}},_longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"},longDateFormat:function(key){var output=this._longDateFormat[key];if(!output&&this._longDateFormat[key.toUpperCase()]){output=this._longDateFormat[key.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1)});this._longDateFormat[key]=output}return output},isPM:function(input){return(input+"").toLowerCase().charAt(0)==="p"},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(hours,minutes,isLower){if(hours>11){return isLower?"pm":"PM"}else{return isLower?"am":"AM"}},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",
nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(key,mom,now){var output=this._calendar[key];return typeof output==="function"?output.apply(mom,[now]):output},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return typeof output==="function"?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)},pastFuture:function(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return typeof format==="function"?format(output):format.replace(/%s/i,output)},ordinal:function(number){return this._ordinal.replace("%d",number)},_ordinal:"%d",_ordinalParse:/\d{1,2}/,preparse:function(string){return string},postformat:function(string){return string},week:function(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},firstDayOfWeek:function(){return this._week.dow},firstDayOfYear:function(){return this._week.doy},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}});function removeFormattingTokens(input){if(input.match(/\[[\s\S]/)){return input.replace(/^\[|\]$/g,"")}return input.replace(/\\/g,"")}function makeFormatFunction(format){var array=format.match(formattingTokens),i,length;for(i=0,length=array.length;i<length;i++){if(formatTokenFunctions[array[i]]){array[i]=formatTokenFunctions[array[i]]}else{array[i]=removeFormattingTokens(array[i])}}return function(mom){var output="";for(i=0;i<length;i++){output+=array[i]instanceof Function?array[i].call(mom,format):array[i]}return output}}function formatMoment(m,format){if(!m.isValid()){return m.localeData().invalidDate()}format=expandFormat(format,m.localeData());if(!formatFunctions[format]){formatFunctions[format]=makeFormatFunction(format)}return formatFunctions[format](m)}function expandFormat(format,locale){var i=5;function replaceLongDateFormatTokens(input){return locale.longDateFormat(input)||input}localFormattingTokens.lastIndex=0;while(i>=0&&localFormattingTokens.test(format)){format=format.replace(localFormattingTokens,replaceLongDateFormatTokens);localFormattingTokens.lastIndex=0;i-=1}return format}function getParseRegexForToken(token,config){var a,strict=config._strict;switch(token){case"Q":return parseTokenOneDigit;case"DDDD":return parseTokenThreeDigits;case"YYYY":case"GGGG":case"gggg":return strict?parseTokenFourDigits:parseTokenOneToFourDigits;case"Y":case"G":case"g":return parseTokenSignedNumber;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return strict?parseTokenSixDigits:parseTokenOneToSixDigits;case"S":if(strict){return parseTokenOneDigit}case"SS":if(strict){return parseTokenTwoDigits}case"SSS":if(strict){return parseTokenThreeDigits}case"DDD":return parseTokenOneToThreeDigits;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return parseTokenWord;case"a":case"A":return config._locale._meridiemParse;case"x":return parseTokenOffsetMs;case"X":return parseTokenTimestampMs;case"Z":case"ZZ":return parseTokenTimezone;case"T":return parseTokenT;case"SSSS":return parseTokenDigits;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return strict?parseTokenTwoDigits:parseTokenOneOrTwoDigits;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return parseTokenOneOrTwoDigits;case"Do":return strict?config._locale._ordinalParse:config._locale._ordinalParseLenient;default:a=new RegExp(regexpEscape(unescapeFormat(token.replace("\\","")),"i"));return a}}function utcOffsetFromString(string){string=string||"";var possibleTzMatches=string.match(parseTokenTimezone)||[],tzChunk=possibleTzMatches[possibleTzMatches.length-1]||[],parts=(tzChunk+"").match(parseTimezoneChunker)||["-",0,0],minutes=+(parts[1]*60)+toInt(parts[2]);return parts[0]==="+"?minutes:-minutes}function addTimeToArrayFromToken(token,input,config){var a,datePartArray=config._a;switch(token){case"Q":if(input!=null){datePartArray[MONTH]=(toInt(input)-1)*3}break;case"M":case"MM":if(input!=null){datePartArray[MONTH]=toInt(input)-1}break;case"MMM":case"MMMM":a=config._locale.monthsParse(input,token,config._strict);if(a!=null){datePartArray[MONTH]=a}else{config._pf.invalidMonth=input}break;case"D":case"DD":if(input!=null){datePartArray[DATE]=toInt(input)}break;case"Do":if(input!=null){datePartArray[DATE]=toInt(parseInt(input.match(/\d{1,2}/)[0],10))}break;case"DDD":case"DDDD":if(input!=null){config._dayOfYear=toInt(input)}break;case"YY":datePartArray[YEAR]=moment.parseTwoDigitYear(input);break;case"YYYY":case"YYYYY":case"YYYYYY":datePartArray[YEAR]=toInt(input);break;case"a":case"A":config._meridiem=input;break;case"h":case"hh":config._pf.bigHour=true;case"H":case"HH":datePartArray[HOUR]=toInt(input);break;case"m":case"mm":datePartArray[MINUTE]=toInt(input);break;case"s":case"ss":datePartArray[SECOND]=toInt(input);break;case"S":case"SS":case"SSS":case"SSSS":datePartArray[MILLISECOND]=toInt(("0."+input)*1e3);break;case"x":config._d=new Date(toInt(input));break;case"X":config._d=new Date(parseFloat(input)*1e3);break;case"Z":case"ZZ":config._useUTC=true;config._tzm=utcOffsetFromString(input);break;case"dd":case"ddd":case"dddd":a=config._locale.weekdaysParse(input);if(a!=null){config._w=config._w||{};config._w["d"]=a}else{config._pf.invalidWeekday=input}break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":token=token.substr(0,1);case"gggg":case"GGGG":case"GGGGG":token=token.substr(0,2);if(input){config._w=config._w||{};config._w[token]=toInt(input)}break;case"gg":case"GG":config._w=config._w||{};config._w[token]=moment.parseTwoDigitYear(input)}}function dayOfYearFromWeekInfo(config){var w,weekYear,week,weekday,dow,doy,temp;w=config._w;if(w.GG!=null||w.W!=null||w.E!=null){dow=1;doy=4;weekYear=dfl(w.GG,config._a[YEAR],weekOfYear(moment(),1,4).year);week=dfl(w.W,1);weekday=dfl(w.E,1)}else{dow=config._locale._week.dow;doy=config._locale._week.doy;weekYear=dfl(w.gg,config._a[YEAR],weekOfYear(moment(),dow,doy).year);week=dfl(w.w,1);if(w.d!=null){weekday=w.d;if(weekday<dow){++week}}else if(w.e!=null){weekday=w.e+dow}else{weekday=dow}}temp=dayOfYearFromWeeks(weekYear,week,weekday,doy,dow);config._a[YEAR]=temp.year;config._dayOfYear=temp.dayOfYear}function dateFromConfig(config){var i,date,input=[],currentDate,yearToUse;if(config._d){return}currentDate=currentDateArray(config);if(config._w&&config._a[DATE]==null&&config._a[MONTH]==null){dayOfYearFromWeekInfo(config)}if(config._dayOfYear){yearToUse=dfl(config._a[YEAR],currentDate[YEAR]);if(config._dayOfYear>daysInYear(yearToUse)){config._pf._overflowDayOfYear=true}date=makeUTCDate(yearToUse,0,config._dayOfYear);config._a[MONTH]=date.getUTCMonth();config._a[DATE]=date.getUTCDate()}for(i=0;i<3&&config._a[i]==null;++i){config._a[i]=input[i]=currentDate[i]}for(;i<7;i++){config._a[i]=input[i]=config._a[i]==null?i===2?1:0:config._a[i]}if(config._a[HOUR]===24&&config._a[MINUTE]===0&&config._a[SECOND]===0&&config._a[MILLISECOND]===0){config._nextDay=true;config._a[HOUR]=0}config._d=(config._useUTC?makeUTCDate:makeDate).apply(null,input);if(config._tzm!=null){config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm)}if(config._nextDay){config._a[HOUR]=24}}function dateFromObject(config){var normalizedInput;if(config._d){return}normalizedInput=normalizeObjectUnits(config._i);config._a=[normalizedInput.year,normalizedInput.month,normalizedInput.day||normalizedInput.date,normalizedInput.hour,normalizedInput.minute,normalizedInput.second,normalizedInput.millisecond];dateFromConfig(config)}function currentDateArray(config){var now=new Date;if(config._useUTC){return[now.getUTCFullYear(),now.getUTCMonth(),now.getUTCDate()]}else{return[now.getFullYear(),now.getMonth(),now.getDate()]}}function makeDateFromStringAndFormat(config){if(config._f===moment.ISO_8601){parseISO(config);return}config._a=[];config._pf.empty=true;var string=""+config._i,i,parsedInput,tokens,token,skipped,stringLength=string.length,totalParsedInputLength=0;tokens=expandFormat(config._f,config._locale).match(formattingTokens)||[];for(i=0;i<tokens.length;i++){token=tokens[i];parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0];if(parsedInput){skipped=string.substr(0,string.indexOf(parsedInput));if(skipped.length>0){config._pf.unusedInput.push(skipped)}string=string.slice(string.indexOf(parsedInput)+parsedInput.length);totalParsedInputLength+=parsedInput.length}if(formatTokenFunctions[token]){if(parsedInput){config._pf.empty=false}else{config._pf.unusedTokens.push(token)}addTimeToArrayFromToken(token,parsedInput,config)}else if(config._strict&&!parsedInput){config._pf.unusedTokens.push(token)}}config._pf.charsLeftOver=stringLength-totalParsedInputLength;if(string.length>0){config._pf.unusedInput.push(string)}if(config._pf.bigHour===true&&config._a[HOUR]<=12){config._pf.bigHour=undefined}config._a[HOUR]=meridiemFixWrap(config._locale,config._a[HOUR],config._meridiem);dateFromConfig(config);checkOverflow(config)}function unescapeFormat(s){return s.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4})}function regexpEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function makeDateFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore;if(config._f.length===0){config._pf.invalidFormat=true;config._d=new Date(NaN);return}for(i=0;i<config._f.length;i++){currentScore=0;tempConfig=copyConfig({},config);if(config._useUTC!=null){tempConfig._useUTC=config._useUTC}tempConfig._pf=defaultParsingFlags();tempConfig._f=config._f[i];makeDateFromStringAndFormat(tempConfig);if(!isValid(tempConfig)){continue}currentScore+=tempConfig._pf.charsLeftOver;currentScore+=tempConfig._pf.unusedTokens.length*10;tempConfig._pf.score=currentScore;if(scoreToBeat==null||currentScore<scoreToBeat){scoreToBeat=currentScore;bestMoment=tempConfig}}extend(config,bestMoment||tempConfig)}function parseISO(config){var i,l,string=config._i,match=isoRegex.exec(string);if(match){config._pf.iso=true;for(i=0,l=isoDates.length;i<l;i++){if(isoDates[i][1].exec(string)){config._f=isoDates[i][0]+(match[6]||" ");break}}for(i=0,l=isoTimes.length;i<l;i++){if(isoTimes[i][1].exec(string)){config._f+=isoTimes[i][0];break}}if(string.match(parseTokenTimezone)){config._f+="Z"}makeDateFromStringAndFormat(config)}else{config._isValid=false}}function makeDateFromString(config){parseISO(config);if(config._isValid===false){delete config._isValid;moment.createFromInputFallback(config)}}function map(arr,fn){var res=[],i;for(i=0;i<arr.length;++i){res.push(fn(arr[i],i))}return res}function makeDateFromInput(config){var input=config._i,matched;if(input===undefined){config._d=new Date}else if(isDate(input)){config._d=new Date(+input)}else if((matched=aspNetJsonRegex.exec(input))!==null){config._d=new Date(+matched[1])}else if(typeof input==="string"){makeDateFromString(config)}else if(isArray(input)){config._a=map(input.slice(0),function(obj){return parseInt(obj,10)});dateFromConfig(config)}else if(typeof input==="object"){dateFromObject(config)}else if(typeof input==="number"){config._d=new Date(input)}else{moment.createFromInputFallback(config)}}function makeDate(y,m,d,h,M,s,ms){var date=new Date(y,m,d,h,M,s,ms);if(y<1970){date.setFullYear(y)}return date}function makeUTCDate(y){var date=new Date(Date.UTC.apply(null,arguments));if(y<1970){date.setUTCFullYear(y)}return date}function parseWeekday(input,locale){if(typeof input==="string"){if(!isNaN(input)){input=parseInt(input,10)}else{input=locale.weekdaysParse(input);if(typeof input!=="number"){return null}}}return input}function substituteTimeAgo(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture)}function relativeTime(posNegDuration,withoutSuffix,locale){var duration=moment.duration(posNegDuration).abs(),seconds=round(duration.as("s")),minutes=round(duration.as("m")),hours=round(duration.as("h")),days=round(duration.as("d")),months=round(duration.as("M")),years=round(duration.as("y")),args=seconds<relativeTimeThresholds.s&&["s",seconds]||minutes===1&&["m"]||minutes<relativeTimeThresholds.m&&["mm",minutes]||hours===1&&["h"]||hours<relativeTimeThresholds.h&&["hh",hours]||days===1&&["d"]||days<relativeTimeThresholds.d&&["dd",days]||months===1&&["M"]||months<relativeTimeThresholds.M&&["MM",months]||years===1&&["y"]||["yy",years];args[2]=withoutSuffix;args[3]=+posNegDuration>0;args[4]=locale;return substituteTimeAgo.apply({},args)}function weekOfYear(mom,firstDayOfWeek,firstDayOfWeekOfYear){var end=firstDayOfWeekOfYear-firstDayOfWeek,daysToDayOfWeek=firstDayOfWeekOfYear-mom.day(),adjustedMoment;if(daysToDayOfWeek>end){daysToDayOfWeek-=7}if(daysToDayOfWeek<end-7){daysToDayOfWeek+=7}adjustedMoment=moment(mom).add(daysToDayOfWeek,"d");return{week:Math.ceil(adjustedMoment.dayOfYear()/7),year:adjustedMoment.year()}}function dayOfYearFromWeeks(year,week,weekday,firstDayOfWeekOfYear,firstDayOfWeek){var d=makeUTCDate(year,0,1).getUTCDay(),daysToAdd,dayOfYear;d=d===0?7:d;weekday=weekday!=null?weekday:firstDayOfWeek;daysToAdd=firstDayOfWeek-d+(d>firstDayOfWeekOfYear?7:0)-(d<firstDayOfWeek?7:0);dayOfYear=7*(week-1)+(weekday-firstDayOfWeek)+daysToAdd+1;return{year:dayOfYear>0?year:year-1,dayOfYear:dayOfYear>0?dayOfYear:daysInYear(year-1)+dayOfYear}}function makeMoment(config){var input=config._i,format=config._f,res;config._locale=config._locale||moment.localeData(config._l);if(input===null||format===undefined&&input===""){return moment.invalid({nullInput:true})}if(typeof input==="string"){config._i=input=config._locale.preparse(input)}if(moment.isMoment(input)){return new Moment(input,true)}else if(format){if(isArray(format)){makeDateFromStringAndArray(config)}else{makeDateFromStringAndFormat(config)}}else{makeDateFromInput(config)}res=new Moment(config);if(res._nextDay){res.add(1,"d");res._nextDay=undefined}return res}moment=function(input,format,locale,strict){var c;if(typeof locale==="boolean"){strict=locale;locale=undefined}c={};c._isAMomentObject=true;c._i=input;c._f=format;c._l=locale;c._strict=strict;c._isUTC=false;c._pf=defaultParsingFlags();return makeMoment(c)};moment.suppressDeprecationWarnings=false;moment.createFromInputFallback=deprecate("moment construction falls back to js Date. This is "+"discouraged and will be removed in upcoming major "+"release. Please refer to "+"https://github.com/moment/moment/issues/1407 for more info.",function(config){config._d=new Date(config._i+(config._useUTC?" UTC":""))});function pickBy(fn,moments){var res,i;if(moments.length===1&&isArray(moments[0])){moments=moments[0]}if(!moments.length){return moment()}res=moments[0];for(i=1;i<moments.length;++i){if(moments[i][fn](res)){res=moments[i]}}return res}moment.min=function(){var args=[].slice.call(arguments,0);return pickBy("isBefore",args)};moment.max=function(){var args=[].slice.call(arguments,0);return pickBy("isAfter",args)};moment.utc=function(input,format,locale,strict){var c;if(typeof locale==="boolean"){strict=locale;locale=undefined}c={};c._isAMomentObject=true;c._useUTC=true;c._isUTC=true;c._l=locale;c._i=input;c._f=format;c._strict=strict;c._pf=defaultParsingFlags();return makeMoment(c).utc()};moment.unix=function(input){return moment(input*1e3)};moment.duration=function(input,key){var duration=input,match=null,sign,ret,parseIso,diffRes;if(moment.isDuration(input)){duration={ms:input._milliseconds,d:input._days,M:input._months}}else if(typeof input==="number"){duration={};if(key){duration[key]=input}else{duration.milliseconds=input}}else if(!!(match=aspNetTimeSpanJsonRegex.exec(input))){sign=match[1]==="-"?-1:1;duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(match[MILLISECOND])*sign}}else if(!!(match=isoDurationRegex.exec(input))){sign=match[1]==="-"?-1:1;parseIso=function(inp){var res=inp&&parseFloat(inp.replace(",","."));return(isNaN(res)?0:res)*sign};duration={y:parseIso(match[2]),M:parseIso(match[3]),d:parseIso(match[4]),h:parseIso(match[5]),m:parseIso(match[6]),s:parseIso(match[7]),w:parseIso(match[8])}}else if(duration==null){duration={}}else if(typeof duration==="object"&&("from"in duration||"to"in duration)){diffRes=momentsDifference(moment(duration.from),moment(duration.to));duration={};duration.ms=diffRes.milliseconds;duration.M=diffRes.months}ret=new Duration(duration);if(moment.isDuration(input)&&hasOwnProp(input,"_locale")){ret._locale=input._locale}return ret};moment.version=VERSION;moment.defaultFormat=isoFormat;moment.ISO_8601=function(){};moment.momentProperties=momentProperties;moment.updateOffset=function(){};moment.relativeTimeThreshold=function(threshold,limit){if(relativeTimeThresholds[threshold]===undefined){return false}if(limit===undefined){return relativeTimeThresholds[threshold]}relativeTimeThresholds[threshold]=limit;return true};moment.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",function(key,value){return moment.locale(key,value)});moment.locale=function(key,values){var data;if(key){if(typeof values!=="undefined"){data=moment.defineLocale(key,values)}else{data=moment.localeData(key)}if(data){moment.duration._locale=moment._locale=data}}return moment._locale._abbr};moment.defineLocale=function(name,values){if(values!==null){values.abbr=name;if(!locales[name]){locales[name]=new Locale}locales[name].set(values);moment.locale(name);return locales[name]}else{delete locales[name];return null}};moment.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",function(key){return moment.localeData(key)});moment.localeData=function(key){var locale;if(key&&key._locale&&key._locale._abbr){key=key._locale._abbr}if(!key){return moment._locale}if(!isArray(key)){locale=loadLocale(key);if(locale){return locale}key=[key]}return chooseLocale(key)};moment.isMoment=function(obj){return obj instanceof Moment||obj!=null&&hasOwnProp(obj,"_isAMomentObject")};moment.isDuration=function(obj){return obj instanceof Duration};for(i=lists.length-1;i>=0;--i){makeList(lists[i])}moment.normalizeUnits=function(units){return normalizeUnits(units)};moment.invalid=function(flags){var m=moment.utc(NaN);if(flags!=null){extend(m._pf,flags)}else{m._pf.userInvalidated=true}return m};moment.parseZone=function(){return moment.apply(null,arguments).parseZone()};moment.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2e3)};moment.isDate=isDate;extend(moment.fn=Moment.prototype,{clone:function(){return moment(this)},valueOf:function(){return+this._d-(this._offset||0)*6e4},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var m=moment(this).utc();if(0<m.year()&&m.year()<=9999){if("function"===typeof Date.prototype.toISOString){return this.toDate().toISOString()}else{return formatMoment(m,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}}else{return formatMoment(m,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}},toArray:function(){var m=this;return[m.year(),m.month(),m.date(),m.hours(),m.minutes(),m.seconds(),m.milliseconds()]},isValid:function(){return isValid(this)},isDSTShifted:function(){if(this._a){return this.isValid()&&compareArrays(this._a,(this._isUTC?moment.utc(this._a):moment(this._a)).toArray())>0}return false},parsingFlags:function(){return extend({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(keepLocalTime){return this.utcOffset(0,keepLocalTime)},local:function(keepLocalTime){if(this._isUTC){this.utcOffset(0,keepLocalTime);this._isUTC=false;if(keepLocalTime){this.subtract(this._dateUtcOffset(),"m")}}return this},format:function(inputString){var output=formatMoment(this,inputString||moment.defaultFormat);return this.localeData().postformat(output)},add:createAdder(1,"add"),subtract:createAdder(-1,"subtract"),diff:function(input,units,asFloat){var that=makeAs(input,this),zoneDiff=(that.utcOffset()-this.utcOffset())*6e4,anchor,diff,output,daysAdjust;units=normalizeUnits(units);if(units==="year"||units==="month"||units==="quarter"){output=monthDiff(this,that);if(units==="quarter"){output=output/3}else if(units==="year"){output=output/12}}else{diff=this-that;output=units==="second"?diff/1e3:units==="minute"?diff/6e4:units==="hour"?diff/36e5:units==="day"?(diff-zoneDiff)/864e5:units==="week"?(diff-zoneDiff)/6048e5:diff}return asFloat?output:absRound(output)},from:function(time,withoutSuffix){return moment.duration({to:this,from:time}).locale(this.locale()).humanize(!withoutSuffix)},fromNow:function(withoutSuffix){return this.from(moment(),withoutSuffix)},calendar:function(time){var now=time||moment(),sod=makeAs(now,this).startOf("day"),diff=this.diff(sod,"days",true),format=diff<-6?"sameElse":diff<-1?"lastWeek":diff<0?"lastDay":diff<1?"sameDay":diff<2?"nextDay":diff<7?"nextWeek":"sameElse";return this.format(this.localeData().calendar(format,this,moment(now)))},isLeapYear:function(){return isLeapYear(this.year())},isDST:function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},day:function(input){var day=this._isUTC?this._d.getUTCDay():this._d.getDay();if(input!=null){input=parseWeekday(input,this.localeData());return this.add(input-day,"d")}else{return day}},month:makeAccessor("Month",true),startOf:function(units){units=normalizeUnits(units);switch(units){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}if(units==="week"){this.weekday(0)}else if(units==="isoWeek"){this.isoWeekday(1)}if(units==="quarter"){this.month(Math.floor(this.month()/3)*3)}return this},endOf:function(units){units=normalizeUnits(units);if(units===undefined||units==="millisecond"){return this}return this.startOf(units).add(1,units==="isoWeek"?"week":units).subtract(1,"ms")},isAfter:function(input,units){var inputMs;units=normalizeUnits(typeof units!=="undefined"?units:"millisecond");if(units==="millisecond"){input=moment.isMoment(input)?input:moment(input);return+this>+input}else{inputMs=moment.isMoment(input)?+input:+moment(input);return inputMs<+this.clone().startOf(units)}},isBefore:function(input,units){var inputMs;units=normalizeUnits(typeof units!=="undefined"?units:"millisecond");if(units==="millisecond"){input=moment.isMoment(input)?input:moment(input);return+this<+input}else{inputMs=moment.isMoment(input)?+input:+moment(input);return+this.clone().endOf(units)<inputMs}},isBetween:function(from,to,units){return this.isAfter(from,units)&&this.isBefore(to,units)},isSame:function(input,units){var inputMs;units=normalizeUnits(units||"millisecond");if(units==="millisecond"){input=moment.isMoment(input)?input:moment(input);return+this===+input}else{inputMs=+moment(input);return+this.clone().startOf(units)<=inputMs&&inputMs<=+this.clone().endOf(units)}},min:deprecate("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(other){other=moment.apply(null,arguments);return other<this?this:other}),max:deprecate("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(other){other=moment.apply(null,arguments);return other>this?this:other}),zone:deprecate("moment().zone is deprecated, use moment().utcOffset instead. "+"https://github.com/moment/moment/issues/1779",function(input,keepLocalTime){if(input!=null){if(typeof input!=="string"){input=-input}this.utcOffset(input,keepLocalTime);return this}else{return-this.utcOffset()}}),utcOffset:function(input,keepLocalTime){var offset=this._offset||0,localAdjust;if(input!=null){if(typeof input==="string"){input=utcOffsetFromString(input)}if(Math.abs(input)<16){input=input*60}if(!this._isUTC&&keepLocalTime){localAdjust=this._dateUtcOffset()}this._offset=input;this._isUTC=true;if(localAdjust!=null){this.add(localAdjust,"m")}if(offset!==input){if(!keepLocalTime||this._changeInProgress){addOrSubtractDurationFromMoment(this,moment.duration(input-offset,"m"),1,false)}else if(!this._changeInProgress){this._changeInProgress=true;moment.updateOffset(this,true);this._changeInProgress=null}}return this}else{return this._isUTC?offset:this._dateUtcOffset()}},isLocal:function(){return!this._isUTC},isUtcOffset:function(){return this._isUTC},isUtc:function(){return this._isUTC&&this._offset===0},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){if(this._tzm){this.utcOffset(this._tzm)}else if(typeof this._i==="string"){this.utcOffset(utcOffsetFromString(this._i))}return this},hasAlignedHourOffset:function(input){if(!input){input=0}else{input=moment(input).utcOffset()}return(this.utcOffset()-input)%60===0},daysInMonth:function(){return daysInMonth(this.year(),this.month())},dayOfYear:function(input){var dayOfYear=round((moment(this).startOf("day")-moment(this).startOf("year"))/864e5)+1;return input==null?dayOfYear:this.add(input-dayOfYear,"d")},quarter:function(input){return input==null?Math.ceil((this.month()+1)/3):this.month((input-1)*3+this.month()%3)},weekYear:function(input){var year=weekOfYear(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return input==null?year:this.add(input-year,"y")},isoWeekYear:function(input){var year=weekOfYear(this,1,4).year;return input==null?year:this.add(input-year,"y")},week:function(input){var week=this.localeData().week(this);return input==null?week:this.add((input-week)*7,"d")},isoWeek:function(input){var week=weekOfYear(this,1,4).week;return input==null?week:this.add((input-week)*7,"d")},weekday:function(input){var weekday=(this.day()+7-this.localeData()._week.dow)%7;return input==null?weekday:this.add(input-weekday,"d")},isoWeekday:function(input){return input==null?this.day()||7:this.day(this.day()%7?input:input-7)},isoWeeksInYear:function(){return weeksInYear(this.year(),1,4)},weeksInYear:function(){var weekInfo=this.localeData()._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy)},get:function(units){units=normalizeUnits(units);return this[units]()},set:function(units,value){var unit;if(typeof units==="object"){for(unit in units){this.set(unit,units[unit])}}else{units=normalizeUnits(units);if(typeof this[units]==="function"){this[units](value)}}return this},locale:function(key){var newLocaleData;if(key===undefined){return this._locale._abbr}else{newLocaleData=moment.localeData(key);if(newLocaleData!=null){this._locale=newLocaleData}return this}},lang:deprecate("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(key){if(key===undefined){return this.localeData()}else{return this.locale(key)}}),localeData:function(){return this._locale},_dateUtcOffset:function(){return-Math.round(this._d.getTimezoneOffset()/15)*15}});function rawMonthSetter(mom,value){var dayOfMonth;if(typeof value==="string"){value=mom.localeData().monthsParse(value);if(typeof value!=="number"){return mom}}dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value));mom._d["set"+(mom._isUTC?"UTC":"")+"Month"](value,dayOfMonth);return mom}function rawGetter(mom,unit){return mom._d["get"+(mom._isUTC?"UTC":"")+unit]()}function rawSetter(mom,unit,value){if(unit==="Month"){return rawMonthSetter(mom,value)}else{return mom._d["set"+(mom._isUTC?"UTC":"")+unit](value)}}function makeAccessor(unit,keepTime){return function(value){if(value!=null){rawSetter(this,unit,value);moment.updateOffset(this,keepTime);return this}else{return rawGetter(this,unit)}}}moment.fn.millisecond=moment.fn.milliseconds=makeAccessor("Milliseconds",false);moment.fn.second=moment.fn.seconds=makeAccessor("Seconds",false);moment.fn.minute=moment.fn.minutes=makeAccessor("Minutes",false);moment.fn.hour=moment.fn.hours=makeAccessor("Hours",true);moment.fn.date=makeAccessor("Date",true);moment.fn.dates=deprecate("dates accessor is deprecated. Use date instead.",makeAccessor("Date",true));moment.fn.year=makeAccessor("FullYear",true);moment.fn.years=deprecate("years accessor is deprecated. Use year instead.",makeAccessor("FullYear",true));moment.fn.days=moment.fn.day;moment.fn.months=moment.fn.month;moment.fn.weeks=moment.fn.week;moment.fn.isoWeeks=moment.fn.isoWeek;moment.fn.quarters=moment.fn.quarter;moment.fn.toJSON=moment.fn.toISOString;moment.fn.isUTC=moment.fn.isUtc;function daysToYears(days){return days*400/146097}function yearsToDays(years){return years*146097/400}extend(moment.duration.fn=Duration.prototype,{_bubble:function(){var milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data,seconds,minutes,hours,years=0;data.milliseconds=milliseconds%1e3;seconds=absRound(milliseconds/1e3);data.seconds=seconds%60;minutes=absRound(seconds/60);data.minutes=minutes%60;hours=absRound(minutes/60);data.hours=hours%24;days+=absRound(hours/24);years=absRound(daysToYears(days));days-=absRound(yearsToDays(years));months+=absRound(days/30);days%=30;years+=absRound(months/12);months%=12;data.days=days;data.months=months;data.years=years},abs:function(){this._milliseconds=Math.abs(this._milliseconds);this._days=Math.abs(this._days);this._months=Math.abs(this._months);this._data.milliseconds=Math.abs(this._data.milliseconds);this._data.seconds=Math.abs(this._data.seconds);this._data.minutes=Math.abs(this._data.minutes);this._data.hours=Math.abs(this._data.hours);this._data.months=Math.abs(this._data.months);this._data.years=Math.abs(this._data.years);return this},weeks:function(){return absRound(this.days()/7)},valueOf:function(){return this._milliseconds+this._days*864e5+this._months%12*2592e6+toInt(this._months/12)*31536e6},humanize:function(withSuffix){var output=relativeTime(this,!withSuffix,this.localeData());if(withSuffix){output=this.localeData().pastFuture(+this,output)}return this.localeData().postformat(output)},add:function(input,val){var dur=moment.duration(input,val);this._milliseconds+=dur._milliseconds;this._days+=dur._days;this._months+=dur._months;this._bubble();return this},subtract:function(input,val){var dur=moment.duration(input,val);this._milliseconds-=dur._milliseconds;this._days-=dur._days;this._months-=dur._months;this._bubble();return this},get:function(units){units=normalizeUnits(units);return this[units.toLowerCase()+"s"]()},as:function(units){var days,months;units=normalizeUnits(units);if(units==="month"||units==="year"){days=this._days+this._milliseconds/864e5;months=this._months+daysToYears(days)*12;return units==="month"?months:months/12}else{days=this._days+Math.round(yearsToDays(this._months/12));switch(units){case"week":return days/7+this._milliseconds/6048e5;case"day":return days+this._milliseconds/864e5;case"hour":return days*24+this._milliseconds/36e5;case"minute":return days*24*60+this._milliseconds/6e4;case"second":return days*24*60*60+this._milliseconds/1e3;case"millisecond":return Math.floor(days*24*60*60*1e3)+this._milliseconds;default:throw new Error("Unknown unit "+units)}}},lang:moment.fn.lang,locale:moment.fn.locale,toIsoString:deprecate("toIsoString() is deprecated. Please use toISOString() instead "+"(notice the capitals)",function(){return this.toISOString()}),toISOString:function(){var years=Math.abs(this.years()),months=Math.abs(this.months()),days=Math.abs(this.days()),hours=Math.abs(this.hours()),minutes=Math.abs(this.minutes()),seconds=Math.abs(this.seconds()+this.milliseconds()/1e3);if(!this.asSeconds()){return"P0D"}
return(this.asSeconds()<0?"-":"")+"P"+(years?years+"Y":"")+(months?months+"M":"")+(days?days+"D":"")+(hours||minutes||seconds?"T":"")+(hours?hours+"H":"")+(minutes?minutes+"M":"")+(seconds?seconds+"S":"")},localeData:function(){return this._locale},toJSON:function(){return this.toISOString()}});moment.duration.fn.toString=moment.duration.fn.toISOString;function makeDurationGetter(name){moment.duration.fn[name]=function(){return this._data[name]}}for(i in unitMillisecondFactors){if(hasOwnProp(unitMillisecondFactors,i)){makeDurationGetter(i.toLowerCase())}}moment.duration.fn.asMilliseconds=function(){return this.as("ms")};moment.duration.fn.asSeconds=function(){return this.as("s")};moment.duration.fn.asMinutes=function(){return this.as("m")};moment.duration.fn.asHours=function(){return this.as("h")};moment.duration.fn.asDays=function(){return this.as("d")};moment.duration.fn.asWeeks=function(){return this.as("weeks")};moment.duration.fn.asMonths=function(){return this.as("M")};moment.duration.fn.asYears=function(){return this.as("y")};moment.locale("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(number){var b=number%10,output=toInt(number%100/10)===1?"th":b===1?"st":b===2?"nd":b===3?"rd":"th";return number+output}});function makeGlobal(shouldDeprecate){if(typeof ender!=="undefined"){return}oldGlobalMoment=globalScope.moment;if(shouldDeprecate){globalScope.moment=deprecate("Accessing Moment through the global scope is "+"deprecated, and will be removed in an upcoming "+"release.",moment)}else{globalScope.moment=moment}}if(hasModule){module.exports=moment}else{makeGlobal()}}).call(this);voltmx=voltmx||{};voltmx.model=voltmx.model||{};voltmx.model.log=voltmx.model.log||{};voltmx.model.showSyncLoadingScreen=function(text){voltmx.model.ApplicationContext.showSyncLoadingScreen(text)};voltmx.model.dismissSyncLoadingScreen=function(){voltmx.model.ApplicationContext.dismissSyncLoadingScreen()};voltmx.model.onsyncstartCallback=function(outputparams){voltmx.model.showSyncLoadingScreen("Sync Started")};voltmx.model.onsyncsuccessCallback=function(){voltmx.model.log.info("Sync Success");voltmx.model.dismissSyncLoadingScreen()};voltmx.model.onsyncerrorCallback=function(){voltmx.model.log.error("Sync Error");voltmx.model.dismissSyncLoadingScreen()};voltmx.model.onbatchstoredCallback=function(outputparams){voltmx.model.showSyncLoadingScreen("Batch Stored")};voltmx.model.onbatchprocessingsuccessCallback=function(outputparams){voltmx.model.showSyncLoadingScreen("Batch Processing Success")};voltmx.model.onscopestartCallback=function(outputparams){voltmx.model.showSyncLoadingScreen("Scope Started")};voltmx.model.onscopesuccessCallback=function(outputparams){voltmx.model.showSyncLoadingScreen("Scope Success");voltmx.model.dismissSyncLoadingScreen()};voltmx=voltmx||{};voltmx.model=voltmx.model||{};voltmx.model.Util=voltmx.model.Util||{};voltmx.model.Util.reqCount=1;voltmx.model.Util.alphabets="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";voltmx.model.Util.isPerfTestReq=false;voltmx.model.Util.endsWith=function(inStr,inSuffix){var str=inStr.toLowerCase();var suffix=inSuffix.toLowerCase();return str.indexOf(suffix,str.length-suffix.length)!==-1};voltmx.model.Util.getKeyByValue=function(value,EnumType){for(var prop in EnumType){if(EnumType.hasOwnProperty(prop)){if(EnumType[prop]===value)return prop}}};voltmx.model.Util.replaceAll=function(string,toReplace,replaceWith){var temp=string;var index=temp.indexOf(toReplace);while(index!=-1){temp=temp.replace(toReplace,replaceWith);index=temp.indexOf(toReplace)}return temp};voltmx.model.Util.addAll=function(to,from){for(var index=0;index<from.length;index++){var array_element=from[index];to.push(array_element)}};voltmx.model.Util.indexOf=function(array,object){if(array instanceof Array){for(var i=0;i<array.length;i++){var obj=array[i];if(voltmx.model.Util.equals(obj,object)){return i}}return-1}};voltmx.model.Util.equals=function(x,y){if(x===y)return true;if(!(x instanceof Object)||!(y instanceof Object))return false;if(x.constructor!==y.constructor)return false;for(var p in x){if(!x.hasOwnProperty(p))continue;if(!y.hasOwnProperty(p))return false;if(x[p]===y[p])continue;if(typeof x[p]!=="object")return false;if(!voltmx.model.Util.equals(x[p],y[p]))return false}for(p in y){if(y.hasOwnProperty(p)&&!x.hasOwnProperty(p))return false}return true};voltmx.model.Util.remove=function(array,object){if(array instanceof Array){var index=voltmx.model.Util.indexOf(array,object);if(index!==-1){array.splice(index,1)}}};voltmx.model.Util.contains=function(array,object){if(array instanceof Array){var index=voltmx.model.Util.indexOf(array,object);if(index===-1){return false}return true}};voltmx.model.Util.containsKey=function(json,object){var jsonKeyArray=Object.keys(json);if(voltmx.string.equalsIgnoreCase(voltmx.type(object),"string")){for(var index=0;index<jsonKeyArray.length;index++){var obj=jsonKeyArray[index];if(voltmx.string.equalsIgnoreCase(voltmx.type(obj),"string")&&voltmx.string.equalsIgnoreCase(object,obj)){return true}else{continue}}}for(var i=0;i<jsonKeyArray.length;i++){var objTemp=jsonKeyArray[i];if(voltmx.model.Util.equals(objTemp,object)){return true}else{continue}}return false};voltmx.model.Util.hasKeyInTableMap=function(map,key){var keys=Object.keys(map);for(var i=0;i<keys.length;i++){var arrKey=keys[i];if(voltmx.string.equalsIgnoreCase(arrKey,key)){return true}}return false};voltmx.model.Util.replaceAllRegEx=function replaceAll(find,replace,str){return str.replace(new RegExp(find,"g"),replace)};voltmx.model.Util.replaceFirstOccurence=function replaceAll(find,replace,str){return str.replace(new RegExp(find),replace)};voltmx.model.Util.checkSorting=function(type,fieldName,result,mockSync){var status=false;if(type=="asc"){for(var i=1;i<result.length;i++){if(mockSync){if(result.item(i)[fieldName]>=result.item(i-1)[fieldName]||result.item(i)[fieldName]-result.item(i-1)[fieldName]>=0){status=true}else{return false}}else{if(result[i][fieldName]>=result[i-1][fieldName]||result[i][fieldName]-result[i-1][fieldName]>=0){status=true}else{return false}}}return status}else if(type=="desc"){for(var i=1;i<result.length;i++){if(mockSync){if(result.item(i)[fieldName]<=result.item(i-1)[fieldName]||result.item(i)[fieldName]-result.item(i-1)[fieldName]<=0){status=true}else{return false}}else{if(result[i][fieldName]<=result[i-1][fieldName]||result[i][fieldName]-result[i-1][fieldName]<=0){status=true}else{return false}}}return status}else{return false}};voltmx.model.Util.isValidBooleanType=function(val){if(voltmx.model.Util.matchIgnoreCase(typeof val,"boolean")){return true}else if(voltmx.model.Util.matchIgnoreCase(typeof val,"string")){if(voltmx.model.Util.matchIgnoreCase(val,"false")||voltmx.model.Util.matchIgnoreCase(val,"true")||voltmx.model.Util.matchIgnoreCase(val,"0")||voltmx.model.Util.matchIgnoreCase(val,"1")){return true}}else if(voltmx.model.Util.matchIgnoreCase(typeof val,"number")){if(val===0||val===1){return true}}return false};voltmx.model.Util.isValidPickListData=function(fieldValue,pickListValuesArray,fieldMappingId){var result=false;if(pickListValuesArray!==undefined&&pickListValuesArray!==null&&pickListValuesArray.length>0){pickListValuesArray.forEach(function(entry){if(entry.fieldMappingId===fieldMappingId&&entry.value===fieldValue){result=true}})}return result};voltmx.model.Util.getPicklistLabel=function(value,pickListValues){var labelFound=false;var count=0;var label;while(!labelFound&&count<pickListValues.length){if(pickListValues[count].getValue()===value){label=pickListValues[count].getLabel();labelFound=true}count++}return label};voltmx.model.Util.isValidInteger=function(val){var result=true;if(typeof val==="string"){var floatValue=parseFloat(val);if(typeof floatValue==="number"&&floatValue%1!==0){result=false}else if(floatValue>voltmx.model.constants["INTEGER_MAX_VALUE"]||floatValue<voltmx.model.constants["INTEGER_MIN_VALUE"]){result=false}}else if(typeof val==="number"&&val%1===0&&(val>voltmx.model.constants["INTEGER_MAX_VALUE"]||val<voltmx.model.constants["INTEGER_MIN_VALUE"])){result=false}else if(typeof val!=="number"||val%1!==0){result=false}return result};voltmx.model.Util.isValidFloat=function(val){var result=true;if(typeof val==="string"){var floatValue=parseFloat(val);if(typeof floatValue!=="number")result=false}else if(typeof val!=="number")result=false;return result};voltmx.model.Util.isValidNumeric=function(numericObj){var result=true;var val=numericObj.val;var precision=parseInt(numericObj.precision);var scale=parseInt(numericObj.scale);if(typeof val==="string"){var nValue=parseFloat(val);if(typeof nValue!=="number")result=false;if(val.indexOf(".")===-1&&val.length>precision-scale)result=false;else if(val.indexOf(".")!==-1&&val.indexOf(".")>precision-scale)result=false}return result};voltmx.model.Util.isEmptyString=function(value){if(voltmx.model.Util.matchIgnoreCase(typeof value,"string")&&value.trim()===""){return true}else{return false}};voltmx.model.Util.isNull=function(val){if(val===null||val===undefined)return true;val=val+"";return voltmx.model.Util.matchIgnoreCase(val,"null")};voltmx.model.Util.isValidNumberType=function(val){if(voltmx.model.Util.matchIgnoreCase(typeof val,"number"))return true;else if(voltmx.model.Util.matchIgnoreCase(typeof val,"string")&&null!=voltmx.model.Util.toNumber(val))return true;else return false};voltmx.model.Util.toNumber=function(arg){if(arguments.length!=1){throw new Error("Invalid argument to voltmx.model.Util.toNumber")}if(typeof arg==="number"){return arg}else if(typeof arg==="string"){var str=arg.replace(/^\s*/,"").replace(/\s*$/,"");if(str===""){return null}else{var num=str-0;return isNaN(num)?null:num}}else{return null}};voltmx.model.Util.getFunctionName=function(calleeName){var myName=calleeName.substr("function ".length);myName=myName.substr(0,myName.indexOf("("));return myName};voltmx.model.Util.readURLParameters=function(url){var result={};var decode=function(s){var c="";c=s.replace(/\+/g," ");c=s.replace(/%+/g,"%25");return decodeURIComponent(c)};var queryString=url.substring(1);var keyValues=queryString.split("&");for(var i in keyValues){var key=keyValues[i].split("=");if(key.length>1){result[decode(key[0])]=decode(key[1])}}return result};voltmx.model.Util.getOperator=function(operator){if(voltmx.model.Util.matchIgnoreCase(operator,"lt")){return voltmx.model.constants.MatchType.LESS}else if(voltmx.model.Util.matchIgnoreCase(operator,"gt")){return voltmx.model.constants.MatchType.GREATER}else if(voltmx.model.Util.matchIgnoreCase(operator,"eq")){return voltmx.model.constants.MatchType.EQUALS}else if(voltmx.model.Util.matchIgnoreCase(operator,"ne")){return voltmx.model.constants.MatchType.NOTEQUAL}else if(voltmx.model.Util.matchIgnoreCase(operator,"le")){return voltmx.model.constants.MatchType.LESSEQUAL}else if(voltmx.model.Util.matchIgnoreCase(operator,"ge")){return voltmx.model.constants.MatchType.GREATEREQUAL}else if(voltmx.model.Util.matchIgnoreCase(operator,"lk")){return voltmx.model.constants.MatchType.LIKE}else if(voltmx.model.Util.matchIgnoreCase(operator,"null")){return voltmx.model.constants.MatchType.ISNULL}else if(voltmx.model.Util.matchIgnoreCase(operator,"nn")){return voltmx.model.constants.MatchType.ISNOTNULL}else if(voltmx.model.Util.matchIgnoreCase(operator,"cn")){return voltmx.model.constants.MatchType.CONTAINS}else if(voltmx.model.Util.matchIgnoreCase(operator,"sw")){return voltmx.model.constants.MatchType.STARTSWITH}else if(voltmx.model.Util.matchIgnoreCase(operator,"ew")){return voltmx.model.constants.MatchType.ENDSWITH}else{throw new voltmx.model.Exception(voltmx.model.ExceptionCode.CD_ERROR_MATCHOPERATOR_NOT_DEFINED_PROPERLY,voltmx.model.ExceptionCode.MSG_ERROR_MATCHOPERATOR_NOT_DEFINED_PROPERLY)}};voltmx.model.Util.validateDate=function(dateString){var t=str.match(/^(\d{2})\/(\d{2})\/(\d{4})$/);if(t===null){t=str.match(/^(\d{2})\-(\d{2})\-(\d{4})$/);if(t===null){t=str.match(/^(\d{2})\.(\d{2})\.(\d{4})$/);if(t===null){return false}}}var d=+t[1],m=+t[2],y=+t[3];if(m>=1&&m<=12&&d>=1&&d<=31&&y>=1e3){return true}return false};voltmx.model.Util.isAndroid=function(){var isAndroid=false;try{if(voltmx.os.deviceInfo().name==="android")isAndroid=true}catch(e){isAndroid=false}return isAndroid};voltmx.model.Util.isIpad=function(){var isIPad=false;try{var deviceName=voltmx.os.deviceInfo().name;if(deviceName==="iPad"||deviceName==="iPad Simulator")isIPad=true}catch(e){isIPad=false}return isIPad};voltmx.model.Util.isIphone=function(){var isIPhone=false;try{var deviceName=voltmx.os.deviceInfo().name;if(deviceName==="iPhone"||deviceName==="iPhone Simulator")isIPhone=true}catch(e){isIPhone=false}return isIPhone};voltmx.model.Util.isTablet=function(){var isTablet=false;if(voltmx.model.Util.isAndroidTablet()||voltmx.model.Util.isIpad()){isTablet=true}else{isTablet=false}return isTablet};voltmx.model.Util.isAndroidTablet=function(){var isAndroidTab=false;isAndroidTab=true;return isAndroidTab};voltmx.model.Util.getPlatformName=function(){var platformName;if(voltmx.model.constants.isForTesting&&voltmx.model.constants.TestConstants&&voltmx.model.constants.TestConstants.hasOwnProperty("PLATFORM")){platformName=voltmx.model.constants.TestConstants["PLATFORM"]}else{platformName="iphone";if(voltmx.model.Util.isIphone())platformName="iphone";else if(voltmx.model.Util.isIpad())platformName="ipad";else if(voltmx.model.Util.isAndroidTablet())platformName="tabrcandroid";else if(voltmx.model.Util.isAndroid())platformName="android";else platformName="android"}return platformName};voltmx.model.Util.getChannelName=function(){var channelName;if(voltmx.model.constants.isForTesting&&voltmx.model.constants.TestConstants&&voltmx.model.constants.TestConstants.hasOwnProperty("CHANNEL")){channelName=voltmx.model.constants.TestConstants["CHANNEL"]}else{channelName="mobile";if(voltmx.model.Util.isTablet())channelName="tablet"}return channelName};voltmx.model.Util.getDeviceID=function(){voltmx.model.log.info("Entering voltmx.model.Util.getDeviceID");if(voltmx.model.constants["DEVICE_ID"]!==""){return voltmx.model.constants["DEVICE_ID"]}var deviceInfo=voltmx.os.deviceInfo();if(voltmx.model.Util.isIphone()||voltmx.model.Util.isIpad()){if(deviceInfo.osversion<7){voltmx.model.constants["DEVICE_ID"]=deviceInfo.deviceid}else{voltmx.model.constants["DEVICE_ID"]=deviceInfo.identifierForVendor}}else voltmx.model.constants["DEVICE_ID"]=deviceInfo.deviceid;return voltmx.model.constants["DEVICE_ID"]};voltmx.model.Util.stringifyVoltmxObject=function(obj){var str;if(voltmx.model.constants&&voltmx.model.constants["ENABLE_JSON_STRINGIFY_PRINTS"]){try{if(obj instanceof Error||obj instanceof voltmx.model.Exception){str=obj.toString()}else{str=JSON.stringify(obj)}}catch(e){str=""}}else str="";return str};voltmx.model.Util.formatDate=function(date,format){return moment(date).format(format)};voltmx.model.Util.parseDate=function(dateString,format){return moment(dateString,format).toDate()};voltmx.model.Util.isValidDateFormat=function(dateString){var regex=/^((\d{4})(-)(0[1-9]|1[012])(-)(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3])(:)([0-5][0-9])(:)([0-5][0-9])(.)(\d{3})[\-\+]\d{4})$/;if(dateString.search(regex)===-1)return false;else return true};voltmx.model.Util.cloneObject=function(obj){var clonedObj={};for(var attrname in obj){clonedObj[attrname]=obj[attrname]}return clonedObj};voltmx.model.Util.StringBuffer=function(){function StringBuffer(){this.buffer=[]}StringBuffer.prototype.append=function(string){this.buffer.push(string);return this};StringBuffer.prototype.toString=function(){return this.buffer.join("")};return StringBuffer}();voltmx.model.Util.getDeviceLocale=function(){var DeviceLocale=voltmx.i18n.getCurrentDeviceLocale();if(voltmx.model.Util.isIphone()||voltmx.model.Util.isIpad())return DeviceLocale;var tempLocale=DeviceLocale.language;if(DeviceLocale.hasOwnProperty("country")&&DeviceLocale["country"]!="")tempLocale+="_"+DeviceLocale["country"];return tempLocale};voltmx.model.searchInfo=function(){function searchInfo(widgetid,searchconfig){if(typeof widgetid=="undefined"){throw new voltmx.model.Exception(voltmx.model.ExceptionCode.CD_ERROR_WIDGETID_NOT_DEFINED,voltmx.model.ExceptionCode.MSG_ERROR_WIDGETID_NOT_DEFINED)}this.widgetid=widgetid;searchconfig=searchconfig||{};this.input=searchconfig["inputfield"];this.event=searchconfig["event"];this.trigger=searchconfig["trigger"];this.query=searchconfig["query"]}searchInfo.prototype.getEvent=function(){return this.event};searchInfo.prototype.getListnerWidget=function(){return this.trigger};searchInfo.prototype.getSourceWidget=function(){return this.input};searchInfo.prototype.getQueryString=function(){return this.query};searchInfo.prototype.getWidgetId=function(){return this.widgetid};return searchInfo}();