var __getDSObjIdForAnnotation__=function(a){return a.proj_guid+"_annotations_"+a.channel},__readAnnotationFromDataStore__=function(a){var b=__getDSObjIdForAnnotation__(a);if(voltmx.store.getItem(b)&&0<Object.keys(voltmx.store.getItem(b)).length){var c=voltmx.store.getItem(b);if(c[a.annotation_id]){return c[a.annotation_id]}}return null},__writeAnnotationToDataStore__=function(a,b){var c=__getDSObjIdForAnnotation__(a);if(voltmx.store.getItem(c)&&0<Object.keys(voltmx.store.getItem(c)).length){var d=voltmx.store.getItem(c);if(null!=b)d[a.annotation_id]=b;voltmx.store.setItem(c,d)}else{var d={};if(null!=b)d[a.annotation_id]=b;voltmx.store.setItem(c,d)}},__addOrAppendAnnotationTODS__=function(a,b,c){var d=b,e=voltmx.ds.read("kvsession")[0],f=e.userDetails,g=a.annotation_id;d.widgetId=g;d.formId=g;function appendToListAndSave(b){var c=annotationsUtil.createComment(d,f),e=c.commentId;if(!b.comments[d.widgetId]){b.comments[d.widgetId]={}}b.comments[d.widgetId][e]=c;__writeAnnotationToDataStore__(a,b);return b}try{var h=null;if(null!==__readAnnotationFromDataStore__(a)){var i=__readAnnotationFromDataStore__(a);d.channel=a.channel;h=appendToListAndSave(i)}else{d.channel=a.channel;h=appendToListAndSave({widgetId:g,active:1,comments:{}})}c({status:400,error:null,data:h})}catch(a){c({status:200,err:a,data:null})}},__deleteCommentFROMDS__=function(a,b,c){b.active=0;__updateCommentTODS__(a,b,c)},__updateCommentTODS__=function(a,b,c){var d=voltmx.ds.read("kvsession")[0],e=d.userDetails;try{if(null!==__readAnnotationFromDataStore__(a)){var f=__readAnnotationFromDataStore__(a);f=annotationsUtil.updateComment(b,e,f);__writeAnnotationToDataStore__(a,f);c({status:400,error:null,data:f})}}catch(a){c({status:200,err:a,data:null})}},__openAnnotation__=function(a,b){if(null!==__readAnnotationFromDataStore__(a)){var c=__readAnnotationFromDataStore__(a);b({status:400,data:c})}else{b({status:200,data:null})}},fpas={addOrAppendAnnotationTODS:__addOrAppendAnnotationTODS__,updateCommentTODS:__updateCommentTODS__,deleteCommentFROMDS:__deleteCommentFROMDS__,openAnnotation:__openAnnotation__,readAnnotationFromDataStore:__readAnnotationFromDataStore__,writeAnnotationToDataStore:__writeAnnotationToDataStore__};